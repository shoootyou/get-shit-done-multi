# Roadmap: v1.10.0 - Installation CLI Optimization

**Version:** v1.10.0  
**Type:** Minor release (breaking changes with backward compatibility)  
**Created:** 2026-01-24  
**Depth:** Comprehensive  
**Status:** Draft

## Overview

Redesign the installation CLI to support multi-platform selection with explicit platform flags (`--claude`, `--copilot`, `--codex`), flexible scope modifiers (`--global`, `--local`), and a beautiful interactive menu with checkbox multi-select. This minor version introduces breaking changes via soft deprecation: old flags work with warnings during a 2-3 month grace period before removal in v1.11.0.

**Timeline estimate:** 3-4 weeks  
**MVP focus:** Platform flags, interactive menu, deprecation warnings, clean output, testing, documentation  
**Deferred to v1.10.1:** Uninstall consistency, quiet mode, Windows testing

## Phase Structure

### Phase 1: Dependencies & Setup
**Goal:** Development environment configured with Commander.js and Prompts libraries

**Requirements:** CLI-PARSE-01  
**Dependencies:** None  
**Estimated plans:** 1-2

**Success Criteria:**
1. Commander.js 14.x installed and verified working
2. Prompts 2.4+ installed and verified working
3. No dependency conflicts in package.json
4. Basic smoke test confirms libraries importable

---

### Phase 2: Flag System Design
**Goal:** New flag system fully implemented with validation and deprecation detection

**Requirements:** CLI-FLAG-01, CLI-FLAG-02, CLI-FLAG-03, CLI-SCOPE-01, CLI-SCOPE-02, CLI-PARSE-02, CLI-DEPR-01, CLI-DEPR-02, CLI-DEPR-03  
**Dependencies:** Phase 1 (Commander.js)  
**Estimated plans:** 2-3

**Success Criteria:**
1. User can specify platform with `--claude`, `--copilot`, `--codex` flags
2. User can install all platforms with `--all` flag
3. User can combine platforms: `--copilot --claude` installs both
4. User can specify scope with `--local` (default) or `--global` flags
5. `--codex --global` works identically to legacy `--codex-global`
6. `--copilot --global` shows clear error (Copilot is local-only)
7. `--all --claude` shows error (mutually exclusive flags)
8. `--local --global` shows error (conflicting scope)
9. Old flags (`--local` without platform) trigger deprecation warning with exact migration command
10. Old flags still work (default to Claude installation for backward compatibility)
11. Help message (`--help`) accurately describes all flags
12. Version flag (`--version`) shows v1.10.0

---

### Phase 3: Interactive Menu
**Goal:** User-friendly interactive menu with checkbox platform selection and scope choice

**Requirements:** CLI-INTER-01, CLI-INTER-02, CLI-INTER-03  
**Dependencies:** Phase 1 (Prompts)  
**Estimated plans:** 2-3

**Success Criteria:**
1. No flags provided â†’ interactive menu launches
2. Platform selection shows checkboxes for: [ ] Claude Code, [ ] GitHub Copilot CLI, [ ] Codex CLI, [ ] All
3. Space key toggles selection, arrow keys navigate, Enter confirms
4. "All" option selects all three platforms automatically
5. At least one platform must be selected (validation before proceeding)
6. After platform selection, scope menu shows: ( ) Local (default), ( ) Global
7. If Copilot selected with Global scope, warning shown and Copilot forced to Local
8. Non-TTY environment detected â†’ shows error with flag usage instructions
9. Ctrl+C exits gracefully with helpful message
10. Selected options convert to equivalent flags internally (consistency with flag-based invocation)

---

### Phase 4: Routing Layer Refactoring
**Goal:** Clean routing logic extracted from monolithic install.js, multi-platform orchestration working

**Requirements:** CLI-ROUTE-01, CLI-ROUTE-02  
**Dependencies:** Phase 2 (flag system)  
**Estimated plans:** 2-3

**Success Criteria:**
1. Routing logic moved to `bin/lib/router.js` (or similar module)
2. Main install.js function is <50 lines (parse â†’ validate â†’ route â†’ execute)
3. Router accepts parsed flags and returns platform list + scope for each
4. Multi-platform orchestration executes installations sequentially (Claude â†’ Copilot â†’ Codex)
5. Failure in one platform doesn't block others (continues with warning)
6. Each platform installation shows progress indicator (â ¿ in-progress, âœ“ success, âœ— failed)
7. Critical failures (disk space, permissions) trigger rollback
8. Final summary shows status for each platform attempted
9. Exit code 0 if all succeeded, non-zero if any failed

---

### Phase 5: Message Optimization
**Goal:** Clean, context-aware output without noise

**Requirements:** CLI-MSG-01, CLI-MSG-02  
**Dependencies:** Phase 4 (routing knows context)  
**Estimated plans:** 1-2

**Success Criteria:**
1. Platform-specific notes only shown when relevant (e.g., "Linux XDG Base Directory" only for Linux + Claude)
2. Success messages indicate what was actually installed ("âœ“ Claude Code installed locally")
3. Error messages show specific failure + suggested fix
4. No debug output or unnecessary boilerplate shown
5. Unicode symbols used consistently: âœ“ success, âœ— error, â ¿ in-progress, ðŸ“¦ package, âœ¨ completion
6. Installation summary at end lists all platforms with status
7. Visual hierarchy clear: headers, indentation, spacing
8. Output readable in both color and monochrome terminals

---

### Phase 6: Comprehensive Testing
**Goal:** High-confidence test coverage across unit, integration, and manual QA

**Requirements:** TEST-01, TEST-02, TEST-03  
**Dependencies:** Phases 2-5 (all functionality implemented)  
**Estimated plans:** 2-3

**Success Criteria:**
1. Unit tests written for flag parsing (>80% coverage)
2. Unit tests cover all valid flag combinations
3. Unit tests cover all invalid flag combinations with expected errors
4. Unit tests verify deprecation warning generation
5. Unit tests verify message formatting
6. Integration tests verify full installation workflow for each platform (Claude, Copilot, Codex)
7. Integration tests verify multi-platform installation (`--copilot --claude`)
8. Integration tests verify `--all` flag (local and global)
9. Integration tests verify backward compatibility (old flags work with warnings)
10. Manual QA checklist completed: tested on macOS, tested on Linux
11. Manual QA verified all three platforms actually work (not just install scripts)
12. Manual QA tested interactive menu in real terminal
13. Manual QA verified deprecation warnings show correctly
14. Test artifacts cleaned up after each test run

---

### Phase 7: Documentation & Migration
**Goal:** Users have clear guidance for migration and new flag usage

**Requirements:** DOCS-01, DOCS-02, DOCS-03, DOCS-04  
**Dependencies:** Phases 2-5 (all features implemented)  
**Estimated plans:** 2-3

**Success Criteria:**
1. `/MIGRATION.md` created in repo root with comprehensive guide
2. Migration guide shows before/after examples for all deprecated patterns
3. Migration guide includes CI/CD examples
4. Migration guide documents deprecation timeline (v1.10.0 warnings â†’ v1.11.0 removal)
5. README.md updated with new flag syntax
6. README.md marks old flag syntax as deprecated with link to migration guide
7. README.md includes examples: single platform, multi-platform, `--all`
8. README.md quick start section updated
9. CHANGELOG.md updated with "Breaking Changes" section
10. CHANGELOG.md documents all new flags
11. CHANGELOG.md links to migration guide
12. Installation documentation updated with interactive menu flow
13. Installation documentation includes all flag combinations with examples
14. Installation documentation covers non-interactive (CI/CD) usage
15. Deprecation warnings link to migration guide URL

---

## Progress Tracking

| Phase | Requirements | Status | Plans | Completion |
|-------|--------------|--------|-------|------------|
| 1 - Dependencies | CLI-PARSE-01 | Pending | 0/2 | 0% |
| 2 - Flag System | CLI-FLAG-01, CLI-FLAG-02, CLI-FLAG-03, CLI-SCOPE-01, CLI-SCOPE-02, CLI-PARSE-02, CLI-DEPR-01, CLI-DEPR-02, CLI-DEPR-03 | Pending | 0/3 | 0% |
| 3 - Interactive Menu | CLI-INTER-01, CLI-INTER-02, CLI-INTER-03 | Pending | 0/3 | 0% |
| 4 - Routing Refactor | CLI-ROUTE-01, CLI-ROUTE-02 | Pending | 0/3 | 0% |
| 5 - Message Optimization | CLI-MSG-01, CLI-MSG-02 | Pending | 0/2 | 0% |
| 6 - Testing | TEST-01, TEST-02, TEST-03 | Pending | 0/3 | 0% |
| 7 - Documentation | DOCS-01, DOCS-02, DOCS-03, DOCS-04 | Pending | 0/3 | 0% |

**Total:** 7 phases, 24 requirements mapped, 0-19 plans estimated

## Coverage Validation

### Requirements Mapped to Phases

âœ“ **CLI-FLAG-01** â†’ Phase 2  
âœ“ **CLI-FLAG-02** â†’ Phase 2  
âœ“ **CLI-FLAG-03** â†’ Phase 2  
âœ“ **CLI-SCOPE-01** â†’ Phase 2  
âœ“ **CLI-SCOPE-02** â†’ Phase 2  
âœ“ **CLI-INTER-01** â†’ Phase 3  
âœ“ **CLI-INTER-02** â†’ Phase 3  
âœ“ **CLI-INTER-03** â†’ Phase 3  
âœ“ **CLI-DEPR-01** â†’ Phase 2  
âœ“ **CLI-DEPR-02** â†’ Phase 2  
âœ“ **CLI-DEPR-03** â†’ Phase 2  
âœ“ **CLI-MSG-01** â†’ Phase 5  
âœ“ **CLI-MSG-02** â†’ Phase 5  
âœ— **CLI-MSG-03** â†’ Deferred to v1.10.1 (quiet mode)  
âœ“ **CLI-PARSE-01** â†’ Phase 1  
âœ“ **CLI-PARSE-02** â†’ Phase 2  
âœ“ **CLI-ROUTE-01** â†’ Phase 4  
âœ“ **CLI-ROUTE-02** â†’ Phase 4  
âœ— **CLI-UNINST-01** â†’ Deferred to v1.10.1 (uninstall parity)  
âœ— **CLI-UNINST-02** â†’ Deferred to v1.10.1 (shared modules)  
âœ“ **TEST-01** â†’ Phase 6  
âœ“ **TEST-02** â†’ Phase 6  
âœ“ **TEST-03** â†’ Phase 6  
âœ— **TEST-04** â†’ Deferred to v1.10.1+ (Windows testing)  
âœ“ **DOCS-01** â†’ Phase 7  
âœ“ **DOCS-02** â†’ Phase 7  
âœ“ **DOCS-03** â†’ Phase 7  
âœ“ **DOCS-04** â†’ Phase 7

**Coverage:** 24/28 P0 requirements mapped âœ“  
**Deferred:** 4 requirements (3 P1, 1 P2)  
**Orphaned:** 0 requirements

### Phase Dependencies

```
Phase 1 (Dependencies) â†’ Foundation for all phases
    â†“
Phase 2 (Flag System) â†’ Required for phases 3, 4
    â†“
    â”œâ”€â†’ Phase 3 (Interactive Menu) â†’ Converts to flags internally
    â””â”€â†’ Phase 4 (Routing) â†’ Consumes parsed flags
            â†“
        Phase 5 (Messages) â†’ Uses routing context
            â†“
        Phase 6 (Testing) â†’ Validates phases 2-5
            â†“
        Phase 7 (Documentation) â†’ Documents phases 2-5
```

**Critical path:** 1 â†’ 2 â†’ 4 â†’ 5 â†’ 6 â†’ 7  
**Parallel opportunity:** Phase 3 can overlap with Phase 4 (both depend on Phase 2)

## Risks & Mitigations

### High Priority Risks

| Risk | Impact | Likelihood | Mitigation |
|------|--------|------------|------------|
| **Breaking user CI/CD pipelines** | HIGH | MEDIUM | Soft deprecation with 2-3 month grace period, clear warnings, comprehensive migration guide, monitor GitHub issues |
| **Scope creep (60+ tasks)** | HIGH | MEDIUM | MVP scope clearly defined, defer nice-to-haves to v1.10.1, weekly progress check-ins |
| **Flag validation complexity** | MEDIUM | MEDIUM | Unit test all combinations, use Commander.js conflict detection, clear error messages |

### Medium Priority Risks

| Risk | Impact | Likelihood | Mitigation |
|------|--------|------------|------------|
| **Test suite brittleness** | MEDIUM | LOW | Focus on unit/integration over E2E, mock platform adapters, clean up test artifacts |
| **Interactive menu in non-TTY** | LOW | LOW | Early detection, fallback with clear instructions, document CI/CD usage |
| **Timeline slip** | MEDIUM | MEDIUM | Break work into clear phases, cut scope if needed, 4-week realistic estimate |

### Quality Gates

Before proceeding to next phase:
- **Phase 1:** Dependencies verified working (smoke tests pass)
- **Phase 2:** All flag combinations tested (unit tests >80% coverage)
- **Phase 3:** Interactive menu tested in real terminal (manual QA)
- **Phase 4:** Multi-platform installation working (integration tests pass)
- **Phase 5:** Message output reviewed (visual inspection + feedback)
- **Phase 6:** All tests passing on macOS + Linux (CI green)
- **Phase 7:** Migration guide examples manually tested (pre-release QA)

## Success Criteria

### Functional Requirements âœ…

From BRIEF.md and research SUMMARY.md:

- [ ] `--claude`, `--copilot`, `--codex` flags work for platform selection
- [ ] `--all` flag installs all platforms (local by default)
- [ ] `--all --global` installs all platforms globally
- [ ] Multi-platform: `--copilot --claude` installs both
- [ ] `--local`/`-l` and `--global`/`-g` scope modifiers work
- [ ] `--codex --global` works (alongside `--codex-global` for compatibility)
- [ ] Interactive menu: no flags â†’ checkbox multi-select + scope choice
- [ ] Platform checkboxes: Claude, Copilot, Codex, All
- [ ] Scope radio: Local (default), Global
- [ ] Deprecation warnings for old flags with exact migration command
- [ ] Old flags still work (backward compatibility during grace period)
- [ ] Clean, context-aware output (no unnecessary noise)

### Quality Requirements âœ…

- [ ] Unit tests: >80% coverage for flag parsing and validation
- [ ] Integration tests: full workflows for each platform
- [ ] Manual QA: tested on macOS + Linux with all platforms
- [ ] No regression in existing functionality
- [ ] Exit codes properly set (0 success, non-zero failure)

### Documentation Requirements âœ…

- [ ] README.md updated with new flag syntax
- [ ] `/MIGRATION.md` created with before/after examples
- [ ] CHANGELOG.md with "Breaking Changes" section
- [ ] Installation docs updated
- [ ] Migration guide linked from deprecation warnings

### Definition of Done âœ…

1. All 24 P0 requirements implemented
2. All functional success criteria checked off
3. Unit + integration tests passing on macOS + Linux
4. Manual QA checklist completed
5. Documentation complete and examples tested
6. CHANGELOG.md updated
7. Migration guide published
8. No P0 bugs open
9. Ready for release tag v1.10.0

## Out of Scope (Deferred to v1.10.1+)

- **CLI-UNINST-01, CLI-UNINST-02:** Uninstall script consistency (document manual uninstall for now)
- **CLI-MSG-03:** Quiet mode (`--quiet` flag for CI)
- **TEST-04:** Windows compatibility testing (focus macOS/Linux first)
- **Verbose mode:** `--verbose` flag for debugging (Commander generates basic help)
- **Custom project directories:** Already works via `--project-dir`, don't break

**Rationale:** Ship faster with core functionality. Uninstall consistency and Windows testing double scope without blocking primary workflows. Users can manually uninstall (`rm -rf ~/.claude/skills/get-shit-done-*`) and most developers use macOS/Linux.

## Dependencies

### External
- Commander.js 14.x (npm package)
- Prompts 2.4+ (npm package)
- Node.js 14+ (existing requirement)

### Internal
- Existing adapter pattern (`bin/lib/adapters/{claude,copilot,codex}.js`)
- Existing path configuration (`bin/lib/paths.js`)
- Existing template system (`bin/lib/template-system/`)
- Existing spec structure (`/specs/skills/`, `/specs/agents/`)

### Platform-Specific
- **Claude Code:** Local (`.claude/`) and global (`~/.config/claude/` or `~/Library/Application Support/Claude/`)
- **GitHub Copilot CLI:** Local only (`.github/copilot/skills/`)
- **Codex CLI:** Local (`.codex/`) and global (`~/.codex/`)

## Testing Strategy

### Unit Tests (Jest)
- **Flag parsing:** All valid/invalid combinations
- **Validation:** Conflict detection (e.g., `--copilot --global`)
- **Deprecation:** Warning message generation
- **Message formatting:** Context-aware output
- **Routing logic:** Platform list derivation

**Coverage target:** >80% for new modules

### Integration Tests (Jest + execa)
- **Full install workflows:** Each platform (Claude, Copilot, Codex)
- **Multi-platform:** `--copilot --claude` installs both
- **Bulk install:** `--all` and `--all --global`
- **Backward compatibility:** Old flags work with warnings
- **Test artifacts cleanup:** Temporary directories removed

**Coverage target:** All happy paths + critical error paths

### Manual QA Checklist
- [ ] Test on macOS (primary platform)
- [ ] Test on Linux (secondary platform)
- [ ] Verify Claude Code integration works
- [ ] Verify GitHub Copilot CLI integration works
- [ ] Verify Codex CLI integration works
- [ ] Test interactive menu in real terminal
- [ ] Test deprecated flags show warnings
- [ ] Verify migration guide examples work
- [ ] Test non-interactive mode (flags only)
- [ ] Test error handling (disk full, permissions)

### Continuous Integration
- Run unit + integration tests on every commit
- Test on macOS + Linux runners
- Block merge if tests fail
- Generate coverage report

## Documentation Updates

### Files to Update

1. **`/README.md`** (Phase 7)
   - Installation section: new flag examples
   - Quick start: updated command
   - Deprecation note with link to migration guide

2. **`/MIGRATION.md`** (Phase 7) - NEW FILE
   - Before/after examples for all deprecated patterns
   - CI/CD migration examples
   - Deprecation timeline
   - Troubleshooting section

3. **`/CHANGELOG.md`** (Phase 7)
   - "Breaking Changes" section
   - New features list (flags, interactive menu)
   - Deprecation warnings
   - Link to migration guide

4. **`/docs/installation.md`** (Phase 7) - If exists, or create
   - Interactive menu flow
   - All flag combinations with examples
   - Platform-specific considerations
   - CI/CD usage (non-interactive)

5. **`/bin/install.js`** (Inline comments during implementation)
   - Flag system explanation
   - Routing logic comments
   - Error handling notes

### Documentation Quality Criteria

- All examples tested and verified working
- Before/after comparisons clear
- Platform-specific notes accurate
- Links functional (migration guide URL)
- Screenshots of interactive menu (optional but nice)

## Timeline Estimate

**Optimistic:** 3 weeks (experienced Node.js developer, no blockers)  
**Realistic:** 4 weeks (includes testing, documentation, iteration)  
**Pessimistic:** 5-6 weeks (unforeseen complications, scope creep)

**Recommended:** Plan for 4 weeks, monitor weekly progress, cut scope if needed to ship on time.

### Weekly Milestones

- **Week 1:** Phases 1-2 complete (dependencies + flag system)
- **Week 2:** Phases 3-4 complete (interactive menu + routing)
- **Week 3:** Phases 5-6 complete (messages + testing)
- **Week 4:** Phase 7 complete + release prep (documentation)

---

**Status:** Ready for phase planning  
**Next step:** `/gsd-plan-phase 1` to break down Dependencies & Setup phase  
**Approved by:** [Awaiting user approval]
