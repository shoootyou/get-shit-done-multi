# Project State: v1.10.0 - Installation CLI Optimization

**Last Updated:** 2026-01-24  
**Milestone:** v1.10.0  
**Status:** Planning  

## Project Reference

### Core Value
Redesign installation CLI with explicit platform flags (`--claude`, `--copilot`, `--codex`), flexible scope modifiers (`--global`, `--local`), and interactive checkbox menu to replace legacy flag system while maintaining backward compatibility.

### Current Focus
**Milestone v1.10.0 initialization** - Roadmap created with 7 phases, 24 P0 requirements mapped, ready for phase planning.

### Version Context
- **Current version:** v1.9.1 (spec-based skills standardization complete)
- **Next version:** v1.10.0 (minor release - breaking changes with soft deprecation)
- **Following version:** v1.11.0 (planned Q2 2026 - full removal of deprecated flags)

## Current Position

### Active Milestone
**v1.10.0: Installation CLI Optimization**

**Phase:** Not started  
**Plan:** None  
**Status:** Roadmap approved, awaiting phase 1 planning  

**Progress:**
```
[░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 0% (0/7 phases)
```

### Milestone Scope
- **Total phases:** 7
- **Total requirements:** 24 P0 (Must-Have)
- **Estimated timeline:** 3-4 weeks
- **MVP focus:** Platform flags, interactive menu, deprecation warnings, testing, docs
- **Deferred to v1.10.1:** Uninstall consistency (3 P1 reqs), Windows testing (1 P2 req)

### Phase Breakdown
1. **Dependencies & Setup** - Commander.js + Prompts integration (1-2 plans)
2. **Flag System Design** - Platform flags, scope modifiers, validation, deprecation (2-3 plans)
3. **Interactive Menu** - Checkbox multi-select for platforms, scope choice (2-3 plans)
4. **Routing Refactor** - Extract routing, multi-platform orchestration (2-3 plans)
5. **Message Optimization** - Context-aware, clean output (1-2 plans)
6. **Comprehensive Testing** - Unit, integration, manual QA (2-3 plans)
7. **Documentation & Migration** - README, MIGRATION.md, CHANGELOG (2-3 plans)

## Performance Metrics

### Milestone Health
- **Requirements coverage:** 24/24 P0 mapped (100%)
- **Orphaned requirements:** 0
- **Deferred requirements:** 4 (3 P1, 1 P2)
- **Critical path identified:** Yes (1 → 2 → 4 → 5 → 6 → 7)
- **Dependencies validated:** Yes (external + internal + platform)

### Quality Gates
- **Phase 1 gate:** Dependencies verified working (smoke tests pass)
- **Phase 2 gate:** Flag combinations tested (unit tests >80% coverage)
- **Phase 3 gate:** Interactive menu tested in real terminal
- **Phase 4 gate:** Multi-platform installation working (integration tests pass)
- **Phase 5 gate:** Message output reviewed (visual inspection)
- **Phase 6 gate:** All tests passing on macOS + Linux
- **Phase 7 gate:** Migration guide examples manually tested

### Risk Dashboard
| Risk | Priority | Status | Mitigation |
|------|----------|--------|------------|
| Breaking CI/CD pipelines | HIGH | Identified | Soft deprecation, 2-3 month grace period, clear warnings |
| Scope creep (60+ tasks) | HIGH | Managed | MVP clearly defined, defer P1/P2 to v1.10.1 |
| Flag validation complexity | MEDIUM | Planned | Unit test all combos, Commander.js conflict detection |
| Timeline slip | MEDIUM | Monitored | 4-week realistic estimate, weekly check-ins |

## Accumulated Context

### Key Decisions Made

| Decision | Rationale | Date | Impact |
|----------|-----------|------|--------|
| Version bump to v1.10.0 | Breaking changes per semver (not v1.9.2) | 2026-01-24 | Minor release with soft deprecation |
| Commander.js + Prompts stack | Lightweight, zero-dep, industry standard | 2026-01-24 | Clean API, excellent DX |
| Defer uninstall to v1.10.1 | Scope management, uninstall non-blocking | 2026-01-24 | Ship faster, users can manual uninstall |
| Defer Windows to v1.10.1+ | macOS/Linux cover majority users | 2026-01-24 | Focus testing effort on primary platforms |
| 7 comprehensive phases | Research suggests 8, compressed setup | 2026-01-24 | Balanced depth, clear boundaries |
| Soft deprecation strategy | Maintain backward compat, no CI breakage | 2026-01-24 | 2-3 month grace period before v1.11.0 removal |

### Research Insights Applied
1. **Codex global support already exists** - No need to implement, just expose via `--codex --global` flag
2. **Commander.js 14.x recommended** - Zero deps, clean API, 15M weekly downloads
3. **Prompts 2.x for interactive UI** - 73KB, beautiful default, checkbox multi-select built-in
4. **Routing layer extraction critical** - Current 100+ line if/else needs refactoring
5. **Message verbosity is pain point** - Users complain about noise (e.g., "Linux XDG Base Directory...")
6. **Multi-platform coexistence proven** - No file conflicts, state shared via `.planning/`

### Technical Constraints
- **Node.js 14+** required (existing constraint)
- **Platform limits:** Copilot local-only by design (team collaboration)
- **Backward compatibility:** Grace period 2-3 months (v1.10.0 → v1.11.0)
- **Test coverage:** >80% for flag parsing, full integration for workflows
- **Existing architecture:** Preserve adapter pattern, template system, verification step

### Architectural Patterns to Preserve
1. **Adapter pattern** - Clean separation for platform differences (Claude, Copilot, Codex)
2. **Template generation system** - Cross-platform content generation works well
3. **Verification step** - Post-installation checks ensure success
4. **Migration system** - Handles upgrades from old file structures

### Architectural Patterns to Add
1. **Routing layer** - Extract from monolithic install.js (currently 1612 lines)
2. **Message manager** - Context-aware output module
3. **Platform selector** - Unified module for interactive + flag-based selection
4. **Installation orchestrator** - Coordinate multi-platform installations

## Open Questions & TODOs

### Resolved Questions
- ✅ **Version number:** v1.10.0 (minor release per semver)
- ✅ **Codex global support:** Already implemented, just expose via new flag syntax
- ✅ **Uninstall in v1.10.0?** No, defer to v1.10.1 (scope management)
- ✅ **Windows required?** No, defer to v1.10.1+ (focus macOS/Linux)
- ✅ **Deprecation timeline:** 2-3 months (standard industry practice)
- ✅ **Stack choice:** Commander.js + Prompts (lightweight, proven)

### Open Questions
- ❓ **Interactive menu UX details** - Exact wording for prompts, error messages?
- ❓ **Non-TTY fallback behavior** - Default to `--all --local` or show error?
- ❓ **Deprecation warning frequency** - Show every time or once per session?
- ❓ **Migration guide location** - `/MIGRATION.md` or `/docs/migration-v1.10.md`?
- ❓ **Feature flag approach** - Progressive rollout or ship complete feature?

*Note: Open questions to be addressed during phase planning*

### Immediate TODOs
- [ ] User approval of roadmap
- [ ] Begin Phase 1 planning: Dependencies & Setup
- [ ] Create `/MIGRATION.md` outline early (so we know what to document)
- [ ] Review existing `bin/install.js` structure (1612 lines - understand before refactoring)

### Future TODOs (Post-v1.10.0)
- [ ] Plan v1.10.1: Uninstall consistency, quiet mode, Windows testing
- [ ] Plan v1.11.0: Full removal of deprecated flags (Q2 2026)
- [ ] Consider: TypeScript migration? (future tech debt reduction)

## Blockers & Risks

### Current Blockers
**None** - Roadmap complete, awaiting user approval to proceed.

### Active Risks
1. **HIGH - Breaking CI/CD pipelines**
   - **Mitigation:** Soft deprecation with 2-3 month grace, comprehensive warnings, CI examples in migration guide
   - **Status:** Monitored, addressed in design

2. **HIGH - Scope creep**
   - **Mitigation:** MVP clearly defined (24 P0 reqs), defer P1/P2 to v1.10.1, weekly progress reviews
   - **Status:** Managed, boundaries set

3. **MEDIUM - Flag validation complexity**
   - **Mitigation:** Unit test all combinations, Commander.js conflict detection, clear error messages
   - **Status:** Planned, approach defined

4. **MEDIUM - Timeline slip**
   - **Mitigation:** 4-week realistic estimate, phase-by-phase gates, cut scope if needed
   - **Status:** Monitored, checkpoints planned

### Risk Trend
```
Risk level over time (projected):
HIGH   █████░░░░░░░░░░░  (Current: high due to scope, trend: decreasing as phases complete)
MEDIUM ████████░░░░░░░   (Stable with mitigations)
LOW    ░░░░░░░░░░░░░░░  (Minimal after Phase 2)
       Week 1  2  3  4
```

## Session Continuity

### Last Session Summary
**Date:** 2026-01-24  
**Agent:** gsd-roadmap (roadmap creation specialist)  
**Accomplishments:**
- Created v1.10.0-REQUIREMENTS.md with 28 requirements (24 P0, 3 P1, 1 P2)
- Created v1.10.0-ROADMAP.md with 7 comprehensive phases
- Validated 100% coverage of P0 requirements
- Defined MVP scope and deferred items clearly
- Identified dependencies and critical path
- Initialized STATE.md for project memory

**Context for next session:**
- All planning artifacts in `.planning/milestones/v1.10.0-*.md`
- Research context in `.planning/research/v1.10.0/SUMMARY.md`
- Ready for user approval of roadmap
- Next step: `/gsd-plan-phase 1` after approval

### Handoff Notes
- **For user:** Review roadmap structure, phase breakdown, success criteria. Provide approval or feedback for revision.
- **For plan-phase agent:** Phase 1 (Dependencies) is foundation - smoke tests critical. Phase 2 (Flags) is heaviest - consider breaking into 3 plans.
- **For implementers:** Preserve existing adapter pattern and template system. Routing refactor is biggest change - careful with existing logic.

### Files Modified This Session
```
Created:
  .planning/milestones/v1.10.0-REQUIREMENTS.md
  .planning/milestones/v1.10.0-ROADMAP.md
  .planning/milestones/v1.10.0-STATE.md (this file)

Modified:
  (None - new milestone initialization)
```

### Command History
```bash
# Research review
cat .planning/research/v1.10.0/BRIEF.md
cat .planning/research/v1.10.0/SUMMARY.md

# Milestone initialization
# Created REQUIREMENTS.md (28 reqs, 24 P0)
# Created ROADMAP.md (7 phases, critical path defined)
# Created STATE.md (this file)
```

---

**Ready for:** User roadmap approval  
**Awaiting:** Proceed to phase 1 planning or roadmap revision  
**Health:** ✅ GREEN (all planning artifacts complete, coverage validated)
