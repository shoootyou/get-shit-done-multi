# Requirements: v1.10.0 - Installation CLI Optimization

**Version:** v1.10.0 (minor release - breaking changes with backward compatibility)  
**Created:** 2026-01-24  
**Status:** Draft

## Overview

Redesign the installation command-line interface to support multi-platform selection with intuitive flags and interactive menus. This is a breaking change with soft deprecation (old flags work with warnings).

## Requirements by Category

### CLI-FLAG: Platform Selection Flags

**CLI-FLAG-01: Platform-specific flags**
- **Priority:** P0 (Must-Have)
- **Description:** Support explicit platform selection via command-line flags
- **Acceptance Criteria:**
  - `--claude` installs GSD for Claude Code
  - `--copilot` installs GSD for GitHub Copilot CLI
  - `--codex` installs GSD for Codex CLI
  - Flags can be combined: `--copilot --claude` installs both
  - Invalid combinations show clear error messages

**CLI-FLAG-02: Bulk installation flag**
- **Priority:** P0 (Must-Have)
- **Description:** Support installing all platforms with single flag
- **Acceptance Criteria:**
  - `--all` installs all three platforms
  - Works with scope modifiers: `--all --local`, `--all --global`
  - Default scope is local when not specified

**CLI-FLAG-03: Multi-platform support**
- **Priority:** P0 (Must-Have)
- **Description:** Allow multiple platform installations in single command
- **Acceptance Criteria:**
  - Multiple platform flags accepted: `--copilot --claude --codex`
  - Installation runs sequentially for each platform
  - Failure in one platform doesn't stop others (continues with warning)
  - Clear output showing status for each platform

### CLI-SCOPE: Installation Scope Modifiers

**CLI-SCOPE-01: Scope modifier flags**
- **Priority:** P0 (Must-Have)
- **Description:** Support local vs global installation scope
- **Acceptance Criteria:**
  - `--local` or `-l` installs to project directory (`.github/`, `.claude/`, `.codex/`)
  - `--global` or `-g` installs to user directory (`~/.config/`, `~/Library/`, etc.)
  - Default is local when not specified
  - Copilot only supports local (show error for `--copilot --global`)

**CLI-SCOPE-02: Codex global support**
- **Priority:** P0 (Must-Have)
- **Description:** Support both local and global installation for Codex
- **Acceptance Criteria:**
  - `--codex --global` installs to `~/.codex/skills/`
  - `--codex --local` installs to `.codex/skills/`
  - Maintain backward compatibility with `--codex-global` flag
  - Both syntaxes work identically

### CLI-INTER: Interactive Menu

**CLI-INTER-01: Interactive mode trigger**
- **Priority:** P0 (Must-Have)
- **Description:** Launch interactive menu when no flags provided
- **Acceptance Criteria:**
  - Running `npx get-shit-done-multi` with no flags shows interactive menu
  - Non-TTY environments detected and show error with usage instructions
  - Ctrl+C exits gracefully with helpful message

**CLI-INTER-02: Platform selection UI**
- **Priority:** P0 (Must-Have)
- **Description:** Checkbox multi-select for platform selection
- **Acceptance Criteria:**
  - Checkbox menu shows: [ ] Claude Code, [ ] GitHub Copilot CLI, [ ] Codex CLI, [ ] All
  - Space key toggles selection, Enter confirms
  - Arrow keys navigate options
  - At least one platform must be selected
  - "All" option selects all three platforms

**CLI-INTER-03: Scope selection UI**
- **Priority:** P0 (Must-Have)
- **Description:** Radio selection for installation scope
- **Acceptance Criteria:**
  - After platform selection, show scope choice: ( ) Local, ( ) Global
  - Default selection is Local
  - Arrow keys navigate, Enter confirms
  - If Copilot selected and Global chosen, show warning and force Local for Copilot only

### CLI-DEPR: Deprecation & Backward Compatibility

**CLI-DEPR-01: Old flag detection**
- **Priority:** P0 (Must-Have)
- **Description:** Detect usage of deprecated flag patterns
- **Acceptance Criteria:**
  - `--local` without platform flag detected
  - `--global` without platform flag detected
  - `npx get-shit-done-multi` (legacy invocation) detected
  - Detection happens before execution

**CLI-DEPR-02: Deprecation warnings**
- **Priority:** P0 (Must-Have)
- **Description:** Show clear deprecation warnings with migration guidance
- **Acceptance Criteria:**
  - Warning message clearly states flag is deprecated
  - Shows exact suggested replacement command
  - Includes deprecation timeline (removal in v1.11.0)
  - Links to migration guide
  - Example: "âš ï¸  Warning: --local without platform is deprecated. Use: npx get-shit-done-multi --claude --local"

**CLI-DEPR-03: Backward compatibility**
- **Priority:** P0 (Must-Have)
- **Description:** Old flags continue working during grace period
- **Acceptance Criteria:**
  - `--local` defaults to Claude installation (legacy behavior)
  - `--global` defaults to Claude installation (legacy behavior)
  - `--codex-global` continues working alongside `--codex --global`
  - No user scripts break (soft deprecation)
  - Grace period: 2-3 months (v1.10.0 â†’ v1.11.0)

### CLI-MSG: Message Optimization

**CLI-MSG-01: Context-aware messages**
- **Priority:** P0 (Must-Have)
- **Description:** Show only relevant messages based on command context
- **Acceptance Criteria:**
  - Platform-specific notes only shown for that platform (e.g., "Linux XDG Base Directory" only for Linux Claude installs)
  - Success messages show what was actually installed
  - Error messages show specific failure reason and suggested fix
  - No generic boilerplate shown unnecessarily

**CLI-MSG-02: Clean output format**
- **Priority:** P0 (Must-Have)
- **Description:** Consistent, clean output without noise
- **Acceptance Criteria:**
  - Unicode symbols used consistently: âœ“ success, âœ— error, â ¿ in-progress, ðŸ“¦ package, âœ¨ completion
  - Clear visual hierarchy (headers, indentation, spacing)
  - No debug output unless `--verbose` flag used
  - Installation summary at end showing all platforms installed

**CLI-MSG-03: Quiet mode support**
- **Priority:** P1 (Nice-to-Have)
- **Description:** Support minimal output for CI/CD environments
- **Acceptance Criteria:**
  - `--quiet` or `-q` flag suppresses non-essential output
  - Only errors and final status shown
  - Exit codes properly set (0 success, non-zero failure)

### CLI-PARSE: Argument Parsing

**CLI-PARSE-01: Commander.js integration**
- **Priority:** P0 (Must-Have)
- **Description:** Use Commander.js v14+ for argument parsing
- **Acceptance Criteria:**
  - Commander.js 14.x added to package.json
  - All flags defined with proper types and descriptions
  - Help message (`--help`) auto-generated and accurate
  - Version flag (`--version`) shows correct version
  - Unknown flags show helpful error message

**CLI-PARSE-02: Flag validation**
- **Priority:** P0 (Must-Have)
- **Description:** Validate flag combinations before execution
- **Acceptance Criteria:**
  - `--copilot --global` rejected with error message
  - `--all --claude` rejected (mutually exclusive)
  - Empty platform selection rejected
  - Conflicting scope modifiers rejected (`--local --global`)
  - All validation errors show suggested fix

### CLI-ROUTE: Routing & Orchestration

**CLI-ROUTE-01: Routing layer extraction**
- **Priority:** P0 (Must-Have)
- **Description:** Extract routing logic from monolithic install.js
- **Acceptance Criteria:**
  - Routing logic in separate module (e.g., `bin/lib/router.js`)
  - Clear separation: parse â†’ validate â†’ route â†’ execute
  - Platform orchestrator handles multi-platform installations
  - No more than 50 lines of routing logic in install.js main function

**CLI-ROUTE-02: Multi-platform orchestration**
- **Priority:** P0 (Must-Have)
- **Description:** Coordinate installation across multiple platforms
- **Acceptance Criteria:**
  - Sequential execution (Claude â†’ Copilot â†’ Codex order)
  - Independent failures (one platform fails, others continue)
  - Rollback on critical failure (disk space, permissions)
  - Progress indication for each platform
  - Final summary shows success/failure per platform

### CLI-UNINST: Uninstall Consistency

**CLI-UNINST-01: Uninstall flag parity**
- **Priority:** P1 (Nice-to-Have - defer to v1.10.1)
- **Description:** Apply same flag system to uninstall.js
- **Acceptance Criteria:**
  - `--claude`, `--copilot`, `--codex` work for uninstall
  - `--all` uninstalls all platforms
  - `--global` and `--local` work with platform flags
  - Interactive menu for uninstall when no flags provided
  - Same deprecation warnings as install

**CLI-UNINST-02: Shared modules**
- **Priority:** P1 (Nice-to-Have - defer to v1.10.1)
- **Description:** Extract shared code between install and uninstall
- **Acceptance Criteria:**
  - Flag parsing shared (e.g., `bin/lib/flag-parser.js`)
  - Message manager shared
  - Routing logic reusable
  - No code duplication between install.js and uninstall.js

### TEST: Testing & Quality

**TEST-01: Unit test coverage**
- **Priority:** P0 (Must-Have)
- **Description:** Comprehensive unit tests for flag parsing and validation
- **Acceptance Criteria:**
  - >80% code coverage for flag parsing module
  - All flag combinations tested (valid and invalid)
  - Deprecation warning generation tested
  - Message formatting tested
  - Mock platform adapters for isolated testing

**TEST-02: Integration test coverage**
- **Priority:** P0 (Must-Have)
- **Description:** End-to-end installation workflows tested
- **Acceptance Criteria:**
  - Full install workflow for each platform (Claude, Copilot, Codex)
  - Multi-platform installation tested
  - `--all` flag tested (local and global)
  - Backward compatibility tested (old flags work)
  - Test artifacts cleaned up after each test

**TEST-03: Manual QA checklist**
- **Priority:** P0 (Must-Have)
- **Description:** Pre-release manual testing checklist
- **Acceptance Criteria:**
  - Test on macOS (primary platform)
  - Test on Linux (secondary platform)
  - Test all three platforms actually work (Claude Code, Copilot CLI, Codex CLI)
  - Test interactive menu in real terminal
  - Test deprecated flags show warnings
  - Verify migration guide examples work

**TEST-04: Windows compatibility**
- **Priority:** P2 (Defer to v1.10.1+)
- **Description:** Verify Windows path handling and installation
- **Acceptance Criteria:**
  - Test on Windows 10/11
  - Verify `%APPDATA%` path handling
  - Test PowerShell and cmd.exe
  - Document Windows-specific issues

### DOCS: Documentation

**DOCS-01: README updates**
- **Priority:** P0 (Must-Have)
- **Description:** Update main README with new flag syntax
- **Acceptance Criteria:**
  - Installation section shows new flag examples
  - Old flag syntax marked as deprecated
  - Link to migration guide included
  - Examples cover common use cases (single platform, multi-platform, all)
  - Quick start section updated

**DOCS-02: Migration guide**
- **Priority:** P0 (Must-Have)
- **Description:** Comprehensive migration guide for v1.9.x â†’ v1.10.0
- **Acceptance Criteria:**
  - Located at `/MIGRATION.md` (repo root)
  - Clear before/after examples for all deprecated patterns
  - Timeline for deprecation removal (v1.11.0)
  - CI/CD migration examples included
  - Linked from deprecation warnings

**DOCS-03: CHANGELOG updates**
- **Priority:** P0 (Must-Have)
- **Description:** Document breaking changes and new features
- **Acceptance Criteria:**
  - "Breaking Changes" section clearly marked
  - All new flags documented
  - Deprecation warnings documented
  - Migration guide linked
  - Version bumped to v1.10.0

**DOCS-04: Installation documentation**
- **Priority:** P0 (Must-Have)
- **Description:** Update installation docs with new patterns
- **Acceptance Criteria:**
  - Interactive menu flow documented
  - All flag combinations documented with examples
  - Platform-specific considerations documented
  - Troubleshooting section updated
  - Non-interactive (CI/CD) usage documented

## Requirements Summary

**Total requirements:** 28

**By priority:**
- **P0 (Must-Have):** 24 requirements
- **P1 (Nice-to-Have):** 3 requirements
- **P2 (Defer):** 1 requirement

**By category:**
- **CLI-FLAG:** 3 requirements (platform selection)
- **CLI-SCOPE:** 2 requirements (local vs global)
- **CLI-INTER:** 3 requirements (interactive menu)
- **CLI-DEPR:** 3 requirements (deprecation & compatibility)
- **CLI-MSG:** 3 requirements (message optimization)
- **CLI-PARSE:** 2 requirements (argument parsing)
- **CLI-ROUTE:** 2 requirements (routing & orchestration)
- **CLI-UNINST:** 2 requirements (uninstall consistency - defer)
- **TEST:** 4 requirements (testing & QA)
- **DOCS:** 4 requirements (documentation)

## MVP Scope for v1.10.0

**Must include:**
- All P0 requirements (24)
- Platform flags working (`--claude`, `--copilot`, `--codex`, `--all`)
- Scope modifiers working (`--global`, `--local`)
- Multi-platform support
- Interactive menu with checkbox selection
- Deprecation warnings with backward compatibility
- Message optimization (context-aware, clean output)
- Commander.js integration
- Routing layer refactoring
- Comprehensive testing (unit + integration)
- Documentation updates (README, MIGRATION.md, CHANGELOG)

**Defer to v1.10.1:**
- CLI-UNINST-01: Uninstall flag parity (P1)
- CLI-UNINST-02: Shared modules for install/uninstall (P1)
- CLI-MSG-03: Quiet mode support (P1)
- TEST-04: Windows compatibility testing (P2)

**Rationale:** Focus on core functionality and quality. Uninstall consistency and Windows testing add significant scope without blocking primary use cases. Users can manually uninstall for now, and macOS/Linux cover majority of developer base.

## Traceability

Requirement-to-Phase mapping populated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| CLI-FLAG-01 | Phase 2 | Pending |
| CLI-FLAG-02 | Phase 2 | Pending |
| CLI-FLAG-03 | Phase 2 | Pending |
| CLI-SCOPE-01 | Phase 2 | Pending |
| CLI-SCOPE-02 | Phase 2 | Pending |
| CLI-INTER-01 | Phase 3 | Pending |
| CLI-INTER-02 | Phase 3 | Pending |
| CLI-INTER-03 | Phase 3 | Pending |
| CLI-DEPR-01 | Phase 2 | Pending |
| CLI-DEPR-02 | Phase 2 | Pending |
| CLI-DEPR-03 | Phase 2 | Pending |
| CLI-MSG-01 | Phase 5 | Pending |
| CLI-MSG-02 | Phase 5 | Pending |
| CLI-MSG-03 | Deferred | v1.10.1 |
| CLI-PARSE-01 | Phase 1 | Pending |
| CLI-PARSE-02 | Phase 2 | Pending |
| CLI-ROUTE-01 | Phase 4 | Pending |
| CLI-ROUTE-02 | Phase 4 | Pending |
| CLI-UNINST-01 | Deferred | v1.10.1 |
| CLI-UNINST-02 | Deferred | v1.10.1 |
| TEST-01 | Phase 6 | Pending |
| TEST-02 | Phase 6 | Pending |
| TEST-03 | Phase 6 | Pending |
| TEST-04 | Deferred | v1.10.1+ |
| DOCS-01 | Phase 7 | Pending |
| DOCS-02 | Phase 7 | Pending |
| DOCS-03 | Phase 7 | Pending |
| DOCS-04 | Phase 7 | Pending |

**Coverage summary:**
- Phase 1: 1 requirement (Commander.js integration)
- Phase 2: 9 requirements (flag system, scope, deprecation)
- Phase 3: 3 requirements (interactive menu)
- Phase 4: 2 requirements (routing refactor)
- Phase 5: 2 requirements (message optimization)
- Phase 6: 3 requirements (testing)
- Phase 7: 4 requirements (documentation)
- **Total mapped:** 24/24 P0 requirements (100% coverage) âœ“

## Success Criteria

From BRIEF.md requirements:

- âœ… Platform-specific flags working for all 3 platforms
- âœ… `--all` flag installs all platforms (local by default)
- âœ… `--all --global` installs all platforms globally
- âœ… Multi-platform selection: `--copilot --claude` works
- âœ… Interactive menu with checkbox selection + global/local choice
- âœ… Deprecation warnings for old flags with migration guidance
- âœ… Clean output without unnecessary messages
- âœ… install.js updated (uninstall.js deferred to v1.10.1)
- âœ… Documentation updated (README + installation docs + migration guide)

---

**Status:** Ready for roadmap creation  
**Next step:** Create ROADMAP.md with phase breakdown
