---
phase: 01-foundation-schema
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - /specs/skills/README.md
  - commands/gsd/*.md (read-only analysis)
autonomous: true
must_haves:
  truths:
    - Directory /specs/skills/ exists and is ready for skill specs
    - README.md documents canonical frontmatter schema with name, description, tools, metadata fields
    - README.md documents folder-per-skill structure with examples
    - Complete mapping table exists for all 29 legacy commands (gsd: → gsd-)
    - Schema documentation includes YAML examples showing platform conditionals
  artifacts:
    - /specs/skills/README.md (schema documentation, structure explanation, mapping table)
    - /specs/skills/ directory (empty, ready for skill folders)
  wiring:
    - None (foundation work, no integration points yet)
  key_links:
    - README.md serves as single source of truth for schema referenced by Phase 2 template integration
---

# Plan 01: Foundation Structure & Schema

**Objective:** Create `/specs/skills/` directory structure, document canonical frontmatter schema, and map all 29 legacy command names to new format.

## Context

Phase 1 establishes the foundation for skill spec migration. The architecture is already proven—the existing template system (`bin/lib/template-system/`) successfully handles 13 agent specs with 208 passing tests. This plan creates the directory structure and defines the schema that all future skills will follow.

**From RESEARCH.md:**
- Reuse exact agent spec pattern (gray-matter parsing, Mustache conditionals, tool mapping)
- Folder-per-skill structure enables future expansion (templates, assets per skill)
- Platform conditionals already work: `{{#isClaude}}tools: [Read, Bash]{{/isClaude}}`

**From STATE.md decisions:**
- Prefix "gsd-" in specs (not "gsd:" legacy format)
- Structure of folder per skill (follows Claude standard)
- Metadata format matches `/specs/agents/` for consistency

## Tasks

<task name="create-directory-structure" type="auto">
  <files>
    /specs/skills/
  </files>
  <action>
Create the `/specs/skills/` directory structure:

```bash
mkdir -p /workspace/specs/skills
```

Verify creation:
```bash
ls -la /workspace/specs/ | grep skills
```

This directory will contain folder-per-skill subdirectories (`gsd-help/`, `gsd-new-project/`, etc.).
  </action>
  <verify>
```bash
test -d /workspace/specs/skills && echo "✓ Directory exists" || echo "✗ Directory missing"
```
  </verify>
  <done>Directory `/specs/skills/` exists and is ready for skill folders</done>
</task>

<task name="analyze-legacy-commands" type="auto">
  <files>
    commands/gsd/*.md (read-only)
  </files>
  <action>
Analyze all 29 legacy command files to create complete name mapping table:

```bash
# Extract all command names from frontmatter
for file in /workspace/commands/gsd/*.md; do
  # Extract name field from frontmatter
  name=$(sed -n '/^---$/,/^---$/p' "$file" | grep '^name:' | sed 's/name: *//')
  basename=$(basename "$file" .md)
  echo "$name|$basename"
done | sort > /tmp/command-analysis.txt

# Display analysis
cat /tmp/command-analysis.txt
```

Create mapping table in Markdown format with columns: Legacy Name, Spec Name, Folder, Complexity (LOW/MEDIUM/HIGH based on orchestration).

Complexity heuristic:
- LOW: No Task tool invocations (help, progress, add-todo)
- MEDIUM: 1-2 Task tool spawns (plan-phase, research-phase, debug, map-codebase)
- HIGH: 3+ Task tool spawns or parallel orchestration (new-project, execute-phase, new-milestone)
  </action>
  <verify>
Mapping table includes all 29 commands with no duplicates:
```bash
wc -l /tmp/command-analysis.txt  # Should be 29
```
  </verify>
  <done>Complete mapping table created documenting all 29 legacy commands with complexity ratings</done>
</task>

<task name="write-schema-documentation" type="auto">
  <files>
    /specs/skills/README.md
  </files>
  <action>
Create `/specs/skills/README.md` documenting canonical schema, folder structure, and command mapping.

Structure:
1. **Overview**: Purpose of /specs/skills/, relationship to existing agent specs
2. **Directory Structure**: Folder-per-skill pattern with examples
3. **Canonical Frontmatter Schema**: 
   - Required fields: name, description, tools
   - Optional fields: metadata (auto-generated)
   - Field types and validation rules
4. **Platform Conditionals**: Mustache syntax for {{#isClaude}}, {{#isCopilot}}, {{#isCodex}}
5. **Metadata Template**: Auto-generated fields (platform, generated, gsdVersion)
6. **Tool Declarations**: Platform-specific tool name mappings
7. **Command Name Mapping**: Complete table from legacy (gsd:*) to spec (gsd-*)
8. **Examples**: Full SKILL.md example showing frontmatter + body
9. **Validation Rules**: Schema constraints (name format, required fields, tool arrays)

Reference `/specs/agents/gsd-planner.md` as example of working pattern.

Include mapping table from previous task.

**Critical:** Document that:
- Folder name MUST match skill name (gsd-help folder for name: gsd-help)
- File MUST be named SKILL.md (all caps)
- Platform conditionals MUST be in frontmatter, not body
- Metadata fields auto-generate, don't author in specs
  </action>
  <verify>
README.md exists and contains all sections:
```bash
grep -c "Canonical Frontmatter Schema" /workspace/specs/skills/README.md
grep -c "Platform Conditionals" /workspace/specs/skills/README.md
grep -c "Command Name Mapping" /workspace/specs/skills/README.md
grep -c "Folder Structure" /workspace/specs/skills/README.md
```
All should return 1 or more.
  </verify>
  <done>README.md documents canonical schema with all required fields, examples, and complete command mapping table</done>
</task>

## Verification Criteria

After all tasks complete:

1. **Directory exists**: `/workspace/specs/skills/` directory created
2. **README complete**: All 9 sections present with examples
3. **Schema documented**: name, description, tools fields with types and validation rules
4. **Mapping complete**: All 29 commands mapped from legacy to spec format
5. **Examples included**: Full SKILL.md example showing frontmatter structure
6. **Platform conditionals documented**: Mustache syntax explained with tool mapping examples

Run verification:
```bash
# Check directory
test -d /workspace/specs/skills && echo "✓ Directory" || echo "✗ Directory"

# Check README sections (should output 4+ matches)
grep -E "(Schema|Platform|Mapping|Structure)" /workspace/specs/skills/README.md | wc -l

# Check mapping table completeness (should list 29 commands)
grep -c "^| gsd:" /workspace/specs/skills/README.md
```

## Success Criteria

**Observable truths:**
1. `/specs/skills/` directory exists and is empty (ready for skill folders)
2. README.md serves as single source of truth for schema with all fields documented
3. Complete command mapping table exists for all 29 legacy commands
4. Platform conditional syntax documented with examples
5. Schema validation rules clearly stated

**Ready for:** Phase 2 template integration can reference README.md as canonical schema source.

## Output

**Created:**
- `/specs/skills/` directory structure
- `/specs/skills/README.md` (schema documentation, ~300-500 lines)

**Documented:**
- Canonical frontmatter schema (name, description, tools, metadata)
- Folder-per-skill structure with naming conventions
- Complete command name mapping (29 commands: gsd:* → gsd-*)
- Platform conditional syntax ({{#isClaude}} etc.)
- Metadata template structure (platform, generated, gsdVersion)
- Tool declaration patterns with platform-specific mappings
