---
phase: 04-agent-translation
plan: 03
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - bin/lib/orchestration/capability-matrix.js
  - bin/lib/orchestration/generate-capability-docs.js
  - docs/agent-capabilities.md
autonomous: true

must_haves:
  truths:
    - "Capability matrix documents which agents work on which CLIs"
    - "User can view capability matrix showing support levels per agent"
    - "Documentation auto-generated from capability-matrix.js data"
    - "CLI-specific limitations documented with explanations"
  artifacts:
    - path: "bin/lib/orchestration/capability-matrix.js"
      provides: "Capability definitions and matrix generator"
      min_lines: 60
      exports: ["AGENT_CAPABILITIES", "CLI_LIMITATIONS", "generateCapabilityMatrix"]
    - path: "bin/lib/orchestration/generate-capability-docs.js"
      provides: "Markdown documentation generator"
      min_lines: 60
      exports: ["generateCapabilityDocs"]
    - path: "docs/agent-capabilities.md"
      provides: "User-facing capability matrix documentation"
      min_lines: 100
  key_links:
    - from: "bin/lib/orchestration/generate-capability-docs.js"
      to: "bin/lib/orchestration/capability-matrix.js"
      via: "import { generateCapabilityMatrix, CLI_LIMITATIONS }"
      pattern: "require.*capability-matrix"
    - from: "bin/lib/orchestration/generate-capability-docs.js"
      to: "docs/agent-capabilities.md"
      via: "fs.promises.writeFile()"
      pattern: "writeFile.*docs/"
---

<objective>
Create capability matrix documenting agent support across three CLIs with auto-generated user-facing documentation.

Purpose: Satisfy AGENT-06 requirement (documentation explains agent feature differences per CLI) and AGENT-07 (unified agent registry shows availability per CLI).

Output: Capability matrix data structure, documentation generator, and generated markdown showing which agents work on which CLIs with explanations.
</objective>

<execution_context>
@.github/skills/get-shit-done/get-shit-done/workflows/execute-plan.md
@.github/skills/get-shit-done/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/04-agent-translation/04-RESEARCH.md

# Depends on 04-01 for agent list
@.planning/phases/04-agent-translation/04-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create capability matrix data structure</name>
  <files>bin/lib/orchestration/capability-matrix.js</files>
  <action>
Create `bin/lib/orchestration/capability-matrix.js` with capability definitions:

1. **AGENT_CAPABILITIES object:**
   - Define capability for all 11 agents:
     - gsd-executor, gsd-planner, gsd-verifier, gsd-debugger, gsd-phase-researcher, gsd-plan-checker, gsd-codebase-mapper, gsd-project-researcher, gsd-research-synthesizer, gsd-roadmapper, gsd-integration-checker
   - For each agent, specify capability per CLI:
     ```javascript
     'gsd-executor': {
       claude: { level: 'full', notes: 'Native support, no limitations' },
       copilot: { level: 'full', notes: 'Custom agent, full feature parity' },
       codex: { level: 'full', notes: 'Skill-based, all features supported' }
     }
     ```
   - Default all to 'full' for Phase 4 (limitations may emerge in testing, update then)

2. **CLI_LIMITATIONS object:**
   - Document CLI-specific constraints:
     ```javascript
     const CLI_LIMITATIONS = {
       claude: {
         slash_commands: { supported: true, notes: 'Full /gsd:* command support' },
         custom_agents: { supported: true, notes: 'Native .agent.md format' },
         parallel_agents: { supported: true, notes: 'No limitations' }
       },
       copilot: {
         slash_commands: { supported: false, notes: 'Use skills with $get-shit-done' },
         custom_agents: { supported: true, notes: 'Custom agent definitions in .github/agents/' },
         parallel_agents: { supported: true, notes: 'No limitations' }
       },
       codex: {
         slash_commands: { supported: false, notes: 'Use skills with $get-shit-done' },
         custom_agents: { supported: true, notes: 'Skill-based in .codex/skills/' },
         parallel_agents: { supported: true, notes: 'No limitations' }
       }
     };
     ```

3. **generateCapabilityMatrix() function:**
   - Return array of objects with agent and capability per CLI
   - Format: `[{ agent: 'gsd-executor', claude: { level: 'full', icon: '✓', notes: '...' }, ... }]`
   - Icons: '✓' for full, '⚠' for partial, '✗' for unsupported

4. **Export all three:**
   ```javascript
   module.exports = { 
     AGENT_CAPABILITIES, 
     CLI_LIMITATIONS,
     generateCapabilityMatrix 
   };
   ```

**Follow research Pattern 4 (capability-matrix.js lines 420-489).**
  </action>
  <verify>
```bash
node -e "const {AGENT_CAPABILITIES, CLI_LIMITATIONS, generateCapabilityMatrix} = require('./bin/lib/orchestration/capability-matrix.js'); console.log('Agents:', Object.keys(AGENT_CAPABILITIES).length); console.log('CLIs:', Object.keys(CLI_LIMITATIONS).length); const m = generateCapabilityMatrix(); console.log('Matrix rows:', m.length, 'First agent:', m[0].agent);"
```

Should output 11 agents, 3 CLIs, matrix with 11 rows.
  </verify>
  <done>
capability-matrix.js exists with AGENT_CAPABILITIES (11 agents), CLI_LIMITATIONS (3 CLIs), and generateCapabilityMatrix() function that returns structured array.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create documentation generator</name>
  <files>bin/lib/orchestration/generate-capability-docs.js</files>
  <action>
Create `bin/lib/orchestration/generate-capability-docs.js` to auto-generate markdown documentation:

1. **Import dependencies:**
   ```javascript
   const { generateCapabilityMatrix, CLI_LIMITATIONS } = require('./capability-matrix');
   const fs = require('fs').promises;
   ```

2. **generateCapabilityDocs(outputPath = 'docs/agent-capabilities.md') async function:**
   - Get matrix from generateCapabilityMatrix()
   - Build markdown string with sections:

   **Header:**
   ```markdown
   # Agent Capability Matrix

   This document shows which GSD agents are supported on each CLI platform.

   ## Support Levels

   - ✓ **Full Support**: All features work without limitations
   - ⚠ **Partial Support**: Most features work with documented limitations
   - ✗ **Unsupported**: Agent cannot be used on this CLI
   ```

   **Table:**
   ```markdown
   ## Agent Support Matrix

   | Agent | Claude Code | GitHub Copilot CLI | Codex CLI |
   |-------|-------------|-------------------|-----------|
   | gsd-executor | ✓ | ✓ | ✓ |
   ...
   ```

   **Detailed Notes:**
   ```markdown
   ## Detailed Notes

   ### gsd-executor

   - **Claude Code**: Native support, no limitations
   - **GitHub Copilot CLI**: Custom agent, full feature parity
   - **Codex CLI**: Skill-based, all features supported
   ```

   **CLI Limitations:**
   ```markdown
   ## CLI-Specific Limitations

   ### claude

   - ✓ **slash_commands**: Full /gsd:* command support
   - ✓ **custom_agents**: Native .agent.md format
   ...
   ```

3. **Write to file:**
   - Ensure docs/ directory exists via `fs.mkdir('docs', {recursive: true})`
   - Write markdown with `fs.writeFile(outputPath, markdown, 'utf8')`
   - Log success message to console

4. **Export function:**
   ```javascript
   module.exports = { generateCapabilityDocs };
   ```

**Follow research "Capability Matrix Generation" example (lines 607-663).**
  </action>
  <verify>
```bash
node -e "const {generateCapabilityDocs} = require('./bin/lib/orchestration/generate-capability-docs.js'); generateCapabilityDocs().then(() => console.log('Generated docs')).catch(e => console.error('Error:', e.message));"
```

Then check:
```bash
cat docs/agent-capabilities.md | head -30
```

Should show markdown header, table, and detailed notes.
  </verify>
  <done>
generate-capability-docs.js exists, generateCapabilityDocs() function creates markdown with capability matrix table, detailed notes, and CLI limitations.
  </done>
</task>

<task type="auto">
  <name>Task 3: Generate initial capability documentation</name>
  <files>docs/agent-capabilities.md</files>
  <action>
Run documentation generator to create initial docs/agent-capabilities.md:

```bash
node -e "const {generateCapabilityDocs} = require('./bin/lib/orchestration/generate-capability-docs.js'); generateCapabilityDocs().then(() => console.log('✅ Generated docs/agent-capabilities.md')).catch(e => { console.error('❌ Generation failed:', e.message); process.exit(1); });"
```

**Why:** Create initial documentation so users can reference agent capabilities immediately. Future updates can regenerate this file when agent support changes.

**Verify structure includes:**
- Header explaining support levels
- Agent support matrix table (11 rows, 3 CLI columns)
- Detailed notes for each agent
- CLI-specific limitations section
  </action>
  <verify>
```bash
test -f docs/agent-capabilities.md && echo "✅ File exists" || echo "❌ File missing"
grep -c "gsd-executor" docs/agent-capabilities.md # Should be > 0
grep -c "Claude Code" docs/agent-capabilities.md # Should be > 0
```
  </verify>
  <done>
docs/agent-capabilities.md exists with complete capability matrix showing all 11 agents, 3 CLIs, support levels, detailed notes, and CLI limitations.
  </done>
</task>

</tasks>

<verification>
After completion:

1. **Matrix structure:**
   ```bash
   node -e "const {generateCapabilityMatrix} = require('./bin/lib/orchestration/capability-matrix.js'); const m = generateCapabilityMatrix(); console.log('Matrix:', JSON.stringify(m[0], null, 2));"
   ```

2. **Documentation exists:**
   ```bash
   cat docs/agent-capabilities.md | grep "Agent Capability Matrix"
   ```

3. **Regeneration test:**
   ```bash
   rm docs/agent-capabilities.md
   node -e "require('./bin/lib/orchestration/generate-capability-docs.js').generateCapabilityDocs()"
   test -f docs/agent-capabilities.md && echo "✅ Regenerated"
   ```
</verification>

<success_criteria>
1. AGENT_CAPABILITIES defines all 11 agents with claude/copilot/codex support
2. CLI_LIMITATIONS documents CLI-specific constraints
3. generateCapabilityMatrix() returns array of 11 agent capability objects
4. generateCapabilityDocs() creates markdown with table, notes, and limitations
5. docs/agent-capabilities.md exists and is human-readable
6. Documentation can be regenerated programmatically
</success_criteria>

<output>
After completion, create `.planning/phases/04-agent-translation/04-03-SUMMARY.md`
</output>
