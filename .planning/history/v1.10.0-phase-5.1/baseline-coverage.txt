
> get-shit-done-multi@1.9.0 test
> jest --maxWorkers=4 --coverage --testPathIgnorePatterns=test-environments

FAIL __tests__/platform-integration.test.js
  Platform Integration (TEST-05)
    ✕ All platforms have spec directories configured (7 ms)
    ✓ Shared frontmatter is loaded and merged (2 ms)
    ✓ All specs can be loaded and have valid structure (30 ms)

  ● Platform Integration (TEST-05) › All platforms have spec directories configured

    expect(received).toContain(expected) // indexOf

    Expected substring: "get-shit-done"
    Received string:    "/workspace/.github/copilot/skills"

      15 |       const fullPath = path.join(__dirname, '..', dir);
      16 |       expect(fullPath).toContain(dir);
    > 17 |       expect(fullPath).toContain('get-shit-done');
         |                        ^
      18 |     }
      19 |   });
      20 |   

      at Object.<anonymous> (__tests__/platform-integration.test.js:17:24)

error: unknown option '--unknown-flag'
error: unknown option '--claude=value'
FAIL bin/lib/flag-parser.test.js
  Flag Parser
    Single platform flags
      ✓ parses --claude (62 ms)
      ✓ parses --copilot
      ✓ parses --codex (1 ms)
    Multiple platform flags
      ✓ parses --claude --copilot
      ✓ parses --claude --copilot --codex (1 ms)
      ✓ parses --copilot --codex
      ✓ parses flags in any order (1 ms)
    --all flag
      ✓ --all includes all three platforms
      ✓ --all with --claude shows info and uses all platforms (1 ms)
      ✓ --all with multiple platforms shows info (1 ms)
      ✓ --all without specific platforms does not show info
    Scope flags
      ✓ --global sets scope to global
      ✓ --local sets scope to local
      ✓ -g short form sets scope to global
      ✓ -l short form sets scope to local (1 ms)
      ✓ no scope flag defaults to local
    Combined platform and scope
      ✓ --claude --global (1 ms)
      ✓ --copilot --codex --local (1 ms)
      ✓ --all --global (1 ms)
      ✓ scope flag can come before platform flags (1 ms)
      ✓ short form scope with platform flags
    Duplicate platform flags
      ✓ --claude --claude handled gracefully (Commander treats as single) (1 ms)
      ✓ --copilot --copilot --copilot handled as single
      ✓ unique platforms work without issues
    No platforms (menu mode)
      ✓ no flags triggers menu with null scope (menu will ask)
      ✓ --global only triggers menu with global scope preset
      ✓ --local only triggers menu with local scope preset (1 ms)
      ✓ -g only triggers menu
    Error handling
      ✓ unknown option throws error (18 ms)
      ✓ invalid flag format throws error (1 ms)
    Edge cases
      ✓ handles empty argv gracefully
      ✓ preserves platform order when parsed
      ✓ scope flag position does not affect result (1 ms)
    Return structure
      ✓ always returns platforms array
      ✓ always returns scope string (1 ms)
      ✓ always returns needsMenu boolean
      ✕ has no unexpected properties (2 ms)

  ● Flag Parser › Return structure › has no unexpected properties

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

      Array [
        "platforms",
        "scope",
        "needsMenu",
    +   "configDir",
      ]

      282 |     test('has no unexpected properties', () => {
      283 |       const result = parseFlags(['node', 'install.js', '--claude']);
    > 284 |       expect(Object.keys(result)).toEqual(['platforms', 'scope', 'needsMenu']);
          |                                   ^
      285 |     });
      286 |   });
      287 | });

      at Object.<anonymous> (bin/lib/flag-parser.test.js:284:35)

  console.warn
    Unexpected field in gsd-add-phase: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-add-phase: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-add-phase: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-add-phase: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-add-todo: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-archive-milestone: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-archive-milestone: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-archive-milestone: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-archive-milestone: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-audit-milestone: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-audit-milestone: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-audit-milestone: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-audit-milestone: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-check-todos: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-complete-milestone: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-complete-milestone: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-complete-milestone: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-complete-milestone: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-discuss-phase: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-discuss-phase: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-discuss-phase: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-discuss-phase: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-help: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-help: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-help: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-help: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-insert-phase: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-insert-phase: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-insert-phase: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-insert-phase: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-list-milestones: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-list-milestones: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-list-milestones: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-list-milestones: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-list-phase-assumptions: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-list-phase-assumptions: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-list-phase-assumptions: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-list-phase-assumptions: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-new-milestone: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-new-milestone: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-new-milestone: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-new-milestone: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-new-project: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-new-project: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-new-project: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-new-project: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-pause-work: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-pause-work: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-pause-work: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-pause-work: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-plan-milestone-gaps: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-plan-milestone-gaps: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-plan-milestone-gaps: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-plan-milestone-gaps: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-progress: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-progress: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-progress: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-progress: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-remove-phase: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-remove-phase: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-remove-phase: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-remove-phase: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-restore-milestone: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-restore-milestone: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-restore-milestone: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-restore-milestone: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-resume-work: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-resume-work: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-resume-work: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-resume-work: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-update: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-update: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-update: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-update: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-verify-installation: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-verify-installation: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-verify-installation: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-verify-installation: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-verify-work: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-verify-work: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-verify-work: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-verify-work: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-whats-new: skill_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-whats-new: requires_version

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-whats-new: platforms

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

  console.warn
    Unexpected field in gsd-whats-new: arguments

      54 |         
      55 |         // Warn about unexpected fields (not fail - may be extensions)
    > 56 |         console.warn(`Unexpected field in ${spec.name}: ${field}`);
         |                 ^
      57 |       }
      58 |     }
      59 |   });

      at Object.<anonymous> (__tests__/frontmatter-validation.test.js:56:17)

PASS __tests__/frontmatter-validation.test.js
  Frontmatter Validation (TEST-03)
    ✓ All specs have valid name format (138 ms)
    ✓ All specs have non-empty descriptions (97 ms)
    ✓ Tools are arrays of strings (21 ms)
    ✓ No invalid frontmatter fields (120 ms)
    ✓ Invalid schemas produce clear error messages (3 ms)

PASS __tests__/spec-parsing.test.js
  Spec Parsing (TEST-01)
    ✓ All spec files can be read and have frontmatter (27 ms)
    ✓ All specs have required frontmatter fields (51 ms)
    ✓ Spec folder names match skill names in frontmatter (22 ms)

FAIL __tests__/conditional-rendering.test.js
  Conditional Rendering (TEST-02)
    ✕ Platform conditionals render correctly (8 ms)
    ✕ Tools array renders without conditionals

  ● Conditional Rendering (TEST-02) › Platform conditionals render correctly

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      29 |       
      30 |       // Should succeed
    > 31 |       expect(result.success).toBe(true);
         |                              ^
      32 |       expect(result.output).toBeDefined();
      33 |       
      34 |       const rendered = result.output;

      at Object.<anonymous> (__tests__/conditional-rendering.test.js:31:30)

  ● Conditional Rendering (TEST-02) › Tools array renders without conditionals

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      64 |       const result = generateFromSpec(testSpec, platform);
      65 |       
    > 66 |       expect(result.success).toBe(true);
         |                              ^
      67 |       expect(result.output).toBeDefined();
      68 |       
      69 |       const rendered = result.output;

      at Object.<anonymous> (__tests__/conditional-rendering.test.js:66:30)

FAIL __tests__/metadata-generation.test.js
  Metadata Generation (TEST-04)
    ✕ Copilot generates metadata fields (6 ms)
    ✕ Claude does not generate metadata fields (1 ms)
    ✕ Platform-specific tool names are correct (1 ms)

  ● Metadata Generation (TEST-04) › Copilot generates metadata fields

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      14 |     const result = generateFromSpec(testSpec, 'copilot');
      15 |     
    > 16 |     expect(result.success).toBe(true);
         |                            ^
      17 |     expect(result.output).toBeDefined();
      18 |     
      19 |     const rendered = result.output;

      at Object.<anonymous> (__tests__/metadata-generation.test.js:16:28)

  ● Metadata Generation (TEST-04) › Claude does not generate metadata fields

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      37 |     const result = generateFromSpec(testSpec, 'claude');
      38 |     
    > 39 |     expect(result.success).toBe(true);
         |                            ^
      40 |     expect(result.output).toBeDefined();
      41 |     
      42 |     const rendered = result.output;

      at Object.<anonymous> (__tests__/metadata-generation.test.js:39:28)

  ● Metadata Generation (TEST-04) › Platform-specific tool names are correct

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      59 |     // Claude uses capitalized tool names
      60 |     const claudeResult = generateFromSpec(testSpec, 'claude');
    > 61 |     expect(claudeResult.success).toBe(true);
         |                                  ^
      62 |     // view -> Read, edit -> Edit, bash -> Bash
      63 |     expect(claudeResult.output).toContain('tools: Read, Edit, Bash');
      64 |     

      at Object.<anonymous> (__tests__/metadata-generation.test.js:61:34)

PASS bin/lib/paths.test.js
  getConfigPaths
    claude platform
      ✓ should return global path with new .claude directory (1 ms)
      ✓ should return local path in current directory
      ✓ should support custom config directory (1 ms)
    copilot platform
      ✓ should return global .copilot path
      ✓ should return local .github path (1 ms)
      ✓ should support custom config directory
    codex platform
      ✓ should return local .codex path
      ✓ should throw error for global installation (12 ms)
      ✓ should support custom config directory
    error handling
      ✓ should throw error for unknown platform (1 ms)
      ✓ should throw error for invalid scope (1 ms)
    custom config directory
      ✓ should resolve relative paths
      ✓ should handle absolute paths (1 ms)
  expandTilde
    ✓ should expand ~/ to home directory
    ✓ should not modify paths without tilde
    ✓ should handle null/undefined
    ✓ should handle empty string
    ✓ should not expand tilde in middle of path
  ensureDirExists
    ✓ should return true when directory is created successfully
    ✓ should return false and log error on failure (1 ms)
  ensureInstallDir
    ✓ should return success when directory is created (1 ms)
    ✓ should handle EACCES permission error for global scope
    ✓ should handle EPERM permission error for global scope
    ✓ should handle permission error for local scope
    ✓ should handle generic errors

PASS bin/lib/codex-warning.test.js
  codex-warning with boxen
    boxed warning display
      ✓ displays boxed warning with border characters (3 ms)
      ✓ warning box contains installation plan (2 ms)
      ✓ no warning when codex not in platforms
      ✓ no warning when scope is local
    TTY detection
      ✓ auto-proceeds in non-TTY environment (1 ms)
      ✓ prompts for confirmation in TTY environment
    user confirmation
      ✓ returns true when user confirms
      ✓ returns false when user declines
      ✓ handles user cancellation
    multi-platform handling
      ✓ shows correct paths for all platforms (1 ms)

PASS bin/lib/menu/interactive-menu.test.js
  Interactive Menu - TTY Detection
    ✓ throws error when process.stdin.isTTY is falsy (6 ms)
    ✓ error message matches expected format (2 ms)
    ✓ does not throw when TTY is present
    ✓ mock stdin.isTTY as undefined (CI/CD behavior) (1 ms)
    ✓ mock stdin.isTTY as null (piped input behavior) (1 ms)
  Interactive Menu - Platform Selection
    ✓ single platform selection
    ✓ multiple platform selection
    ✓ all three platforms individually (1 ms)
    ✓ "All" selection overrides to all three platforms
    ✓ "All" plus individual selections → still results in all three (override, not additive) (1 ms)
    ✓ platform array returned in response.platforms (1 ms)
    ✓ needsMenu is false in return value
    ✓ platforms are strings in array (1 ms)
  Interactive Menu - Scope Selection
    ✓ local scope selected
    ✓ global scope selected
    ✓ default is Local when Enter pressed immediately (1 ms)
    ✓ scope returned in response.scope
    ✓ when scopeFromFlags provided, scope prompt skipped (1 ms)
  Interactive Menu - Scope Preset Tests
    ✓ showInteractiveMenu("global") skips scope prompt
    ✓ return value uses provided scope (1 ms)
    ✓ showInteractiveMenu("local") skips scope prompt
  Interactive Menu - Cancel Handling
    ✓ cancel during platform selection exits with code 0
    ✓ onCancel callback logs "Installation cancelled"
  Interactive Menu - Integration Format
    ✓ return format matches flag parser: { platforms, scope, needsMenu } (1 ms)
    ✓ platforms is array of strings
    ✓ scope is string ("local" or "global")
  Interactive Menu - Validation
    ✓ validation function defined for multiselect
    ✓ empty selection validation message (2 ms)

PASS bin/install.test.js
  install.js integration
    Reporter integration
      ✓ Reporter can be instantiated (1 ms)
      ✓ multi-platform results collection
      ✓ partial failure results collection
      ✓ summary formats results correctly
    Exit code logic
      ✓ exit 0 for all success
      ✓ exit 1 for any failure
      ✓ exit 1 for all failures
    Error resilience
      ✓ continues to next platform after error (1 ms)
    Platform details
      ✓ includes path and counts in success details
      ✓ platformSuccess displays details (2 ms)

PASS bin/lib/output/reporter.test.js
  Reporter
    constructor
      ✓ creates reporter with default options
      ✓ accepts custom write function (1 ms)
      ✓ respects silent mode
    platformStart
      ✓ outputs platform name and scope
      ✓ increments indent level
      ✓ sets context
    platformSuccess
      ✓ outputs success with path
      ✓ includes counts when provided
      ✓ decrements indent level (1 ms)
      ✓ indents output under platform
    platformError
      ✓ outputs error message
      ✓ decrements indent level
    warning
      ✓ displays boxed warning
      ✓ returns true when no confirmation needed (1 ms)
    summary
      ✓ shows succeeded platforms
      ✓ shows failed platforms with errors
      ✓ handles all successes
      ✓ handles all failures (1 ms)
    success
      ✓ outputs success message
    error
      ✓ outputs error message
    info
      ✓ outputs info message

PASS bin/lib/conflict-resolver.test.js
  conflict-resolver
    isGSDContent()
      ✓ returns true for files in commands/ directory (1 ms)
      ✓ returns true for files in agents/ directory (1 ms)
      ✓ returns true for files in skills/ directory (1 ms)
      ✓ returns true for files in get-shit-done/ directory
      ✓ returns false for files in other directories
      ✓ returns false for files at root level
      ✓ handles nested paths correctly
      ✓ handles paths with similar names
    analyzeInstallationConflicts()
      ✓ returns no conflicts when directory doesn't exist (2 ms)
      ✓ detects GSD directories (commands) (2 ms)
      ✓ detects GSD directories (agents) (1 ms)
      ✓ detects GSD directories (skills) (2 ms)
      ✓ detects GSD directories (get-shit-done) (2 ms)
      ✓ detects user files (non-GSD content) (2 ms)
      ✓ sets canAutoClean=true when only GSD files exist (1 ms)
      ✓ sets canAutoClean=false when user files exist (1 ms)
      ✓ handles empty directories (1 ms)
      ✓ handles nested GSD content (2 ms)
      ✓ handles mixed content (GSD + user files) (2 ms)
    cleanupGSDContent()
      ✓ removes GSD directories (2 ms)
      ✓ returns count of removed directories (1 ms)
      ✓ handles nested GSD content (2 ms)
      ✓ doesn't touch user files (2 ms)
      ✓ handles empty gsdFiles array
    detectOldClaudePath()
      ✓ returns exists=false when old path doesn't exist (1 ms)
      ✓ returns exists=true when old path exists
      ✓ warning message includes old and new paths
      ✓ only checks ~/Library/Application Support/Claude
    GSD_DIRECTORIES constant
      ✓ exports GSD_DIRECTORIES array
      ✓ includes expected directories
      ✓ has exactly 4 directories

PASS __tests__/yaml-parser-compatibility.test.js
  YAML Parser Compatibility (TEST-10)
    ✓ YAML parser works consistently across platforms (6 ms)
    ✓ All existing specs parse without platform-specific issues (35 ms)
    ✓ YAML parser handles edge cases consistently

PASS bin/lib/old-flag-detector.test.js
  Old Flag Detector
    Scope flags without platform flags (NEW v1.10.0 behavior)
      ✓ --local alone is KEPT (scope preset for menu) (1 ms)
      ✓ --global alone is KEPT (scope preset for menu)
      ✓ --codex-global is ALWAYS removed (truly old flag)
      ✓ --codex-global shows migration example
      ✓ --codex-global warning references MIGRATION.md
    Multiple flags (no platform)
      ✓ --local and --global both kept (will conflict in validator)
      ✓ --codex-global with --local: only codex-global removed (1 ms)
      ✓ single warning for old flags only
    Mixed scope flags with platform flags (NEW usage)
      ✓ keeps --local when used with --claude (new usage)
      ✓ keeps --global when used with --copilot (new usage)
      ✓ always treats --codex-global as old even with platform flags
      ✓ treats --all as platform flag (keeps --local) (1 ms)
    No old flags present
      ✓ no warning for new flag usage
      ✓ no warning for platform-only flags
      ✓ no warning for --all flag
      ✓ no warning for no flags
    Edge cases and variations
      ✓ does not detect --locale (different flag)
      ✓ does not detect -l short form as old (it is new) (3 ms)
      ✓ does not detect -g short form as old (it is new) (1 ms)
      ✓ handles flags at different positions (NEW: kept)
      ✓ preserves other arguments (NEW: --local kept)
      ✓ handles argv with only scope flags (NEW: kept)

PASS bin/lib/path-validator.test.js
  validatePath
    Windows validation
      ✓ should detect invalid characters (1 ms)
      ✓ should detect multiple invalid characters
      ✓ should detect reserved names (1 ms)
      ✓ should detect reserved names case-insensitively
      ✓ should detect reserved names with extensions
      ✓ should reject paths exceeding 260 characters (1 ms)
      ✓ should accept valid Windows paths
      ✓ should accept paths at exactly 260 characters
    macOS validation
      ✓ should reject paths exceeding 1024 characters
      ✓ should accept valid Unix paths
      ✓ should accept paths at exactly 1024 characters
    Linux validation
      ✓ should reject paths exceeding 4096 characters (1 ms)
      ✓ should accept valid Unix paths
      ✓ should accept paths at exactly 4096 characters
    input validation
      ✓ should reject null path
      ✓ should reject undefined path
      ✓ should reject empty string
      ✓ should reject non-string input (1 ms)
  isWSL
    ✓ should return false on non-Linux platforms (1 ms)
    ✓ should detect WSL via /proc/version with "microsoft"
    ✓ should detect WSL via /proc/version with "wsl"
    ✓ should detect WSL via /mnt/c existence
    ✓ should return false on regular Linux (1 ms)
    ✓ should handle /proc/version read errors gracefully
  getEffectivePlatform
    ✓ should return "linux" for WSL
    ✓ should return process.platform for non-WSL
    ✓ should return "win32" for Windows
    ✓ should return "linux" for regular Linux

PASS bin/lib/flag-validator.test.js
  Flag Validator
    Conflicting scope flags
      ✓ rejects --local --global (1 ms)
      ✓ rejects -l -g short forms
      ✓ rejects mixed --local and -g
      ✓ rejects mixed -l and --global (1 ms)
      ✓ shows example in error message
      ✓ exits with code 2 (command misuse)
    Valid combinations
      ✓ allows --claude --global
      ✓ allows --claude --local
      ✓ allows --all --global
      ✓ allows --all --local (1 ms)
      ✓ allows multiple platforms with scope
      ✓ allows platform without explicit scope (defaults local)
      ✓ allows scope without platform (triggers menu)
      ✓ allows no flags (triggers menu)
      ✓ allows short form -g
      ✓ allows short form -l
    Edge cases
      ✓ handles flags in different positions
      ✓ does not false-positive on --locale vs --local
      ✓ validates even when needsMenu is true (1 ms)
    Error message format
      ✓ error message is red/colored
      ✓ error message includes both flags
      ✓ error message is actionable
    Config parameter ignored when checking argv
      ✓ checks raw argv not config.scope

[999D[K  console.log
    Running validators tests...

      at Object.<anonymous> (bin/lib/template-system/validators.test.js:34:9)

[999D[K  console.log
    ✓ validateClaudeSpec: valid spec passes

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: missing name fails

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: empty name fails

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: missing description fails

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: lowercase tool name fails (Pitfall 1)

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: mixed case tools fail

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: wildcard tools fail (Pitfall 2)

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: invalid model fails

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: valid models pass

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: unknown hook generates warning

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: Claude-only tool no warning for Claude

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: valid spec passes

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: wildcard tools valid

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: model field generates warning (Pitfall 3)

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: hooks generate warning (Pitfall 10)

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: skills generate warning (Pitfall 10)

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: disallowedTools generate warning (Pitfall 4)

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: Claude-only tool generates warning

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: MCP servers validated

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateSpec: dispatches to Claude validator

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateSpec: dispatches to Copilot validator

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateSpec: unknown platform fails

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ checkPromptLength: short prompt passes for Claude

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ checkPromptLength: short prompt passes for Copilot

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ checkPromptLength: long prompt warns for Copilot (Pitfall 7)

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ checkPromptLength: excessive prompt fails for Copilot

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ checkPromptLength: long prompt fine for Claude

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ checkPromptLength: null prompt handled

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: null frontmatter fails gracefully

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: null frontmatter fails gracefully

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateClaudeSpec: tools string format accepted

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    ✓ validateCopilotSpec: tools not array fails

      at test (bin/lib/template-system/validators.test.js:24:13)

[999D[K  console.log
    
    32/32 tests passed

      at Object.<anonymous> (bin/lib/template-system/validators.test.js:397:9)

[999D[K  console.log
    ✓ All validators tests passed!

      at Object.<anonymous> (bin/lib/template-system/validators.test.js:400:11)

  ●  process.exit called with "0"

      399 | if (testsPassed === testsRun) {
      400 |   console.log('✓ All validators tests passed!');
    > 401 |   process.exit(0);
          |           ^
      402 | } else {
      403 |   console.error(`✗ ${testsRun - testsPassed} tests failed`);
      404 |   process.exit(1);

      at Object.<anonymous> (bin/lib/template-system/validators.test.js:401:11)
FAIL bin/lib/template-system/validators.test.js
  ● Test suite failed to run

    A jest worker process (pid=42361) crashed for an unknown reason: exitCode=0

      at ChildProcessWorker._onExit (node_modules/jest-worker/build/workers/ChildProcessWorker.js:370:23)

  console.log
    ✓ CANONICAL_TOOLS contains at least 6 safe tools

      at test (bin/lib/template-system/tool-mapper.test.js:27:13)

  console.log
    ✓ CANONICAL_TOOLS includes core tools (Bash, Read, Edit, Grep)

      at test (bin/lib/template-system/tool-mapper.test.js:27:13)

  console.log
    ✓ mapTools preserves exact case for Claude

      at test (bin/lib/template-system/tool-mapper.test.js:27:13)

  console.log
    ✓ mapTools uses PRIMARY aliases for Copilot

      at test (bin/lib/template-system/tool-mapper.test.js:27:13)

  console.log
    ✓ mapTools handles all canonical tools for Claude

      at test (bin/lib/template-system/tool-mapper.test.js:27:13)

  console.log
    ✓ mapTools handles all canonical tools for Copilot

      at test (bin/lib/template-system/tool-mapper.test.js:27:13)

  console.log
    ✓ mapTools filters out platform-unavailable tools

      at test (bin/lib/template-system/tool-mapper.test.js:27:13)

  console.log
    ✓ mapTools handles empty array

      at test (bin/lib/template-system/tool-mapper.test.js:27:13)

  console.error
    ✗ mapTools throws on invalid platform

      27 |     console.log(`✓ ${description}`);
      28 |   } catch (error) {
    > 29 |     console.error(`✗ ${description}`);
         |             ^
      30 |     console.error(`  ${error.message}`);
      31 |     throw error;
      32 |   }

      at test (bin/lib/template-system/tool-mapper.test.js:29:13)
      at Object.<anonymous> (bin/lib/template-system/tool-mapper.test.js:85:1)

  console.error
      The input did not match the regular expression /platform must be "claude" or "copilot"/. Input:
    
    'Error: platform must be "claude", "copilot", or "codex"'

      28 |   } catch (error) {
      29 |     console.error(`✗ ${description}`);
    > 30 |     console.error(`  ${error.message}`);
         |             ^
      31 |     throw error;
      32 |   }
      33 | }

      at test (bin/lib/template-system/tool-mapper.test.js:30:13)
      at Object.<anonymous> (bin/lib/template-system/tool-mapper.test.js:85:1)

FAIL bin/lib/template-system/tool-mapper.test.js
  ● Test suite failed to run

    AssertionError [ERR_ASSERTION]: The input did not match the regular expression /platform must be "claude" or "copilot"/. Input:

    'Error: platform must be "claude", "copilot", or "codex"'

      84 |
      85 | test('mapTools throws on invalid platform', () => {
    > 86 |   assert.throws(
         |          ^
      87 |     () => mapTools(['Bash'], 'invalid'),
      88 |     /platform must be "claude" or "copilot"/
      89 |   );

      at bin/lib/template-system/tool-mapper.test.js:86:10
      at test (bin/lib/template-system/tool-mapper.test.js:25:5)
      at Object.<anonymous> (bin/lib/template-system/tool-mapper.test.js:85:1)

  console.log
    ✓ Valid spec with frontmatter and body

      at test (bin/lib/template-system/spec-parser.test.js:28:13)

  console.log
    ✓ Invalid YAML frontmatter throws error with line info

      at test (bin/lib/template-system/spec-parser.test.js:28:13)

  console.log
    ✓ Missing frontmatter delimiters returns empty frontmatter

      at test (bin/lib/template-system/spec-parser.test.js:28:13)

  console.log
    ✓ Empty file returns empty frontmatter and body

      at test (bin/lib/template-system/spec-parser.test.js:28:13)

  console.log
    ✓ File not found throws descriptive error

      at test (bin/lib/template-system/spec-parser.test.js:28:13)

  console.log
    ✓ parseSpec reads file from filesystem

      at test (bin/lib/template-system/spec-parser.test.js:28:13)

  console.log
    ✓ Complex nested YAML structures parse correctly

      at test (bin/lib/template-system/spec-parser.test.js:28:13)

  console.log
    ✓ Frontmatter only (no body) returns empty body string

      at test (bin/lib/template-system/spec-parser.test.js:28:13)

  console.log
    
    ==================================================

      at Object.<anonymous> (bin/lib/template-system/spec-parser.test.js:199:9)

  console.log
    Tests passed: 8/8

      at Object.<anonymous> (bin/lib/template-system/spec-parser.test.js:200:9)

  console.log
    ==================================================

      at Object.<anonymous> (bin/lib/template-system/spec-parser.test.js:201:9)

  console.log
    ✓ All tests passed!

      at Object.<anonymous> (bin/lib/template-system/spec-parser.test.js:204:11)

  ●  process.exit called with "0"

      203 | if (testsPassed === totalTests) {
      204 |   console.log('✓ All tests passed!');
    > 205 |   process.exit(0);
          |           ^
      206 | } else {
      207 |   console.error('✗ Some tests failed');
      208 |   process.exit(1);

      at Object.<anonymous> (bin/lib/template-system/spec-parser.test.js:205:11)
FAIL bin/lib/template-system/spec-parser.test.js
  ● Test suite failed to run

    A jest worker process (pid=42362) crashed for an unknown reason: exitCode=0

      at ChildProcessWorker._onExit (node_modules/jest-worker/build/workers/ChildProcessWorker.js:370:23)

  console.log
    
    === Template System Integration Tests ===

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:886:9)

  console.log
    Test 1: Happy path - Complete generation

      at testHappyPath (bin/lib/template-system/integration.test.js:22:11)

  console.error
    
    ✗ Test failed: Generation should succeed
    
    false !== true

      922 |   process.exit(0);
      923 | } catch (error) {
    > 924 |   console.error('\n✗ Test failed:', error.message);
          |           ^
      925 |   console.error(error.stack);
      926 |   process.exit(1);
      927 | } finally {

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:924:11)

  console.error
    AssertionError [ERR_ASSERTION]: Generation should succeed
    
    false !== true
    
        at testHappyPath (/workspace/bin/lib/template-system/integration.test.js:41:10)
        at Object.<anonymous> (/workspace/bin/lib/template-system/integration.test.js:890:3)
        at Runtime._execModule (/workspace/node_modules/jest-runtime/build/index.js:1439:24)
        at Runtime._loadModule (/workspace/node_modules/jest-runtime/build/index.js:1022:12)
        at Runtime.requireModule (/workspace/node_modules/jest-runtime/build/index.js:882:12)
        at jestAdapter (/workspace/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:77:13)
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at runTestInternal (/workspace/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/workspace/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/workspace/node_modules/jest-runner/build/testWorker.js:106:12)

      923 | } catch (error) {
      924 |   console.error('\n✗ Test failed:', error.message);
    > 925 |   console.error(error.stack);
          |           ^
      926 |   process.exit(1);
      927 | } finally {
      928 |   // Cleanup temp directory

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:925:11)

  ●  process.exit called with "1"

      924 |   console.error('\n✗ Test failed:', error.message);
      925 |   console.error(error.stack);
    > 926 |   process.exit(1);
          |           ^
      927 | } finally {
      928 |   // Cleanup temp directory
      929 |   try {

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:926:11)
  console.log
    ✓ Test 1: Simple variable substitution

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:15:11)

  console.log
    ✓ Test 2: Multiple variables in same template

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:26:11)

  console.log
    ✓ Test 3: Undefined variable throws error with variable name

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:40:11)

  console.log
    ✓ Test 4: Boolean values converted to strings

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:49:11)

  console.log
    ✓ Test 5: Null/undefined values replaced with empty string

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:63:11)

  console.log
    ✓ Test 6: Valid YAML passes validation

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:77:11)

  console.log
    ✓ Test 7: Invalid YAML caught with line number

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:89:11)

  console.log
    ✓ Test 8: Malformed YAML provides helpful error message

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:100:11)

  console.log
    ✓ Test 9: Template with whitespace in variable syntax

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:109:11)

  console.log
    ✓ Test 10: Multiple occurrences of same variable

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:118:11)

  console.log
    ✓ Test 11: Empty template

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:127:11)

  console.log
    ✓ Test 12: Template with no variables

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:136:11)

  console.log
    ✓ Test 13: renderAndValidate combines both operations

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:147:11)

  console.log
    ✓ Test 14: renderAndValidate catches render errors

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:158:11)

  console.log
    ✓ Test 15: Validate handles non-string input

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:166:11)

  console.log
    ✓ Test 16: Render handles non-string template

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:177:11)

  console.log
    ✓ Test 17: Complex YAML structure validation

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:196:11)

  console.log
    
    ✅ All engine tests passed

      at Object.<anonymous> (bin/lib/template-system/engine.test.js:199:9)

FAIL bin/lib/template-system/engine.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

  console.log
    Testing structured-return-parser...

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:11:11)

  console.log
    Test 1: Valid RESEARCH COMPLETE block

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:17:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:30:11)

  console.log
    Test 2: Valid PLAN COMPLETE block

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:34:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:45:11)

  console.log
    Test 3: Valid EXECUTION COMPLETE block

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:49:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:60:11)

  console.log
    Test 4: Valid RESEARCH BLOCKED block

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:64:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:74:11)

  console.log
    Test 5: Valid CHECKPOINT REACHED block

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:78:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:89:11)

  console.log
    Test 6: Malformed markdown (no header)

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:93:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:99:11)

  console.log
    Test 7: Multiple headers (uses first match)

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:103:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:116:11)

  console.log
    Test 8: Empty content after header

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:120:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:128:11)

  console.log
    Test 9: Header at end of string

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:132:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:140:11)

  console.log
    Test 10: hasStructuredReturn utility

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:144:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:150:11)

  console.log
    Test 11: extractAllStructuredReturns with multiple blocks

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:154:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:172:11)

  console.log
    Test 12: Null/undefined input handling

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:176:11)

  console.log
      ✓ Passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:182:11)

  console.log
    ═══════════════════════════════════════

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:185:11)

  console.log
    ✓ All 12 tests passed

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:186:11)

  console.log
    structured-return-parser.js is working correctly

      at runTests (bin/lib/orchestration/structured-return-parser.test.js:187:11)

FAIL bin/lib/orchestration/structured-return-parser.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

  console.log
    Testing sequential-spawn-validator...

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:12:11)

  console.log
    ✓ Test 1: Module exports correct interface

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:29:13)

  console.log
    ✓ Test 2: validateSequentialSpawning returns correct structure

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:45:13)

  console.log
    ✓ Test 3: detectCheckpointFile finds checkpoint files

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:73:13)

  console.log
    ✓ Test 4: detectCheckpointFile handles missing directory

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:84:13)

  console.log
    ✓ Test 5: detectRespawnWithReference detects references

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:97:13)

  console.log
    ✓ Test 6: detectRespawnWithReference returns false without reference

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:110:13)

  console.log
    ✓ Test 7: verifyContextPassing detects @-reference

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:123:13)

  console.log
    ✓ Test 8: parseCheckpointWorkflow counts Task() calls

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:139:13)

  console.log
    ✓ Test 9: parseCheckpointWorkflow detects checkpoint keywords

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:151:13)

  console.log
    ✓ Test 10: parseCheckpointWorkflow extracts @-references

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:165:13)

  console.log
    
    ==================================================

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:173:11)

  console.log
    Tests passed: 10

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:174:11)

  console.log
    Tests failed: 0

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:175:11)

  console.log
    ==================================================

      at runTests (bin/lib/orchestration/sequential-spawn-validator.test.js:176:11)

FAIL bin/lib/orchestration/sequential-spawn-validator.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/orchestration/result-validator.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

  console.log
    Testing reference-resolver...

      at runTests (bin/lib/orchestration/reference-resolver.test.js:12:11)

  console.log
    ✓ Test 1: Module exports correct interface

      at runTests (bin/lib/orchestration/reference-resolver.test.js:31:13)

  console.log
    ✓ Test 2: Extract @-references from prompt

      at runTests (bin/lib/orchestration/reference-resolver.test.js:45:13)

  console.log
    ✓ Test 3: Validate existing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:59:13)

  console.log
    ✓ Test 4: Detect missing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:73:13)

  console.log
    ✓ Test 5: Interpolate {var} format

      at runTests (bin/lib/orchestration/reference-resolver.test.js:88:13)

  console.log
    ✓ Test 6: Interpolate @{var} format

      at runTests (bin/lib/orchestration/reference-resolver.test.js:102:13)

  console.log
    ✓ Test 7: Interpolation order correct

      at runTests (bin/lib/orchestration/reference-resolver.test.js:119:13)

  console.log
    ✓ Test 8: Handle undefined variables

      at runTests (bin/lib/orchestration/reference-resolver.test.js:132:13)

  console.log
    ✓ Test 9: Extract variables from template

      at runTests (bin/lib/orchestration/reference-resolver.test.js:149:13)

  console.log
    ✓ Test 10: Resolve relative paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:162:13)

  console.log
    ✓ Test 11: Resolve absolute paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:175:13)

  console.log
    ✓ Test 12: Resolve dot-relative paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:187:13)

  console.error
    ✗ Test 13 failed: Should validate successfully
    
    false !== true

      205 |     passed++;
      206 |   } catch (err) {
    > 207 |     console.error('✗ Test 13 failed:', err.message);
          |             ^
      208 |     failed++;
      209 |   }
      210 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:207:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)

  console.log
    ✓ Test 14: validateAndInterpolate detects missing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:220:13)

  console.log
    ✓ Test 15: Handle empty prompt

      at runTests (bin/lib/orchestration/reference-resolver.test.js:232:13)

  console.error
    ✗ Test 16 failed: Should validate all existing files
    
    false !== true

      246 |     passed++;
      247 |   } catch (err) {
    > 248 |     console.error('✗ Test 16 failed:', err.message);
          |             ^
      249 |     failed++;
      250 |   }
      251 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:248:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)

  console.log
    
    ==================================================

      at runTests (bin/lib/orchestration/reference-resolver.test.js:253:11)

  console.log
    Tests passed: 14

      at runTests (bin/lib/orchestration/reference-resolver.test.js:254:11)

  console.log
    Tests failed: 2

      at runTests (bin/lib/orchestration/reference-resolver.test.js:255:11)

  console.log
    ==================================================

      at runTests (bin/lib/orchestration/reference-resolver.test.js:256:11)

  ●  process.exit called with "1"

      257 |
      258 |   if (failed > 0) {
    > 259 |     process.exit(1);
          |             ^
      260 |   }
      261 | }
      262 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:259:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)
FAIL bin/lib/template-system/field-transformer.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/template-system/context-builder.test.js
  ● Test suite failed to run

    Invalid scope: undefined. Expected 'global' or 'local'

      61 |   }
      62 |   
    > 63 |   throw new Error(`Invalid scope: ${scope}. Expected 'global' or 'local'`);
         |         ^
      64 | }
      65 |
      66 | /**

      at getConfigPaths (bin/lib/paths.js:63:9)
      at getConfigPaths (bin/lib/template-system/context-builder.js:28:23)
      at Object.<anonymous> (bin/lib/template-system/context-builder.test.js:11:15)

  console.log
    
    === Template System Integration Tests ===

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:886:9)

  console.log
    Test 1: Happy path - Complete generation

      at testHappyPath (bin/lib/template-system/integration.test.js:22:11)

  console.error
    
    ✗ Test failed: Generation should succeed
    
    false !== true

      922 |   process.exit(0);
      923 | } catch (error) {
    > 924 |   console.error('\n✗ Test failed:', error.message);
          |           ^
      925 |   console.error(error.stack);
      926 |   process.exit(1);
      927 | } finally {

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:924:11)

  console.error
    AssertionError [ERR_ASSERTION]: Generation should succeed
    
    false !== true
    
        at testHappyPath (/workspace/bin/lib/template-system/integration.test.js:41:10)
        at Object.<anonymous> (/workspace/bin/lib/template-system/integration.test.js:890:3)
        at Runtime._execModule (/workspace/node_modules/jest-runtime/build/index.js:1439:24)
        at Runtime._loadModule (/workspace/node_modules/jest-runtime/build/index.js:1022:12)
        at Runtime.requireModule (/workspace/node_modules/jest-runtime/build/index.js:882:12)
        at jestAdapter (/workspace/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:77:13)
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at runTestInternal (/workspace/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/workspace/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/workspace/node_modules/jest-runner/build/testWorker.js:106:12)

      923 | } catch (error) {
      924 |   console.error('\n✗ Test failed:', error.message);
    > 925 |   console.error(error.stack);
          |           ^
      926 |   process.exit(1);
      927 | } finally {
      928 |   // Cleanup temp directory

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:925:11)

  ●  process.exit called with "1"

      924 |   console.error('\n✗ Test failed:', error.message);
      925 |   console.error(error.stack);
    > 926 |   process.exit(1);
          |           ^
      927 | } finally {
      928 |   // Cleanup temp directory
      929 |   try {

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:926:11)
FAIL bin/lib/orchestration/performance-tracker.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/orchestration/parallel-spawn-validator.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

  console.log
    Testing reference-resolver...

      at runTests (bin/lib/orchestration/reference-resolver.test.js:12:11)

  console.log
    ✓ Test 1: Module exports correct interface

      at runTests (bin/lib/orchestration/reference-resolver.test.js:31:13)

  console.log
    ✓ Test 2: Extract @-references from prompt

      at runTests (bin/lib/orchestration/reference-resolver.test.js:45:13)

  console.log
    ✓ Test 3: Validate existing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:59:13)

  console.log
    ✓ Test 4: Detect missing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:73:13)

  console.log
    ✓ Test 5: Interpolate {var} format

      at runTests (bin/lib/orchestration/reference-resolver.test.js:88:13)

  console.log
    ✓ Test 6: Interpolate @{var} format

      at runTests (bin/lib/orchestration/reference-resolver.test.js:102:13)

  console.log
    ✓ Test 7: Interpolation order correct

      at runTests (bin/lib/orchestration/reference-resolver.test.js:119:13)

  console.log
    ✓ Test 8: Handle undefined variables

      at runTests (bin/lib/orchestration/reference-resolver.test.js:132:13)

  console.log
    ✓ Test 9: Extract variables from template

      at runTests (bin/lib/orchestration/reference-resolver.test.js:149:13)

  console.log
    ✓ Test 10: Resolve relative paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:162:13)

  console.log
    ✓ Test 11: Resolve absolute paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:175:13)

  console.log
    ✓ Test 12: Resolve dot-relative paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:187:13)

  console.error
    ✗ Test 13 failed: Should validate successfully
    
    false !== true

      205 |     passed++;
      206 |   } catch (err) {
    > 207 |     console.error('✗ Test 13 failed:', err.message);
          |             ^
      208 |     failed++;
      209 |   }
      210 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:207:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)

  console.log
    ✓ Test 14: validateAndInterpolate detects missing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:220:13)

  console.log
    ✓ Test 15: Handle empty prompt

      at runTests (bin/lib/orchestration/reference-resolver.test.js:232:13)

  console.error
    ✗ Test 16 failed: Should validate all existing files
    
    false !== true

      246 |     passed++;
      247 |   } catch (err) {
    > 248 |     console.error('✗ Test 16 failed:', err.message);
          |             ^
      249 |     failed++;
      250 |   }
      251 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:248:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)

  console.log
    
    ==================================================

      at runTests (bin/lib/orchestration/reference-resolver.test.js:253:11)

  console.log
    Tests passed: 14

      at runTests (bin/lib/orchestration/reference-resolver.test.js:254:11)

  console.log
    Tests failed: 2

      at runTests (bin/lib/orchestration/reference-resolver.test.js:255:11)

  console.log
    ==================================================

      at runTests (bin/lib/orchestration/reference-resolver.test.js:256:11)

  ●  process.exit called with "1"

      257 |
      258 |   if (failed > 0) {
    > 259 |     process.exit(1);
          |             ^
      260 |   }
      261 | }
      262 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:259:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)
  console.log
    
    === Template System Integration Tests ===

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:886:9)

  console.log
    Test 1: Happy path - Complete generation

      at testHappyPath (bin/lib/template-system/integration.test.js:22:11)

  console.error
    
    ✗ Test failed: Generation should succeed
    
    false !== true

      922 |   process.exit(0);
      923 | } catch (error) {
    > 924 |   console.error('\n✗ Test failed:', error.message);
          |           ^
      925 |   console.error(error.stack);
      926 |   process.exit(1);
      927 | } finally {

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:924:11)

  console.error
    AssertionError [ERR_ASSERTION]: Generation should succeed
    
    false !== true
    
        at testHappyPath (/workspace/bin/lib/template-system/integration.test.js:41:10)
        at Object.<anonymous> (/workspace/bin/lib/template-system/integration.test.js:890:3)
        at Runtime._execModule (/workspace/node_modules/jest-runtime/build/index.js:1439:24)
        at Runtime._loadModule (/workspace/node_modules/jest-runtime/build/index.js:1022:12)
        at Runtime.requireModule (/workspace/node_modules/jest-runtime/build/index.js:882:12)
        at jestAdapter (/workspace/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:77:13)
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at runTestInternal (/workspace/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/workspace/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/workspace/node_modules/jest-runner/build/testWorker.js:106:12)

      923 | } catch (error) {
      924 |   console.error('\n✗ Test failed:', error.message);
    > 925 |   console.error(error.stack);
          |           ^
      926 |   process.exit(1);
      927 | } finally {
      928 |   // Cleanup temp directory

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:925:11)

  ●  process.exit called with "1"

      924 |   console.error('\n✗ Test failed:', error.message);
      925 |   console.error(error.stack);
    > 926 |   process.exit(1);
          |           ^
      927 | } finally {
      928 |   // Cleanup temp directory
      929 |   try {

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:926:11)
  console.log
    Testing reference-resolver...

      at runTests (bin/lib/orchestration/reference-resolver.test.js:12:11)

  console.log
    ✓ Test 1: Module exports correct interface

      at runTests (bin/lib/orchestration/reference-resolver.test.js:31:13)

  console.log
    ✓ Test 2: Extract @-references from prompt

      at runTests (bin/lib/orchestration/reference-resolver.test.js:45:13)

  console.log
    ✓ Test 3: Validate existing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:59:13)

  console.log
    ✓ Test 4: Detect missing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:73:13)

  console.log
    ✓ Test 5: Interpolate {var} format

      at runTests (bin/lib/orchestration/reference-resolver.test.js:88:13)

  console.log
    ✓ Test 6: Interpolate @{var} format

      at runTests (bin/lib/orchestration/reference-resolver.test.js:102:13)

  console.log
    ✓ Test 7: Interpolation order correct

      at runTests (bin/lib/orchestration/reference-resolver.test.js:119:13)

  console.log
    ✓ Test 8: Handle undefined variables

      at runTests (bin/lib/orchestration/reference-resolver.test.js:132:13)

  console.log
    ✓ Test 9: Extract variables from template

      at runTests (bin/lib/orchestration/reference-resolver.test.js:149:13)

  console.log
    ✓ Test 10: Resolve relative paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:162:13)

  console.log
    ✓ Test 11: Resolve absolute paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:175:13)

  console.log
    ✓ Test 12: Resolve dot-relative paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:187:13)

  console.error
    ✗ Test 13 failed: Should validate successfully
    
    false !== true

      205 |     passed++;
      206 |   } catch (err) {
    > 207 |     console.error('✗ Test 13 failed:', err.message);
          |             ^
      208 |     failed++;
      209 |   }
      210 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:207:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)

  console.log
    ✓ Test 14: validateAndInterpolate detects missing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:220:13)

  console.log
    ✓ Test 15: Handle empty prompt

      at runTests (bin/lib/orchestration/reference-resolver.test.js:232:13)

  console.error
    ✗ Test 16 failed: Should validate all existing files
    
    false !== true

      246 |     passed++;
      247 |   } catch (err) {
    > 248 |     console.error('✗ Test 16 failed:', err.message);
          |             ^
      249 |     failed++;
      250 |   }
      251 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:248:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)

  console.log
    
    ==================================================

      at runTests (bin/lib/orchestration/reference-resolver.test.js:253:11)

  console.log
    Tests passed: 14

      at runTests (bin/lib/orchestration/reference-resolver.test.js:254:11)

  console.log
    Tests failed: 2

      at runTests (bin/lib/orchestration/reference-resolver.test.js:255:11)

  console.log
    ==================================================

      at runTests (bin/lib/orchestration/reference-resolver.test.js:256:11)

  ●  process.exit called with "1"

      257 |
      258 |   if (failed > 0) {
    > 259 |     process.exit(1);
          |             ^
      260 |   }
      261 | }
      262 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:259:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)
  console.log
    
    === Template System Integration Tests ===

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:886:9)

  console.log
    Test 1: Happy path - Complete generation

      at testHappyPath (bin/lib/template-system/integration.test.js:22:11)

  console.error
    
    ✗ Test failed: Generation should succeed
    
    false !== true

      922 |   process.exit(0);
      923 | } catch (error) {
    > 924 |   console.error('\n✗ Test failed:', error.message);
          |           ^
      925 |   console.error(error.stack);
      926 |   process.exit(1);
      927 | } finally {

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:924:11)

  console.error
    AssertionError [ERR_ASSERTION]: Generation should succeed
    
    false !== true
    
        at testHappyPath (/workspace/bin/lib/template-system/integration.test.js:41:10)
        at Object.<anonymous> (/workspace/bin/lib/template-system/integration.test.js:890:3)
        at Runtime._execModule (/workspace/node_modules/jest-runtime/build/index.js:1439:24)
        at Runtime._loadModule (/workspace/node_modules/jest-runtime/build/index.js:1022:12)
        at Runtime.requireModule (/workspace/node_modules/jest-runtime/build/index.js:882:12)
        at jestAdapter (/workspace/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:77:13)
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at runTestInternal (/workspace/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/workspace/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/workspace/node_modules/jest-runner/build/testWorker.js:106:12)

      923 | } catch (error) {
      924 |   console.error('\n✗ Test failed:', error.message);
    > 925 |   console.error(error.stack);
          |           ^
      926 |   process.exit(1);
      927 | } finally {
      928 |   // Cleanup temp directory

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:925:11)

  ●  process.exit called with "1"

      924 |   console.error('\n✗ Test failed:', error.message);
      925 |   console.error(error.stack);
    > 926 |   process.exit(1);
          |           ^
      927 | } finally {
      928 |   // Cleanup temp directory
      929 |   try {

      at Object.<anonymous> (bin/lib/template-system/integration.test.js:926:11)
FAIL bin/lib/template-system/integration.test.js
  ● Test suite failed to run

    Jest worker encountered 4 child process exceptions, exceeding retry limit

      at ChildProcessWorker.initialize (node_modules/jest-worker/build/workers/ChildProcessWorker.js:181:21)

  console.log
    Testing reference-resolver...

      at runTests (bin/lib/orchestration/reference-resolver.test.js:12:11)

  console.log
    ✓ Test 1: Module exports correct interface

      at runTests (bin/lib/orchestration/reference-resolver.test.js:31:13)

  console.log
    ✓ Test 2: Extract @-references from prompt

      at runTests (bin/lib/orchestration/reference-resolver.test.js:45:13)

  console.log
    ✓ Test 3: Validate existing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:59:13)

  console.log
    ✓ Test 4: Detect missing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:73:13)

  console.log
    ✓ Test 5: Interpolate {var} format

      at runTests (bin/lib/orchestration/reference-resolver.test.js:88:13)

  console.log
    ✓ Test 6: Interpolate @{var} format

      at runTests (bin/lib/orchestration/reference-resolver.test.js:102:13)

  console.log
    ✓ Test 7: Interpolation order correct

      at runTests (bin/lib/orchestration/reference-resolver.test.js:119:13)

  console.log
    ✓ Test 8: Handle undefined variables

      at runTests (bin/lib/orchestration/reference-resolver.test.js:132:13)

  console.log
    ✓ Test 9: Extract variables from template

      at runTests (bin/lib/orchestration/reference-resolver.test.js:149:13)

  console.log
    ✓ Test 10: Resolve relative paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:162:13)

  console.log
    ✓ Test 11: Resolve absolute paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:175:13)

  console.log
    ✓ Test 12: Resolve dot-relative paths

      at runTests (bin/lib/orchestration/reference-resolver.test.js:187:13)

  console.error
    ✗ Test 13 failed: Should validate successfully
    
    false !== true

      205 |     passed++;
      206 |   } catch (err) {
    > 207 |     console.error('✗ Test 13 failed:', err.message);
          |             ^
      208 |     failed++;
      209 |   }
      210 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:207:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)

  console.log
    ✓ Test 14: validateAndInterpolate detects missing files

      at runTests (bin/lib/orchestration/reference-resolver.test.js:220:13)

  console.log
    ✓ Test 15: Handle empty prompt

      at runTests (bin/lib/orchestration/reference-resolver.test.js:232:13)

  console.error
    ✗ Test 16 failed: Should validate all existing files
    
    false !== true

      246 |     passed++;
      247 |   } catch (err) {
    > 248 |     console.error('✗ Test 16 failed:', err.message);
          |             ^
      249 |     failed++;
      250 |   }
      251 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:248:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)

  console.log
    
    ==================================================

      at runTests (bin/lib/orchestration/reference-resolver.test.js:253:11)

  console.log
    Tests passed: 14

      at runTests (bin/lib/orchestration/reference-resolver.test.js:254:11)

  console.log
    Tests failed: 2

      at runTests (bin/lib/orchestration/reference-resolver.test.js:255:11)

  console.log
    ==================================================

      at runTests (bin/lib/orchestration/reference-resolver.test.js:256:11)

  ●  process.exit called with "1"

      257 |
      258 |   if (failed > 0) {
    > 259 |     process.exit(1);
          |             ^
      260 |   }
      261 | }
      262 |

      at runTests (bin/lib/orchestration/reference-resolver.test.js:259:13)
      at Object.<anonymous> (bin/lib/orchestration/reference-resolver.test.js:263:1)
FAIL bin/lib/orchestration/reference-resolver.test.js
  ● Test suite failed to run

    Jest worker encountered 4 child process exceptions, exceeding retry limit

      at ChildProcessWorker.initialize (node_modules/jest-worker/build/workers/ChildProcessWorker.js:181:21)

--------------------------------|---------|----------|---------|---------|------------------------------------
File                            | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                  
--------------------------------|---------|----------|---------|---------|------------------------------------
All files                       |   10.47 |     9.11 |   10.58 |    10.3 |                                    
 bin                            |       0 |        0 |       0 |       0 |                                    
  install.js                    |       0 |        0 |       0 |       0 | 3-1793                             
 bin/doc-generator              |       0 |        0 |       0 |       0 |                                    
  add-version-stamps.js         |       0 |        0 |       0 |       0 | 12-195                             
  extract-capabilities.js       |       0 |        0 |       0 |       0 | 12-333                             
  extract-comments.js           |       0 |        0 |       0 |       0 | 11-155                             
  generate-comparison.js        |       0 |        0 |       0 |       0 | 12-192                             
  generate-matrix.js            |       0 |        0 |       0 |       0 | 12-155                             
 bin/lib                        |      87 |    92.42 |      88 |   86.63 |                                    
  codex-warning.js              |   93.93 |       80 |     100 |   93.93 | 93-94                              
  colors.js                     |     100 |      100 |     100 |     100 |                                    
  conflict-resolver.js          |   97.77 |      100 |     100 |   97.77 | 79                                 
  flag-parser.js                |     100 |      100 |     100 |     100 |                                    
  flag-validator.js             |     100 |      100 |     100 |     100 |                                    
  old-flag-detector.js          |     100 |      100 |     100 |     100 |                                    
  path-validator.js             |   97.72 |    94.11 |     100 |   97.61 | 74                                 
  paths.js                      |     100 |      100 |     100 |     100 |                                    
  upgrade.js                    |       0 |        0 |       0 |       0 | 7-83                               
 bin/lib/adapters               |       0 |        0 |       0 |       0 |                                    
  claude.js                     |       0 |        0 |       0 |       0 | 8-142                              
  codex.js                      |       0 |        0 |       0 |       0 | 8-200                              
  copilot.js                    |       0 |        0 |       0 |       0 | 8-144                              
 bin/lib/adapters/shared        |       0 |        0 |       0 |       0 |                                    
  format-converter.js           |       0 |        0 |       0 |       0 | 45-92                              
  path-rewriter.js              |       0 |        0 |       0 |       0 | 37-82                              
 bin/lib/cli-detection          |       0 |        0 |       0 |       0 |                                    
  detect.js                     |       0 |        0 |       0 |       0 | 6-79                               
  recommender.js                |       0 |        0 |       0 |       0 | 7-126                              
 bin/lib/menu                   |   83.33 |    73.33 |   66.66 |   83.33 |                                    
  interactive-menu.js           |   83.33 |    73.33 |   66.66 |   83.33 | 39-42                              
 bin/lib/migration              |       0 |        0 |       0 |       0 |                                    
  backup-handler.js             |       0 |        0 |       0 |       0 | 1-64                               
  detect-old-structure.js       |       0 |        0 |       0 |       0 | 1-44                               
  migration-flow.js             |       0 |        0 |       0 |       0 | 1-67                               
  migration-prompts.js          |       0 |        0 |       0 |       0 | 1-25                               
 bin/lib/orchestration          |       0 |        0 |       0 |       0 |                                    
  agent-invoker.js              |       0 |        0 |       0 |       0 | 9-150                              
  agent-registry.js             |       0 |        0 |       0 |       0 | 8-153                              
  capability-matrix.js          |       0 |        0 |       0 |       0 | 26-171                             
  equivalence-test.js           |       0 |        0 |       0 |       0 | 15-281                             
  generate-capability-docs.js   |       0 |        0 |       0 |       0 | 8-107                              
  orchestration-test-suite.js   |       0 |        0 |       0 |       0 | 23-436                             
  parallel-spawn-validator.js   |       0 |        0 |       0 |       0 | 16-208                             
  performance-tracker.js        |       0 |        0 |       0 |       0 | 10-201                             
  reference-resolver.js         |       0 |        0 |       0 |       0 | 11-216                             
  result-validator.js           |       0 |        0 |       0 |       0 | 8-204                              
  sequential-spawn-validator.js |       0 |        0 |       0 |       0 | 14-183                             
  structured-return-parser.js   |       0 |        0 |       0 |       0 | 25-137                             
  validate-planning-dir.js      |       0 |        0 |       0 |       0 | 10-111                             
 bin/lib/output                 |   84.61 |    84.61 |   77.27 |   85.96 |                                    
  formatter.js                  |   16.66 |        0 |       0 |      20 | 13-25                              
  reporter.js                   |   91.37 |    91.66 |   89.47 |   92.15 | 87-98                              
  symbols.js                    |     100 |      100 |     100 |     100 |                                    
 bin/lib/template-system        |    9.87 |     3.83 |    3.96 |    9.83 |                                    
  agent-converter.js            |       0 |        0 |       0 |       0 | 8-323                              
  context-builder.js            |   11.11 |      2.7 |      10 |   11.11 | 22,31-284,307-312                  
  engine.js                     |    4.16 |        0 |       0 |    4.16 | 20-154                             
  field-transformer.js          |   18.36 |        0 |       0 |   18.75 | 18,137-308                         
  generator.js                  |    8.03 |     8.24 |    4.34 |    8.03 | 27-457,497,510,523,538-553,590-912 
  index.js                      |       0 |      100 |     100 |       0 | 8-13                               
  migrate-agents.js             |       0 |        0 |       0 |       0 | 8-231                              
  spec-parser.js                |   11.62 |        0 |       0 |    11.9 | 20-161                             
  tool-mapper.js                |   41.66 |    12.32 |      25 |   40.42 | 224-410                            
  validators.js                 |    4.92 |        0 |       0 |    5.03 | 42-445                             
 bin/lib/test-helpers           |       0 |        0 |       0 |       0 |                                    
  cli-invoker.js                |       0 |        0 |       0 |       0 | 1-146                              
--------------------------------|---------|----------|---------|---------|------------------------------------
Summary of all failing tests
FAIL __tests__/platform-integration.test.js
  ● Platform Integration (TEST-05) › All platforms have spec directories configured

    expect(received).toContain(expected) // indexOf

    Expected substring: "get-shit-done"
    Received string:    "/workspace/.github/copilot/skills"

      15 |       const fullPath = path.join(__dirname, '..', dir);
      16 |       expect(fullPath).toContain(dir);
    > 17 |       expect(fullPath).toContain('get-shit-done');
         |                        ^
      18 |     }
      19 |   });
      20 |   

      at Object.<anonymous> (__tests__/platform-integration.test.js:17:24)

FAIL bin/lib/flag-parser.test.js
  ● Flag Parser › Return structure › has no unexpected properties

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

      Array [
        "platforms",
        "scope",
        "needsMenu",
    +   "configDir",
      ]

      282 |     test('has no unexpected properties', () => {
      283 |       const result = parseFlags(['node', 'install.js', '--claude']);
    > 284 |       expect(Object.keys(result)).toEqual(['platforms', 'scope', 'needsMenu']);
          |                                   ^
      285 |     });
      286 |   });
      287 | });

      at Object.<anonymous> (bin/lib/flag-parser.test.js:284:35)

FAIL __tests__/conditional-rendering.test.js
  ● Conditional Rendering (TEST-02) › Platform conditionals render correctly

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      29 |       
      30 |       // Should succeed
    > 31 |       expect(result.success).toBe(true);
         |                              ^
      32 |       expect(result.output).toBeDefined();
      33 |       
      34 |       const rendered = result.output;

      at Object.<anonymous> (__tests__/conditional-rendering.test.js:31:30)

  ● Conditional Rendering (TEST-02) › Tools array renders without conditionals

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      64 |       const result = generateFromSpec(testSpec, platform);
      65 |       
    > 66 |       expect(result.success).toBe(true);
         |                              ^
      67 |       expect(result.output).toBeDefined();
      68 |       
      69 |       const rendered = result.output;

      at Object.<anonymous> (__tests__/conditional-rendering.test.js:66:30)

FAIL __tests__/metadata-generation.test.js
  ● Metadata Generation (TEST-04) › Copilot generates metadata fields

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      14 |     const result = generateFromSpec(testSpec, 'copilot');
      15 |     
    > 16 |     expect(result.success).toBe(true);
         |                            ^
      17 |     expect(result.output).toBeDefined();
      18 |     
      19 |     const rendered = result.output;

      at Object.<anonymous> (__tests__/metadata-generation.test.js:16:28)

  ● Metadata Generation (TEST-04) › Claude does not generate metadata fields

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      37 |     const result = generateFromSpec(testSpec, 'claude');
      38 |     
    > 39 |     expect(result.success).toBe(true);
         |                            ^
      40 |     expect(result.output).toBeDefined();
      41 |     
      42 |     const rendered = result.output;

      at Object.<anonymous> (__tests__/metadata-generation.test.js:39:28)

  ● Metadata Generation (TEST-04) › Platform-specific tool names are correct

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      59 |     // Claude uses capitalized tool names
      60 |     const claudeResult = generateFromSpec(testSpec, 'claude');
    > 61 |     expect(claudeResult.success).toBe(true);
         |                                  ^
      62 |     // view -> Read, edit -> Edit, bash -> Bash
      63 |     expect(claudeResult.output).toContain('tools: Read, Edit, Bash');
      64 |     

      at Object.<anonymous> (__tests__/metadata-generation.test.js:61:34)

FAIL bin/lib/template-system/validators.test.js
  ● Test suite failed to run

    A jest worker process (pid=42361) crashed for an unknown reason: exitCode=0

      at ChildProcessWorker._onExit (node_modules/jest-worker/build/workers/ChildProcessWorker.js:370:23)

FAIL bin/lib/template-system/tool-mapper.test.js
  ● Test suite failed to run

    AssertionError [ERR_ASSERTION]: The input did not match the regular expression /platform must be "claude" or "copilot"/. Input:

    'Error: platform must be "claude", "copilot", or "codex"'

      84 |
      85 | test('mapTools throws on invalid platform', () => {
    > 86 |   assert.throws(
         |          ^
      87 |     () => mapTools(['Bash'], 'invalid'),
      88 |     /platform must be "claude" or "copilot"/
      89 |   );

      at bin/lib/template-system/tool-mapper.test.js:86:10
      at test (bin/lib/template-system/tool-mapper.test.js:25:5)
      at Object.<anonymous> (bin/lib/template-system/tool-mapper.test.js:85:1)

FAIL bin/lib/template-system/spec-parser.test.js
  ● Test suite failed to run

    A jest worker process (pid=42362) crashed for an unknown reason: exitCode=0

      at ChildProcessWorker._onExit (node_modules/jest-worker/build/workers/ChildProcessWorker.js:370:23)

FAIL bin/lib/template-system/engine.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/orchestration/structured-return-parser.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/orchestration/sequential-spawn-validator.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/orchestration/result-validator.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/template-system/field-transformer.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/template-system/context-builder.test.js
  ● Test suite failed to run

    Invalid scope: undefined. Expected 'global' or 'local'

      61 |   }
      62 |   
    > 63 |   throw new Error(`Invalid scope: ${scope}. Expected 'global' or 'local'`);
         |         ^
      64 | }
      65 |
      66 | /**

      at getConfigPaths (bin/lib/paths.js:63:9)
      at getConfigPaths (bin/lib/template-system/context-builder.js:28:23)
      at Object.<anonymous> (bin/lib/template-system/context-builder.test.js:11:15)

FAIL bin/lib/orchestration/performance-tracker.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/orchestration/parallel-spawn-validator.test.js
  ● Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/emittery/index.js:361:23)

FAIL bin/lib/template-system/integration.test.js
  ● Test suite failed to run

    Jest worker encountered 4 child process exceptions, exceeding retry limit

      at ChildProcessWorker.initialize (node_modules/jest-worker/build/workers/ChildProcessWorker.js:181:21)

FAIL bin/lib/orchestration/reference-resolver.test.js
  ● Test suite failed to run

    Jest worker encountered 4 child process exceptions, exceeding retry limit

      at ChildProcessWorker.initialize (node_modules/jest-worker/build/workers/ChildProcessWorker.js:181:21)


Test Suites: 17 failed, 12 passed, 29 total
Tests:       7 failed, 247 passed, 254 total
Snapshots:   0 total
Time:        5.555 s
Ran all test suites.

=== File Count Baseline ===
97

bin/doc-generator/add-version-stamps.js
bin/doc-generator/extract-capabilities.js
bin/doc-generator/extract-comments.js
bin/doc-generator/generate-comparison.js
bin/doc-generator/generate-matrix.js
bin/install.js
bin/install.test.js
bin/lib/adapters/claude.js
bin/lib/adapters/codex.js
bin/lib/adapters/copilot.js
bin/lib/adapters/shared/format-converter.js
bin/lib/adapters/shared/path-rewriter.js
bin/lib/cli-detection/detect.js
bin/lib/cli-detection/recommender.js
bin/lib/codex-warning.js
bin/lib/codex-warning.test.js
bin/lib/colors.js
bin/lib/conflict-resolver.js
bin/lib/conflict-resolver.test.js
bin/lib/flag-parser.js
bin/lib/flag-parser.test.js
bin/lib/flag-validator.js
bin/lib/flag-validator.test.js
bin/lib/menu/interactive-menu.js
bin/lib/menu/interactive-menu.test.js
bin/lib/migration/backup-handler.js
bin/lib/migration/detect-old-structure.js
bin/lib/migration/migration-flow.js
bin/lib/migration/migration-prompts.js
bin/lib/old-flag-detector.js
bin/lib/old-flag-detector.test.js
bin/lib/orchestration/agent-invoker.js
bin/lib/orchestration/agent-registry.js
bin/lib/orchestration/capability-matrix.js
bin/lib/orchestration/equivalence-test.js
bin/lib/orchestration/generate-capability-docs.js
bin/lib/orchestration/orchestration-test-suite.js
bin/lib/orchestration/parallel-spawn-validator.js
bin/lib/orchestration/parallel-spawn-validator.test.js
bin/lib/orchestration/performance-tracker.js
bin/lib/orchestration/performance-tracker.test.js
bin/lib/orchestration/reference-resolver.js
bin/lib/orchestration/reference-resolver.test.js
bin/lib/orchestration/result-validator.js
bin/lib/orchestration/result-validator.test.js
bin/lib/orchestration/sequential-spawn-validator.js
bin/lib/orchestration/sequential-spawn-validator.test.js
bin/lib/orchestration/structured-return-parser.js
bin/lib/orchestration/structured-return-parser.test.js
bin/lib/orchestration/validate-planning-dir.js
bin/lib/output/formatter.js
bin/lib/output/reporter.js
bin/lib/output/reporter.test.js
bin/lib/output/symbols.js
bin/lib/path-validator.js
bin/lib/path-validator.test.js
bin/lib/paths.js
bin/lib/paths.test.js
bin/lib/template-system/agent-converter.js
bin/lib/template-system/context-builder.js
bin/lib/template-system/context-builder.test.js
bin/lib/template-system/engine.js
bin/lib/template-system/engine.test.js
bin/lib/template-system/field-transformer.js
bin/lib/template-system/field-transformer.test.js
bin/lib/template-system/generator.js
bin/lib/template-system/index.js
bin/lib/template-system/integration.test.js
bin/lib/template-system/migrate-agents.js
bin/lib/template-system/spec-parser.js
bin/lib/template-system/spec-parser.test.js
bin/lib/template-system/tool-mapper.js
bin/lib/template-system/tool-mapper.test.js
bin/lib/template-system/validators.js
bin/lib/template-system/validators.test.js
bin/lib/test-helpers/cli-invoker.js
bin/lib/upgrade.js
lib-ghcc/cli-fallback.js
lib-ghcc/directory-lock.js
lib-ghcc/session-manager.js
lib-ghcc/state-integration.js
lib-ghcc/state-io.js
lib-ghcc/state-manager.js
lib-ghcc/state-migrations.js
lib-ghcc/state-validator.js
lib-ghcc/templates/__tests__/verify.js
lib-ghcc/templates/generator.js
lib-ghcc/templates/index.js
lib-ghcc/templates/registry.js
lib-ghcc/templates/types.js
lib-ghcc/templates/validator.js
lib-ghcc/usage-tracker.js
lib-ghcc/verification/agent-verifier.js
lib-ghcc/verification/cli-detector.js
lib-ghcc/verification/command-verifier.js
lib-ghcc/verification/diagnostic-runner.js
lib-ghcc/verification/diagnostic-test.js
