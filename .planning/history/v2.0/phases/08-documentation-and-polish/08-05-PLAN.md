---
phase: 08-documentation-and-polish
plan: 05
type: execute
wave: 3
depends_on:
  - 08-01
  - 08-02
  - 08-03
  - 08-04
files_modified:
  - .markdownlint-cli2.jsonc
  - package.json
  - README.md
  - CONTRIBUTING.md
  - CHANGELOG.md
  - docs/*.md
autonomous: true
must_haves:
  - markdownlint-cli2 installed and configured
  - All documentation files pass markdown linting
  - Linting script added to package.json
  - Configuration excludes node_modules and .planning directories
  - Zero markdown lint errors in all docs
  - README.md, CONTRIBUTING.md, CHANGELOG.md pass linting
  - All docs/*.md files pass linting
---

# Phase 08 Plan 05: Quality Validation

## Objective

Set up markdown linting with markdownlint-cli2, configure rules, and ensure all documentation files pass validation. Establish documentation quality standards for future contributions.

## Context

**Documentation Quality Requirements (from 08-RESEARCH.md):**
- **markdownlint-cli2** is the standard tool (faster than v1, auto-fix, active maintenance)
- Keep a Changelog format for CHANGELOG.md
- GitHub Flavored Markdown for all docs
- No emojis in any documentation
- Consistent style across all files

**markdownlint-cli2 Features:**
- 50+ markdown rules
- Auto-fix capability (`--fix` flag)
- .jsonc configuration (JSON with comments)
- Faster than markdownlint-cli v1
- Actively maintained

**Files to Validate:**
- Root: README.md, CONTRIBUTING.md, CHANGELOG.md
- docs/: All 12 documentation files created in Plans 02-04

**Common Issues to Check:**
- Line length violations (MD013)
- Missing blank lines around headings (MD022, MD023)
- Inconsistent heading styles (MD003)
- Multiple blank lines (MD012)
- Trailing spaces (MD009)
- Hard tabs (MD010)

**Configuration Strategy:**
- Start with default rules
- Disable overly strict rules (MD013 line-length can be 120 instead of 80)
- Allow inline HTML (for badges)
- Exclude directories: node_modules, .planning, .git, templates

## Tasks

<task name="install-markdownlint-cli2" type="auto">
  <files>package.json</files>
  <action>
    Install markdownlint-cli2 as dev dependency:

    \`\`\`bash
    npm install --save-dev markdownlint-cli2
    \`\`\`

    Add linting scripts to package.json:

    \`\`\`json
    {
      "scripts": {
        "lint:md": "markdownlint-cli2 \"**/*.md\" \"#node_modules\" \"#.planning\" \"#templates\"",
        "lint:md:fix": "markdownlint-cli2 --fix \"**/*.md\" \"#node_modules\" \"#.planning\" \"#templates\""
      }
    }
    \`\`\`

    **Explanation:**
    - `lint:md`: Check all markdown files for issues
    - `lint:md:fix`: Auto-fix issues where possible
    - `#node_modules`: Exclude node_modules directory
    - `#.planning`: Exclude .planning directory (GSD internal, not project docs)
    - `#templates`: Exclude templates directory (has template variables)

    **Why exclude .planning/:**
    - .planning/ is GSD internal workspace, not project documentation
    - Planning files follow different format (XML tasks, frontmatter variations)
    - Focus linting on user-facing docs only
  </action>
  <verify>
    grep "markdownlint-cli2" package.json
    grep "lint:md" package.json
    npm run lint:md --help  # Should show markdownlint-cli2 help
  </verify>
  <done>markdownlint-cli2 installed, lint:md and lint:md:fix scripts added to package.json</done>
</task>

<task name="create-markdownlint-config" type="auto">
  <files>.markdownlint-cli2.jsonc</files>
  <action>
    Create .markdownlint-cli2.jsonc configuration:

    \`\`\`jsonc
    {
      // markdownlint-cli2 configuration
      // See: https://github.com/DavidAnson/markdownlint/blob/main/doc/Rules.md

      "config": {
        // Default to all rules enabled
        "default": true,

        // MD013: Line length - Relax to 120 characters (default 80 too strict)
        "MD013": {
          "line_length": 120,
          "code_blocks": false,  // Don't enforce in code blocks
          "tables": false        // Don't enforce in tables
        },

        // MD033: Allow inline HTML (for badges, links)
        "MD033": false,

        // MD041: First line must be top-level heading - Disable (YAML frontmatter conflicts)
        "MD041": false,

        // MD034: Bare URLs - Disable (allow bare URLs in documentation)
        "MD034": false,

        // MD046: Code block style - Consistent fenced style
        "MD046": {
          "style": "fenced"
        }
      },

      // Ignore patterns (glob format)
      "ignores": [
        "node_modules/**",
        ".planning/**",
        "templates/**",
        ".git/**",
        "coverage/**"
      ]
    }
    \`\`\`

    **Configuration Rationale:**

    1. **Line Length (MD013):**
       - 120 characters (not 80) - modern standard
       - Code blocks excluded (examples can be long)
       - Tables excluded (comparison tables need width)

    2. **Inline HTML (MD033):**
       - Disabled - badges in README.md require HTML
       - GitHub Flavored Markdown supports inline HTML

    3. **First Line Heading (MD041):**
       - Disabled - some docs may have badges or metadata first

    4. **Bare URLs (MD034):**
       - Disabled - allow plain URLs in documentation

    5. **Code Block Style (MD046):**
       - Enforce fenced style (\`\`\`) for consistency

    6. **Ignores:**
       - node_modules: Third-party code
       - .planning: GSD internal workspace (different format)
       - templates: Contains template variables (not final markdown)
       - .git: Git internals
       - coverage: Test coverage reports
  </action>
  <verify>
    cat .markdownlint-cli2.jsonc
    grep "MD013" .markdownlint-cli2.jsonc  # Should have line length config
    grep ".planning" .markdownlint-cli2.jsonc  # Should ignore .planning
    grep "templates" .markdownlint-cli2.jsonc  # Should ignore templates
  </verify>
  <done>.markdownlint-cli2.jsonc created with sensible defaults, relaxed line length, excludes node_modules/.planning/templates</done>
</task>

<task name="run-initial-lint" type="auto">
  <files>README.md, CONTRIBUTING.md, CHANGELOG.md, docs/*.md</files>
  <action>
    Run initial markdown linting to identify issues:

    \`\`\`bash
    npm run lint:md
    \`\`\`

    **Expected output:**
    - List of markdown files checked
    - Any rule violations with line numbers
    - Summary of errors

    **Common issues to expect:**
    1. **MD022: Headings should be surrounded by blank lines**
       - Add blank line before/after headings

    2. **MD012: Multiple consecutive blank lines**
       - Remove extra blank lines

    3. **MD009: Trailing spaces**
       - Remove trailing whitespace

    4. **MD010: Hard tabs**
       - Replace tabs with spaces

    5. **MD047: File should end with single newline**
       - Add newline at end of file

    **If issues found:**
    Document all errors in output for next task (auto-fix).
  </action>
  <verify>
    npm run lint:md 2>&1 | tee /tmp/lint-output.txt
    # Check if any files have errors
    grep -E "(error|warning)" /tmp/lint-output.txt || echo "No errors found"
  </verify>
  <done>Initial markdown linting run completed, issues documented (if any)</done>
</task>

<task name="auto-fix-issues" type="auto">
  <files>README.md, CONTRIBUTING.md, CHANGELOG.md, docs/*.md</files>
  <action>
    Auto-fix markdown issues where possible:

    \`\`\`bash
    npm run lint:md:fix
    \`\`\`

    **What gets auto-fixed:**
    - Trailing spaces removed
    - Hard tabs replaced with spaces
    - Multiple blank lines reduced to one
    - Missing newlines at end of file added
    - Inconsistent list markers fixed
    - Heading style normalized

    **What requires manual fix:**
    - Line length violations (need content rewording)
    - Bare URL issues (need proper markdown links)
    - Heading structure problems (need reorganization)

    **After auto-fix:**
    Run lint again to verify remaining issues:
    \`\`\`bash
    npm run lint:md
    \`\`\`

    **If issues remain:**
    Manually fix each remaining violation:
    1. Read error message and line number
    2. Edit file to fix issue
    3. Re-run lint to verify fix
    4. Repeat until clean
  </action>
  <verify>
    npm run lint:md:fix
    npm run lint:md  # Should pass with 0 errors
    echo $?  # Exit code should be 0 (success)
  </verify>
  <done>Markdown auto-fix applied, all remaining issues manually resolved, all docs pass linting</done>
</task>

<task name="verify-all-docs-pass" type="auto">
  <files>README.md, CONTRIBUTING.md, CHANGELOG.md, docs/*.md</files>
  <action>
    Final verification that all documentation passes linting:

    \`\`\`bash
    # Run lint on all documentation
    npm run lint:md
    \`\`\`

    **Expected output:**
    \`\`\`
    markdownlint-cli2 v0.12.x (markdownlint v0.33.x)
    Finding: **/*.md
    Linting: X files
    Summary: 0 error(s)
    \`\`\`

    **Files checked:**
    - README.md (root)
    - CONTRIBUTING.md (root)
    - CHANGELOG.md (root)
    - docs/README.md (documentation index)
    - docs/what-is-gsd.md
    - docs/how-gsd-works.md
    - docs/how-to-install.md
    - docs/how-to-upgrade.md
    - docs/how-to-uninstall.md
    - docs/what-gets-installed.md
    - docs/troubleshooting.md
    - docs/platform-comparison.md
    - docs/platform-specifics.md
    - docs/platform-migration.md
    - docs/how-to-customize.md
    - docs/architecture.md

    **If any errors:**
    - Identify file and line number
    - Fix issue manually
    - Re-run lint
    - Do NOT proceed until 0 errors

    **Success criteria:**
    - Exit code 0 (success)
    - "0 error(s)" in summary
    - All 16 documentation files checked
  </action>
  <verify>
    npm run lint:md
    EXIT_CODE=$?
    test $EXIT_CODE -eq 0 || (echo "Linting failed with exit code $EXIT_CODE" && exit 1)
    echo "All documentation files pass markdown linting ✓"
  </verify>
  <done>All documentation files pass markdown linting with zero errors</done>
</task>

<task name="update-contributing-with-linting" type="auto">
  <files>CONTRIBUTING.md</files>
  <action>
    Add markdown linting section to CONTRIBUTING.md:

    Find the "Code Style" section and add markdown linting:

    \`\`\`markdown
    ## Code Style

    We use ESLint and Prettier for code consistency:

    \`\`\`bash
    # Lint code
    npm run lint

    # Format code
    npm run format

    # Both (lint + format)
    npm run lint:fix
    \`\`\`

    ### Markdown Documentation

    We use markdownlint-cli2 for documentation consistency:

    \`\`\`bash
    # Check markdown files
    npm run lint:md

    # Auto-fix markdown issues
    npm run lint:md:fix
    \`\`\`

    **Before submitting PR:**
    - Run `npm run lint:md` to check documentation
    - All markdown files must pass linting (0 errors)
    - Configuration in `.markdownlint-cli2.jsonc`
    \`\`\`

    **Placement:** Add after "Code Style" section, before "Pull Request Process"
  </action>
  <verify>
    grep "markdownlint-cli2" CONTRIBUTING.md
    grep "npm run lint:md" CONTRIBUTING.md
  </verify>
  <done>CONTRIBUTING.md updated with markdown linting instructions</done>
</task>

## Verification

After completing all tasks, verify:

1. **markdownlint-cli2 installed:**
   - Listed in package.json devDependencies ✓
   - npm run lint:md executes successfully ✓

2. **.markdownlint-cli2.jsonc configured:**
   - Line length relaxed to 120 ✓
   - Ignores node_modules, .planning, templates ✓
   - Sensible defaults for documentation ✓

3. **All documentation passes linting:**
   - README.md: 0 errors ✓
   - CONTRIBUTING.md: 0 errors ✓
   - CHANGELOG.md: 0 errors ✓
   - docs/README.md: 0 errors ✓
   - All 12 docs/*.md files: 0 errors ✓

4. **Scripts added to package.json:**
   - lint:md for checking ✓
   - lint:md:fix for auto-fixing ✓

5. **CONTRIBUTING.md updated:**
   - Markdown linting section added ✓
   - Instructions for contributors ✓

## Success Criteria

- [ ] markdownlint-cli2 installed in devDependencies
- [ ] .markdownlint-cli2.jsonc configuration created
- [ ] npm run lint:md script works
- [ ] npm run lint:md:fix script works
- [ ] All 16 documentation files pass linting (0 errors)
- [ ] CONTRIBUTING.md updated with linting instructions
- [ ] Linting excludes .planning and templates directories

## Output

Markdown linting infrastructure established with markdownlint-cli2, all documentation files validated and passing, quality standards documented for future contributions.
