---
phase: 03-discovery-restore
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - commands/gsd/list-milestones.md
  - get-shit-done/workflows/list-milestones.md
autonomous: true

must_haves:
  truths:
    - "User can view all archived milestones with /gsd:list-milestones"
    - "List shows milestone name, date, location, and requirement count"
    - "List displays in readable table format"
  artifacts:
    - path: "commands/gsd/list-milestones.md"
      provides: "Command entry point for listing milestones"
      contains: "name: gsd:list-milestones"
      min_lines: 40
    - path: "get-shit-done/workflows/list-milestones.md"
      provides: "Workflow that reads and formats milestone data"
      contains: "<purpose>"
      min_lines: 60
  key_links:
    - from: "commands/gsd/list-milestones.md"
      to: "get-shit-done/workflows/list-milestones.md"
      via: "@get-shit-done/workflows/list-milestones.md reference"
      pattern: "@get-shit-done/workflows/list-milestones"
    - from: "get-shit-done/workflows/list-milestones.md"
      to: ".planning/MILESTONES.md"
      via: "reads milestone registry"
      pattern: "cat.*MILESTONES\\.md"
---

<objective>
Create command and workflow for discovering archived milestones.

Purpose: Enable users to see what milestones have been archived, when, and where they're located.
Output: Working /gsd:list-milestones command that displays milestone registry in readable format.
</objective>

<execution_context>
@.github/skills/get-shit-done/get-shit-done/workflows/execute-plan.md
@.github/skills/get-shit-done/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@commands/gsd/archive-milestone.md
@get-shit-done/workflows/archive-milestone.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create list-milestones command</name>
  <files>commands/gsd/list-milestones.md</files>
  <action>
    Create `commands/gsd/list-milestones.md` following the archive-milestone.md pattern:
    
    Frontmatter:
    ```yaml
    ---
    name: gsd:list-milestones
    description: List all archived milestones with metadata
    argument-hint: ""
    allowed-tools:
      - Read
      - Bash
    ---
    ```
    
    Sections:
    - `<objective>`: List all archived milestones from MILESTONES.md registry
    - `<execution_context>`: Reference @get-shit-done/workflows/list-milestones.md
    - `<context>`: Check if .planning/MILESTONES.md exists, if not show "No milestones archived yet"
    - `<process>`: 
      - Step 1: Check if MILESTONES.md exists
      - Step 2: Execute list-milestones workflow
      - Step 3: Display formatted output
    - `<success_criteria>`: List shows or "no milestones" message appears
    
    Include examples section showing expected output format.
    Follow exact structure from archive-milestone.md (thin wrapper that delegates to workflow).
  </action>
  <verify>
    Validate file structure matches archive-milestone.md pattern:
    ```bash
    grep -q "name: gsd:list-milestones" commands/gsd/list-milestones.md && \
    grep -q "@get-shit-done/workflows/list-milestones.md" commands/gsd/list-milestones.md && \
    echo "Command structure OK"
    ```
  </verify>
  <done>
    - commands/gsd/list-milestones.md exists with proper frontmatter
    - Command references list-milestones.md workflow
    - Structure matches archive-milestone.md pattern
    - Validation check passes
  </done>
</task>

<task type="auto">
  <name>Task 2: Create list-milestones workflow</name>
  <files>get-shit-done/workflows/list-milestones.md</files>
  <action>
    Create `get-shit-done/workflows/list-milestones.md` following archive-milestone.md workflow pattern:
    
    Structure:
    - `<purpose>`: Display all archived milestones from registry
    - `<philosophy>`: Why milestone discovery matters (transparency, recoverability)
    - `<process>`:
    
    Steps:
    1. `<step name="check_registry">`: Check if .planning/MILESTONES.md exists
       - If missing: Display "No milestones archived yet. Archive your first milestone with /gsd:archive-milestone"
       - If exists: Continue to read_milestones
    
    2. `<step name="read_milestones">`: Read MILESTONES.md content
       ```bash
       cat .planning/MILESTONES.md
       ```
       Parse table rows (skip header). Continue to format_output.
    
    3. `<step name="format_output">`: Display milestones in readable format
       ```
       Archived Milestones
       ==================
       
       | Milestone | Archived | Requirements | Status | Location |
       |-----------|----------|--------------|--------|----------|
       [Parse and display table rows from MILESTONES.md]
       
       Total: [N] milestone(s) archived
       
       Restore a milestone: /gsd:restore-milestone [name]
       ```
    
    - `<success_criteria>`: User sees all archived milestones or "none yet" message
    
    Follow exact XML structure from archive-milestone.md workflow.
  </action>
  <verify>
    Validate workflow structure:
    ```bash
    grep -q "<purpose>" get-shit-done/workflows/list-milestones.md && \
    grep -q "<step name=\"check_registry\">" get-shit-done/workflows/list-milestones.md && \
    grep -q "MILESTONES.md" get-shit-done/workflows/list-milestones.md && \
    echo "Workflow structure OK"
    ```
  </verify>
  <done>
    - get-shit-done/workflows/list-milestones.md exists with <purpose>, <philosophy>, <process>
    - Workflow checks for MILESTONES.md existence
    - Workflow reads and formats milestone table
    - Includes helpful "restore" message
    - Validation check passes
  </done>
</task>

</tasks>

<verification>
Run validation checks from both tasks.
Verify command references workflow correctly.
Confirm workflow follows archive-milestone.md structure.
</verification>

<success_criteria>
- commands/gsd/list-milestones.md exists with proper frontmatter and structure
- get-shit-done/workflows/list-milestones.md exists with XML process structure
- Command delegates to workflow (thin wrapper pattern)
- Workflow handles both "no milestones" and "milestones exist" cases
- Output format is readable table matching LIST-01, LIST-02 requirements
</success_criteria>

<output>
After completion, create `.planning/phases/03-discovery-restore/03-01-SUMMARY.md` documenting:
- Command and workflow file locations
- MILESTONES.md parsing approach
- Output format example
- Edge cases handled (missing registry, empty registry)
</output>
