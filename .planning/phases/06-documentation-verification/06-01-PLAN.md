---
phase: 06-documentation-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - bin/doc-generator/extract-comments.js
  - bin/doc-generator/generate-comparison.js
  - bin/doc-generator/generate-matrix.js
  - docs/cli-comparison.md
autonomous: true

must_haves:
  truths:
    - "CLI comparison table exists showing feature availability across Claude/Copilot/Codex"
    - "Comparison table is auto-generated from code metadata, not manually maintained"
    - "Documentation generator runs using only Node.js built-ins (zero dependencies)"
  artifacts:
    - path: "bin/doc-generator/extract-comments.js"
      provides: "JSDoc extraction via regex for documentation generation"
      min_lines: 40
      exports: ["extractDocComments", "parseJSDocTags"]
    - path: "bin/doc-generator/generate-comparison.js"
      provides: "CLI comparison table generator from capability matrix"
      min_lines: 60
      exports: ["generateComparison"]
    - path: "bin/doc-generator/generate-matrix.js"
      provides: "Capability matrix data generator"
      min_lines: 50
      exports: ["generateMatrixData"]
    - path: "docs/cli-comparison.md"
      provides: "Generated CLI feature comparison table"
      contains: "| Feature | Claude Code | Copilot CLI | Codex CLI |"
  key_links:
    - from: "bin/doc-generator/generate-comparison.js"
      to: "bin/lib/orchestration/capability-matrix.js"
      via: "require() and read AGENT_CAPABILITIES"
      pattern: "require.*capability-matrix"
    - from: "bin/doc-generator/generate-comparison.js"
      to: "docs/cli-comparison.md"
      via: "fs.writeFile with generated Markdown"
      pattern: "writeFile.*cli-comparison\\.md"
---

<objective>
Create documentation generation infrastructure using zero-dependency Node.js regex-based extractors and generate initial CLI comparison table.

Purpose: Enable automated, always-accurate documentation that stays in sync with code changes. No manual doc maintenance or stale docs.
Output: Doc generator utilities + generated CLI comparison table showing feature availability across all three CLIs.
</objective>

<execution_context>
@.github/skills/get-shit-done/get-shit-done/workflows/execute-plan.md
@.github/skills/get-shit-done/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-documentation-verification/06-RESEARCH.md
@.planning/codebase/STACK.md
@.planning/codebase/CONVENTIONS.md

# Existing capability infrastructure
@bin/lib/orchestration/capability-matrix.js
@docs/agent-capabilities.md
</context>

<tasks>

<task type="auto">
  <name>Create JSDoc comment extractor</name>
  <files>bin/doc-generator/extract-comments.js</files>
  <action>
Create regex-based JSDoc comment extractor using Node.js fs/promises only.

Extract JSDoc comments matching pattern: /\/\*\*\n([\s\S]*?)\*\//g
Parse @tags (param, returns, example, cli, description) via regex: /@(\w+)\s+([^\n@]+)/g

Functions to implement:
- extractDocComments(filePath) - Read file, extract all JSDoc blocks, return array of {description, tags}
- parseJSDocTags(comment) - Parse @tag lines into structured object
- extractFromDirectory(dirPath) - Recursively extract from all .js files in directory

Use fs.promises for async I/O, path.join for cross-platform paths.
Return structured data suitable for Markdown generation.

Follow research Pattern 1: Documentation Generation from Code Comments.
  </action>
  <verify>
```bash
node -e "const e = require('./bin/doc-generator/extract-comments.js'); e.extractDocComments('bin/lib/orchestration/agent-invoker.js').then(c => console.log(c.length > 0 ? 'PASS: Extracted comments' : 'FAIL'))"
```
  </verify>
  <done>extractDocComments() successfully extracts JSDoc comments from existing JavaScript files, parseJSDocTags() structures @tag data, zero npm dependencies</done>
</task>

<task type="auto">
  <name>Create CLI comparison generator</name>
  <files>bin/doc-generator/generate-comparison.js</files>
  <action>
Create CLI comparison table generator that reads capability-matrix.js and generates Markdown.

Load AGENT_CAPABILITIES from bin/lib/orchestration/capability-matrix.js
Read CLI_LIMITATIONS from same file
Generate Markdown table with columns: Feature | Claude Code | Copilot CLI | Codex CLI

Format support levels:
- full: "✓ Full support"
- partial: "⚠ Partial support" (with notes)
- unsupported: "✗ Not supported"

Include sections:
1. Command Availability (24 GSD commands)
2. Agent Availability (11 agents)
3. CLI-specific Limitations
4. Legend explaining icons

Add generation timestamp: "Last generated: YYYY-MM-DD HH:MM UTC"

Functions:
- generateComparison(outputPath) - Main generator, writes to docs/cli-comparison.md
- formatSupportLevel(level, notes) - Format capability with icon and notes
- generateLegend() - Create legend section

Use fs.promises for I/O, zero npm dependencies.
Follow research pattern: Generate CLI comparison from metadata.
  </action>
  <verify>
```bash
node bin/doc-generator/generate-comparison.js && \
grep -q "| Feature | Claude Code | Copilot CLI | Codex CLI |" docs/cli-comparison.md && \
grep -q "Last generated:" docs/cli-comparison.md && \
echo "PASS: Comparison generated" || echo "FAIL"
```
  </verify>
  <done>generate-comparison.js creates docs/cli-comparison.md with feature table, icons, notes, and timestamp from capability-matrix.js data</done>
</task>

<task type="auto">
  <name>Create capability matrix data generator</name>
  <files>bin/doc-generator/generate-matrix.js</files>
  <action>
Create capability-data.json generator for interactive matrix UI.

Read capability data from bin/lib/orchestration/capability-matrix.js
Transform AGENT_CAPABILITIES into JSON format:
```json
[
  {
    "feature": "gsd-executor agent",
    "category": "agents",
    "claude": "full",
    "copilot": "full",
    "codex": "full",
    "notes": {
      "claude": "",
      "copilot": "Requires custom agent definition",
      "codex": "Requires CLI installation"
    }
  }
]
```

Include:
- All 11 agents (category: "agents")
- All 24 commands (category: "commands")
- State management features (category: "state")

Functions:
- generateMatrixData(outputPath) - Generate docs/capability-data.json
- transformCapabilityToJSON(agentName, cliName, capability) - Convert to JSON format
- addMetadata(data) - Add generation timestamp and version

Use fs.promises, zero npm dependencies.
Follow research: Structured capability format for programmatic use.
  </action>
  <verify>
```bash
node bin/doc-generator/generate-matrix.js && \
node -e "const d = require('./docs/capability-data.json'); console.log(d.length > 0 && d[0].feature && d[0].claude ? 'PASS' : 'FAIL')"
```
  </verify>
  <done>generate-matrix.js creates docs/capability-data.json with structured capability data for all agents/commands, ready for interactive matrix UI consumption</done>
</task>

</tasks>

<verification>
Run all generators and verify outputs:
```bash
node bin/doc-generator/generate-comparison.js
node bin/doc-generator/generate-matrix.js
ls -lh docs/cli-comparison.md docs/capability-data.json
```

Check generated content:
```bash
grep "| Feature |" docs/cli-comparison.md  # Table exists
grep "Last generated:" docs/cli-comparison.md  # Timestamp exists
head -20 docs/capability-data.json  # Valid JSON
```
</verification>

<success_criteria>
- [ ] bin/doc-generator/extract-comments.js extracts JSDoc comments via regex
- [ ] bin/doc-generator/generate-comparison.js generates CLI comparison table
- [ ] bin/doc-generator/generate-matrix.js generates capability-data.json
- [ ] docs/cli-comparison.md exists with feature table and icons
- [ ] docs/capability-data.json exists with structured capability data
- [ ] All generators use only Node.js built-ins (no npm dependencies)
- [ ] Generated docs include timestamps showing generation date
- [ ] DOCS-01 requirement satisfied: CLI comparison table exists
- [ ] DOCS-06 requirement satisfied: Documentation generator auto-creates comparison
</success_criteria>

<output>
After completion, create `.planning/phases/06-documentation-verification/06-01-SUMMARY.md`
</output>
