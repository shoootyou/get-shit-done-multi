---
phase: 09-platform-instructions-installer
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - bin/lib/platforms/claude-adapter.js
  - bin/lib/platforms/copilot-adapter.js
  - bin/lib/platforms/codex-adapter.js
autonomous: true
must_haves:
  truths:
    - ClaudeAdapter.getInstructionsPath(true) returns ~/.claude/CLAUDE.md
    - ClaudeAdapter.getInstructionsPath(false) returns [cwd]/CLAUDE.md
    - CopilotAdapter.getInstructionsPath(true) returns ~/.copilot/copilot-instructions.md
    - CopilotAdapter.getInstructionsPath(false) returns [cwd]/.github/copilot-instructions.md
    - CodexAdapter.getInstructionsPath(true) returns ~/.codex/AGENTS.md
    - CodexAdapter.getInstructionsPath(false) returns [cwd]/AGENTS.md
    - All methods return absolute paths ready for file operations
  artifacts:
    - Each adapter has getInstructionsPath(isGlobal) method
    - All three adapters delegate to instruction-paths.js utility
  wiring:
    - Adapters import getInstructionPath from instruction-paths.js
    - Method calls getInstructionPath(this.platform, isGlobal)
  key_links:
    - getInstructionsPath() bridges adapter and path utility
    - Returns absolute paths (no relative paths in return values)
---

# Plan 09-02: Add getInstructionsPath() to Platform Adapters

## Objective

Add getInstructionsPath(isGlobal) method to all three platform adapters (Claude, Copilot, Codex) that delegate to the centralized instruction-paths.js utility and return absolute paths to platform-specific instruction files.

## Context

**What exists:**
- `bin/lib/platforms/claude-adapter.js` with methods like getTargetDir(), getCommandPrefix()
- `bin/lib/platforms/copilot-adapter.js` with similar adapter pattern
- `bin/lib/platforms/codex-adapter.js` with similar adapter pattern
- All adapters extend PlatformAdapter base class
- Pattern: adapters delegate to utility functions in platform-paths.js

**What's needed:**
- New method getInstructionsPath(isGlobal) in each adapter
- Method delegates to getInstructionPath() from instruction-paths.js
- Returns absolute path ready for file operations

**Scope-aware paths:**
- **Local installations:**
  - Claude: `[cwd]/CLAUDE.md` (project root)
  - Codex: `[cwd]/AGENTS.md` (project root)
  - Copilot: `[cwd]/.github/copilot-instructions.md` (inside .github/)
- **Global installations:**
  - Claude: `~/.claude/CLAUDE.md` (inside platform dir)
  - Codex: `~/.codex/AGENTS.md` (inside platform dir)
  - Copilot: `~/.copilot/copilot-instructions.md` (inside platform dir)

## Tasks

<task name="add-claude-adapter-method" type="auto">
  <files>bin/lib/platforms/claude-adapter.js</files>
  <action>
Add getInstructionsPath() method to ClaudeAdapter class.

1. **Add import statement** at top of file (after existing imports):
```javascript
import { getInstructionPath } from './instruction-paths.js';
```

2. **Add method to ClaudeAdapter class** (after existing methods like getCommandPrefix()):
```javascript
/**
 * Get path to platform instruction file
 * @param {boolean} isGlobal - Global or local installation
 * @returns {string} Absolute path to CLAUDE.md
 */
getInstructionsPath(isGlobal) {
  return getInstructionPath('claude', isGlobal);
}
```

**Placement:** Add after getPathReference() method to maintain consistency with existing method ordering.

**Why delegate:** Follows existing pattern where adapters use utility functions from platform-paths.js rather than hard-coding paths.
  </action>
  <verify>
```bash
# Method exists
node -e "import('./bin/lib/platforms/claude-adapter.js').then(m => {
  const adapter = new m.ClaudeAdapter();
  console.log('Method exists:', typeof adapter.getInstructionsPath === 'function');
})"
# Should print: Method exists: true

# Returns correct paths
node -e "import('./bin/lib/platforms/claude-adapter.js').then(m => {
  const adapter = new m.ClaudeAdapter();
  const globalPath = adapter.getInstructionsPath(true);
  const localPath = adapter.getInstructionsPath(false);
  console.log('Global path:', globalPath);
  console.log('Local path:', localPath);
  console.log('Global ends with .claude/CLAUDE.md:', globalPath.endsWith('.claude/CLAUDE.md'));
  console.log('Local ends with CLAUDE.md:', localPath.endsWith('CLAUDE.md'));
})"
```
  </verify>
  <done>ClaudeAdapter.getInstructionsPath() method added, returns absolute paths to CLAUDE.md</done>
</task>

<task name="add-copilot-adapter-method" type="auto">
  <files>bin/lib/platforms/copilot-adapter.js</files>
  <action>
Add getInstructionsPath() method to CopilotAdapter class.

1. **Add import statement** at top of file (after existing imports):
```javascript
import { getInstructionPath } from './instruction-paths.js';
```

2. **Add method to CopilotAdapter class** (after existing methods):
```javascript
/**
 * Get path to platform instruction file
 * @param {boolean} isGlobal - Global or local installation
 * @returns {string} Absolute path to copilot-instructions.md
 */
getInstructionsPath(isGlobal) {
  return getInstructionPath('copilot', isGlobal);
}
```

**Note:** Copilot has different local path (.github/copilot-instructions.md) vs global path (.copilot/copilot-instructions.md). The utility function handles this automatically.
  </action>
  <verify>
```bash
# Method exists
node -e "import('./bin/lib/platforms/copilot-adapter.js').then(m => {
  const adapter = new m.CopilotAdapter();
  console.log('Method exists:', typeof adapter.getInstructionsPath === 'function');
})"
# Should print: Method exists: true

# Returns correct paths (local includes .github/)
node -e "import('./bin/lib/platforms/copilot-adapter.js').then(m => {
  const adapter = new m.CopilotAdapter();
  const globalPath = adapter.getInstructionsPath(true);
  const localPath = adapter.getInstructionsPath(false);
  console.log('Global path:', globalPath);
  console.log('Local path:', localPath);
  console.log('Global ends with .copilot/copilot-instructions.md:', globalPath.endsWith('.copilot/copilot-instructions.md'));
  console.log('Local includes .github:', localPath.includes('.github'));
  console.log('Local ends with copilot-instructions.md:', localPath.endsWith('copilot-instructions.md'));
})"
```
  </verify>
  <done>CopilotAdapter.getInstructionsPath() method added, returns absolute paths to copilot-instructions.md with .github/ for local</done>
</task>

<task name="add-codex-adapter-method" type="auto">
  <files>bin/lib/platforms/codex-adapter.js</files>
  <action>
Add getInstructionsPath() method to CodexAdapter class.

1. **Add import statement** at top of file (after existing imports):
```javascript
import { getInstructionPath } from './instruction-paths.js';
```

2. **Add method to CodexAdapter class** (after existing methods):
```javascript
/**
 * Get path to platform instruction file
 * @param {boolean} isGlobal - Global or local installation
 * @returns {string} Absolute path to AGENTS.md
 */
getInstructionsPath(isGlobal) {
  return getInstructionPath('codex', isGlobal);
}
```

**Note:** Codex uses AGENTS.md (same filename as template), paths differ by scope: root for local, inside .codex/ for global.
  </action>
  <verify>
```bash
# Method exists
node -e "import('./bin/lib/platforms/codex-adapter.js').then(m => {
  const adapter = new m.CodexAdapter();
  console.log('Method exists:', typeof adapter.getInstructionsPath === 'function');
})"
# Should print: Method exists: true

# Returns correct paths
node -e "import('./bin/lib/platforms/codex-adapter.js').then(m => {
  const adapter = new m.CodexAdapter();
  const globalPath = adapter.getInstructionsPath(true);
  const localPath = adapter.getInstructionsPath(false);
  console.log('Global path:', globalPath);
  console.log('Local path:', localPath);
  console.log('Global ends with .codex/AGENTS.md:', globalPath.endsWith('.codex/AGENTS.md'));
  console.log('Local ends with AGENTS.md:', localPath.endsWith('AGENTS.md'));
})"
```
  </verify>
  <done>CodexAdapter.getInstructionsPath() method added, returns absolute paths to AGENTS.md</done>
</task>

## Verification

After completing all three tasks:

```bash
# All three adapters have the method
node -e "
Promise.all([
  import('./bin/lib/platforms/claude-adapter.js'),
  import('./bin/lib/platforms/copilot-adapter.js'),
  import('./bin/lib/platforms/codex-adapter.js')
]).then(([claude, copilot, codex]) => {
  const claudeAdapter = new claude.ClaudeAdapter();
  const copilotAdapter = new copilot.CopilotAdapter();
  const codexAdapter = new codex.CodexAdapter();
  
  console.log('Claude method:', typeof claudeAdapter.getInstructionsPath);
  console.log('Copilot method:', typeof copilotAdapter.getInstructionsPath);
  console.log('Codex method:', typeof codexAdapter.getInstructionsPath);
  
  console.log('\\nGlobal paths:');
  console.log('  Claude:', claudeAdapter.getInstructionsPath(true));
  console.log('  Copilot:', copilotAdapter.getInstructionsPath(true));
  console.log('  Codex:', codexAdapter.getInstructionsPath(true));
  
  console.log('\\nLocal paths:');
  console.log('  Claude:', claudeAdapter.getInstructionsPath(false));
  console.log('  Copilot:', copilotAdapter.getInstructionsPath(false));
  console.log('  Codex:', codexAdapter.getInstructionsPath(false));
});
"
# All should be 'function' and paths should be absolute
```

## Success Criteria

- [ ] ClaudeAdapter has getInstructionsPath(isGlobal) method
- [ ] CopilotAdapter has getInstructionsPath(isGlobal) method  
- [ ] CodexAdapter has getInstructionsPath(isGlobal) method
- [ ] All methods import and delegate to getInstructionPath() utility
- [ ] Claude returns CLAUDE.md (global: ~/.claude/, local: root)
- [ ] Copilot returns copilot-instructions.md (global: ~/.copilot/, local: .github/)
- [ ] Codex returns AGENTS.md (global: ~/.codex/, local: root)
- [ ] All methods return absolute paths (include base directory)
- [ ] Method signatures consistent with existing adapter methods
- [ ] JSDoc comments follow existing adapter style

## Output

Three adapter files updated with new method:
- `bin/lib/platforms/claude-adapter.js` - Added getInstructionsPath()
- `bin/lib/platforms/copilot-adapter.js` - Added getInstructionsPath()
- `bin/lib/platforms/codex-adapter.js` - Added getInstructionsPath()

Ready for orchestrator integration (Plan 09-03).
