---
phase: 10-milestone-completion-workflow-unification
plan: 03
type: execute
wave: 2
depends_on: [10-01]
files_modified:
  - templates/skills/gsd-list-milestones/SKILL.md
  - templates/get-shit-done/workflows/list-milestones.md
autonomous: true

must_haves:
  truths:
    - "gsd-list-milestones reads from MILESTONES.md registry"
    - "Display shows version, name, date, accomplishments"
    - "No references to restore workflow"
    - "Lists most recent first (descending version order)"
    - "Works with new history/v{X.Y}/ structure"
  artifacts:
    - path: "templates/skills/gsd-list-milestones/SKILL.md"
      provides: "Updated listing logic for history/ structure"
      min_lines: 50
    - path: "templates/get-shit-done/workflows/list-milestones.md"
      provides: "MILESTONES.md parsing and display logic"
      min_lines: 30
  key_links:
    - from: "templates/skills/gsd-list-milestones/SKILL.md"
      to: "templates/get-shit-done/workflows/list-milestones.md"
      via: "@-reference in execution_context"
      pattern: "@.*list-milestones\\.md"
    - from: "templates/get-shit-done/workflows/list-milestones.md"
      to: ".planning/MILESTONES.md"
      via: "reads registry data"
      pattern: "MILESTONES\\.md"
---

<objective>
Update gsd-list-milestones to work with new history/v{X.Y}/ structure and remove restore workflow references.

Purpose: Align milestone listing with unified completion workflow, remove references to deprecated restore command.
Output: Updated SKILL.md and workflow.md that list from MILESTONES.md registry without restore references.
</objective>

<execution_context>
@.github/get-shit-done/workflows/execute-plan.md
@.github/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-milestone-completion-workflow-unification/10-01-CONTEXT.md
@.planning/phases/10-milestone-completion-workflow-unification/10-RESEARCH.md
@.planning/phases/10-milestone-completion-workflow-unification/10-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update list-milestones SKILL.md</name>
  <files>templates/skills/gsd-list-milestones/SKILL.md</files>
  <action>
Update gsd-list-milestones SKILL.md to work with new history/ structure:

**Key changes:**
1. Update objective to reflect history/ structure listing
2. Update process steps to read from MILESTONES.md registry:
   - Check if .planning/MILESTONES.md exists
   - If not: Show "No milestones completed yet" message
   - If exists: Parse and display milestone entries
3. Update display format to show:
   - Version (e.g., v1.0)
   - Name (e.g., "MVP Release")
   - Date completed
   - Key accomplishments (2-3 bullets from MILESTONES.md)
   - Location note: "Archived in .planning/history/v{X.Y}/"
4. Remove any references to restore-milestone command
5. Remove any references to milestones/ directory (old location)
6. Update "next steps" to suggest complete-milestone for archiving

**Display format example:**
```
Completed Milestones
====================

v2.0 — Complete Multi-Platform Installer
Completed: 2026-01-30
• Template-based installer for Claude, Copilot CLI, Codex
• 37 requirements mapped and completed
• 41 plans across 13 phases
Archived: .planning/history/v2.0/

v1.0 — MVP Release
Completed: 2026-01-15
• Core functionality established
• Initial documentation complete
Archived: .planning/history/v1.0/

──────────────────────────────────────────
To start new milestone: {{COMMAND_PREFIX}}new-milestone
```

**Pattern to follow:**
- Simple text display (per RESEARCH.md Code Examples section)
- Most recent first (descending order)
- No interactive actions (just display)
- Clear location information for archived files

**What to avoid:**
- References to restore workflow
- Scanning history/ directory directly (use MILESTONES.md)
- Interactive "view details" or "compare" actions
- References to old milestones/ directory
  </action>
  <verify>
```bash
# Check SKILL.md references MILESTONES.md
grep -q "MILESTONES.md" templates/skills/gsd-list-milestones/SKILL.md

# Check references history/ structure
grep -q "history/" templates/skills/gsd-list-milestones/SKILL.md

# Check no restore references
! grep -q "restore" templates/skills/gsd-list-milestones/SKILL.md

# Check no old milestones/ directory references
! grep -q "milestones/" templates/skills/gsd-list-milestones/SKILL.md || grep -q "list-milestones" templates/skills/gsd-list-milestones/SKILL.md
```
  </verify>
  <done>
SKILL.md reads from MILESTONES.md registry, displays version/name/date/accomplishments, references history/ location, has no restore or old milestones/ references.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update list-milestones workflow</name>
  <files>templates/get-shit-done/workflows/list-milestones.md</files>
  <action>
Update list-milestones workflow to parse MILESTONES.md and display with history/ references:

**Key changes:**
1. Update workflow objective to reflect registry-based listing
2. Add MILESTONES.md existence check:
   ```bash
   if [ ! -f .planning/MILESTONES.md ]; then
       echo "No milestones archived yet."
       echo ""
       echo "Complete your first milestone with {{COMMAND_PREFIX}}complete-milestone"
       exit 0
   fi
   ```
3. Update parsing logic to extract:
   - Version number
   - Milestone name
   - Completion date
   - Accomplishment bullets
4. Update display format to show history/ location:
   ```
   Archived: .planning/history/v{X.Y}/
   ```
5. Remove any references to restore workflow
6. Remove any references to milestones/ directory
7. Update "next steps" messaging to reference complete-milestone

**Example parsing approach:**
```bash
echo ""
echo "Completed Milestones"
echo "===================="
echo ""

# Parse MILESTONES.md entries
# Each entry format:
# ## v{X.Y} — {Name}
# **Completed:** {Date}
# - {Accomplishment}
# - {Accomplishment}

cat .planning/MILESTONES.md

echo ""
echo "──────────────────────────────────────────"
echo "To start new milestone: {{COMMAND_PREFIX}}new-milestone"
```

**Pattern to follow:**
- Simple bash parsing (per RESEARCH.md Code Examples)
- Display raw MILESTONES.md content with context
- Clear next steps

**What to avoid:**
- Complex parsing (MILESTONES.md is human-readable)
- Scanning history/ directory directly
- References to deprecated restore command
- References to old milestones/ directory
  </action>
  <verify>
```bash
# Check workflow references MILESTONES.md
grep -q "MILESTONES.md" templates/get-shit-done/workflows/list-milestones.md

# Check references history/ structure
grep -q "history/" templates/get-shit-done/workflows/list-milestones.md

# Check no restore references
! grep -q "restore" templates/get-shit-done/workflows/list-milestones.md

# Check no old milestones/ directory references
! grep -q "milestones/" templates/get-shit-done/workflows/list-milestones.md || grep -q "list-milestones" templates/get-shit-done/workflows/list-milestones.md

# Check has existence check
grep -q "if.*MILESTONES.md" templates/get-shit-done/workflows/list-milestones.md
```
  </verify>
  <done>
Workflow parses MILESTONES.md registry, displays entries with history/ location, has no restore or old milestones/ references, handles missing registry file gracefully.
  </done>
</task>

</tasks>

<verification>
After completion:
1. Read updated SKILL.md to confirm MILESTONES.md usage and display format
2. Read updated workflow.md to confirm parsing logic and history/ references
3. Verify no references to restore workflow remain
4. Check no references to old milestones/ directory
</verification>

<success_criteria>
- gsd-list-milestones reads from MILESTONES.md registry
- Display shows version, name, date, accomplishments
- References .planning/history/v{X.Y}/ location
- No references to restore workflow
- No references to old milestones/ directory
- Most recent milestones first (descending order)
- Clear next steps pointing to complete-milestone
</success_criteria>

<output>
After completion, create `.planning/phases/10-milestone-completion-workflow-unification/10-03-SUMMARY.md`
</output>
