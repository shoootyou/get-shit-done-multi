---
phase: 07.2-codebase-cleanup-and-publishing-fixes
plan: 03
type: execute
wave: 3
depends_on: [07.2-02]
files_modified:
  - hooks/
  - coverage/
  - .scripts/
  - Dockerfile
  - docker-compose.yml
  - .gitignore
autonomous: true
must_haves:
  - No hooks/ directory in root
  - No coverage/ directory in root
  - No .scripts/ directory in root
  - No Docker files (Dockerfile, docker-compose.yml) in root
  - .gitignore updated to remove references to deleted directories
  - All tests pass after cleanup
---

# Phase 7.2 Plan 03: Development Tooling Cleanup

## Objective

Delete unused development tooling directories (hooks/, coverage/, .scripts/, docker files) to minimize published package size and remove clutter from repository.

## Context

**Depends on:** Plan 02 (tests must pass after code cleanup before removing more files)

**Why wave 3:** Development tooling should be deleted after tests confirm Plan 02 cleanup didn't break anything. This is the final cleanup before verification.

**From research (RESEARCH.md):**
- hooks/ = 12KB (git hooks, dev tooling)
- coverage/ = 304KB (generated test artifacts)
- Docker files = 4KB (Dockerfile, docker-compose.yml)
- None are needed in published npm package
- All can be recovered from git history

**From decisions (CONTEXT.md):**
- DELETE unused dev tooling: hooks/, scripts/, docker files, coverage/
- KEEP tests/ directory - actively used for validation and CI/CD
- Separate commits per concern
- Git history preserves everything

**Current directory analysis:**
```
.scripts/      → delete if exists (not mentioned in research, check first)
hooks/         → delete (git hooks for local dev)
coverage/      → delete (generated by vitest, recreated on test run)
Dockerfile     → delete if exists (docker dev setup)
docker-compose.yml → delete if exists (docker dev setup)
```

## Tasks

<task name="verify-directories-safe-to-delete" type="auto">
  <files>hooks/, coverage/, .scripts/, Dockerfile, docker-compose.yml</files>
  <action>
Before deletion, verify these directories/files are safe to delete:

**1. Check what exists:**
```bash
ls -la | grep -E "hooks|coverage|\.scripts|Dockerfile|docker-compose"
```

**2. Check for imports/references:**
```bash
# Check if any code imports from these directories
grep -r "hooks/\|coverage/\|\.scripts/" bin/ tests/ --include="*.js" | grep -v node_modules

# Check package.json references
grep -E "hooks|coverage|\.scripts|Dockerfile|docker" package.json
```

**3. Check .gitignore:**
```bash
# See current .gitignore entries for these
grep -E "hooks|coverage|\.scripts|docker" .gitignore
```

**4. Document findings:**
Create /tmp/deletion-plan.txt with:
- Which files/directories exist
- Any references found
- Which .gitignore entries to update

**Safe to proceed if:**
- No imports found in bin/ or tests/
- Not referenced in package.json (except maybe .gitignore)
- coverage/ is in .gitignore (generated artifacts)
- hooks/ not in .gitignore (tracked files, will use git rm)
  </action>
  <verify>
```bash
# Verify analysis completed
test -f /tmp/deletion-plan.txt && echo "✓ Deletion plan created"
cat /tmp/deletion-plan.txt
```
  </verify>
  <done>Verified directories are safe to delete, documented findings</done>
</task>

<task name="delete-git-hooks-directory" type="auto">
  <files>hooks/</files>
  <action>
Delete hooks/ directory (git hooks for local development):

**Check existence first:**
```bash
test -d hooks && echo "hooks/ exists" || echo "hooks/ not found"
```

**If exists, delete:**
```bash
# Use git rm if tracked, rm if untracked
if git ls-files hooks/ | grep -q .; then
  git rm -r hooks/
else
  rm -rf hooks/
fi

# Commit deletion
git commit -m "chore(cleanup): delete git hooks directory

Remove hooks/ directory (local development git hooks).
Not needed in published package. Can recover from git history.

Size: ~12KB
Addresses: SC2 (minimal published package)
Phase: 07.2-codebase-cleanup-and-publishing-fixes"
```

**Why safe:**
- Git hooks are local development only
- Not used in CI/CD or production
- Not referenced in bin/ code
- Can be recreated if needed
  </action>
  <verify>
```bash
# Verify hooks/ deleted
test ! -d hooks && echo "✓ hooks/ deleted" || echo "✗ hooks/ still exists"

# Verify no broken references
grep -r "hooks/" bin/ tests/ --include="*.js" | grep -v node_modules

# Expected: no output
```
  </verify>
  <done>hooks/ directory deleted</done>
</task>

<task name="delete-coverage-directory" type="auto">
  <files>coverage/</files>
  <action>
Delete coverage/ directory (generated test artifacts):

**Check existence first:**
```bash
test -d coverage && echo "coverage/ exists" || echo "coverage/ not found"
```

**If exists, delete:**
```bash
# coverage/ should be in .gitignore (generated), so just rm
rm -rf coverage/

# No git commit needed (untracked files)
# But add to next commit if we're cleaning up .gitignore references
```

**Note:** coverage/ is regenerated on every `npm test` run. Deleting it is always safe.

**Why safe:**
- Generated by vitest on test runs
- Listed in .gitignore (untracked)
- Not referenced in code
- Automatically recreated by `npm run test`
  </action>
  <verify>
```bash
# Verify coverage/ deleted
test ! -d coverage && echo "✓ coverage/ deleted" || echo "✗ coverage/ still exists"

# Verify it's in .gitignore
grep "coverage" .gitignore

# Test that it regenerates
npm test
test -d coverage && echo "✓ coverage/ regenerated correctly"
```
  </verify>
  <done>coverage/ directory deleted (regenerated on test run)</done>
</task>

<task name="delete-scripts-directory" type="auto">
  <files>.scripts/</files>
  <action>
Delete .scripts/ directory if it exists:

**Check existence first:**
```bash
test -d .scripts && echo ".scripts/ exists" || echo ".scripts/ not found"
ls -la .scripts/ 2>/dev/null  # See what's in it
```

**If exists, analyze contents:**
```bash
# What files are in .scripts/?
find .scripts -type f

# Are any referenced in package.json or code?
grep -r "\.scripts/" bin/ tests/ package.json --include="*.js"
```

**If safe, delete:**
```bash
# Use git rm if tracked
if git ls-files .scripts/ | grep -q .; then
  git rm -r .scripts/
  git commit -m "chore(cleanup): delete .scripts directory

Remove .scripts/ directory (development scripts).
Not needed in published package. Can recover from git history.

Addresses: SC2 (minimal published package)
Phase: 07.2-codebase-cleanup-and-publishing-fixes"
else
  rm -rf .scripts/
  echo ".scripts/ was untracked, removed without commit"
fi
```

**If .scripts/ doesn't exist:** Skip this deletion (already clean).
  </action>
  <verify>
```bash
# Verify .scripts/ deleted or never existed
test ! -d .scripts && echo "✓ .scripts/ deleted or not present"

# Verify no broken references
grep -r "\.scripts/" bin/ tests/ --include="*.js" | grep -v node_modules

# Expected: no output
```
  </verify>
  <done>.scripts/ directory deleted or confirmed not present</done>
</task>

<task name="delete-docker-files" type="auto">
  <files>Dockerfile, docker-compose.yml</files>
  <action>
Delete Docker files if they exist:

**Check existence:**
```bash
test -f Dockerfile && echo "Dockerfile exists"
test -f docker-compose.yml && echo "docker-compose.yml exists"
```

**If exist, delete:**
```bash
# Delete Dockerfile if exists
if [ -f Dockerfile ]; then
  git rm Dockerfile
  echo "Deleted Dockerfile"
fi

# Delete docker-compose.yml if exists
if [ -f docker-compose.yml ]; then
  git rm docker-compose.yml
  echo "Deleted docker-compose.yml"
fi

# Commit if any files deleted
if git status --short | grep -q "^D.*Docker"; then
  git commit -m "chore(cleanup): delete Docker configuration files

Remove Dockerfile and docker-compose.yml (docker dev setup).
Not needed in published package. Can recover from git history.

Size: ~4KB combined
Addresses: SC2 (minimal published package)
Phase: 07.2-codebase-cleanup-and-publishing-fixes"
fi
```

**Why safe:**
- Docker setup is for local development only
- Not used in production or CI/CD
- Not referenced in package.json or code
- Can be recreated if needed
  </action>
  <verify>
```bash
# Verify Docker files deleted
test ! -f Dockerfile && echo "✓ Dockerfile deleted or not present"
test ! -f docker-compose.yml && echo "✓ docker-compose.yml deleted or not present"

# Verify no broken references
grep -r "Dockerfile\|docker-compose" package.json bin/ tests/ --include="*.js"

# Expected: no output (or just .gitignore references)
```
  </verify>
  <done>Docker files deleted or confirmed not present</done>
</task>

<task name="update-gitignore" type="auto">
  <files>.gitignore</files>
  <action>
Update .gitignore to remove references to deleted directories:

**1. Review current .gitignore:**
```bash
cat .gitignore
```

**2. Identify entries for deleted directories:**
- coverage/ → KEEP (still generated by tests)
- hooks/ → REMOVE (directory deleted, won't exist anymore)
- .scripts/ → REMOVE if entry exists (directory deleted)
- Docker references → REMOVE if any

**3. Edit .gitignore:**
Remove lines for:
- hooks/
- .scripts/ (if present)
- Dockerfile, docker-compose.yml (if listed)

Keep lines for:
- coverage/ (still generated)
- node_modules/
- .DS_Store
- Other standard ignores

**4. Commit:**
```bash
git add .gitignore
git commit -m "chore(cleanup): update .gitignore after dev tooling deletion

Remove .gitignore entries for deleted directories (hooks/, .scripts/).
Keep coverage/ entry (still generated by tests).

Phase: 07.2-codebase-cleanup-and-publishing-fixes"
```

**Note:** If .gitignore doesn't have entries for deleted directories, skip this task.
  </action>
  <verify>
```bash
# Verify .gitignore doesn't reference deleted directories
grep -E "hooks/|\.scripts/" .gitignore

# Expected: no output (lines removed)

# Verify coverage/ still in .gitignore
grep "coverage" .gitignore

# Expected: coverage/ present (still needed)
```
  </verify>
  <done>.gitignore updated to remove deleted directory references</done>
</task>

## Success Criteria

- [ ] hooks/ directory deleted (or confirmed not present)
- [ ] coverage/ directory deleted (regenerates on test run)
- [ ] .scripts/ directory deleted (or confirmed not present)
- [ ] Dockerfile deleted (or confirmed not present)
- [ ] docker-compose.yml deleted (or confirmed not present)
- [ ] .gitignore updated (removed references to deleted directories, kept coverage/)
- [ ] No broken references to deleted directories in code
- [ ] All tests pass after cleanup
- [ ] All deletions committed

## Verification Commands

```bash
# Verify all directories deleted
test ! -d hooks && test ! -d .scripts && echo "✓ Dev tooling directories deleted"
test ! -f Dockerfile && test ! -f docker-compose.yml && echo "✓ Docker files deleted"

# Verify no broken references
grep -rE "hooks/|\.scripts/|Dockerfile|docker-compose" bin/ tests/ --include="*.js" | grep -v node_modules

# Expected: no output

# Verify .gitignore appropriate
cat .gitignore | grep -E "coverage|hooks|scripts"

# Run tests to verify nothing broke
npm test

# Verify coverage/ regenerates
test -d coverage && echo "✓ coverage/ regenerated correctly"
```

## Output

**Directories deleted:**
- hooks/ (~12KB)
- coverage/ (304KB, regenerated)
- .scripts/ (if existed)

**Files deleted:**
- Dockerfile (~2.5KB, if existed)
- docker-compose.yml (~1.6KB, if existed)

**Files modified:**
- .gitignore (removed deleted directory references)

**Git commits:** 2-4 commits depending on what existed (hooks, scripts, docker, gitignore)

**Impact:** Repository is now ~320KB smaller, published package will be minimal (only bin/, templates/, and auto-included files).

---

**Next:** Plan 04 (Wave 4) - Publishing Verification with Human Checkpoint
