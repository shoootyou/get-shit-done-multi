---
phase: 02-template-engine-integration
plan: 04
type: checkpoint:human-verify
wave: 3
depends_on: [02-01, 02-02, 02-03]
gate: blocking
files_modified: []
autonomous: false
must_haves:
  goal: "Verify end-to-end skill generation produces correct platform-specific output"
  truths:
    - Running install generates gsd-help.md in platform directories
    - Generated output has correct frontmatter for each platform
    - Conditional blocks render correctly (tools differ by platform)
    - Metadata fields present/absent per platform conventions
    - No generation errors or warnings
  verification: "Human confirms generated files match expected format"
---

# Phase 2 Plan 04: End-to-End Verification

**Objective:** Verify complete skill generation pipeline with gsd-help test case across all 3 platforms

## Context

Plans 02-01, 02-02, 02-03 implemented:
- generateSkillsFromSpecs() function
- Frontmatter inheritance (_shared.yml)
- Integration into all 3 platform installers

Now we test the complete pipeline end-to-end with the gsd-help spec created in Phase 1.

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete skill generation pipeline:
- generateSkillsFromSpecs() scans specs/skills/gsd-*/SKILL.md
- spec-parser.js loads _shared.yml and merges frontmatter
- generateAgent() renders platform conditionals ({{#isClaude}}, etc.)
- Platform installers write to correct directories

Tested with gsd-help spec from Phase 1.
  </what-built>
  
  <how-to-verify>
**Step 1: Test Claude installation (local mode)**

```bash
# Run local installation
node bin/install.js --local

# Verify skill generated in .claude/skills/
ls -la .claude/skills/gsd-help.md

# Check frontmatter (should have Claude tools)
head -20 .claude/skills/gsd-help.md
```

**Expected in Claude output:**
```yaml
---
name: gsd-help
description: Show available GSD commands and usage guide
tools: [Read, Bash, Glob]  # Claude format (string, not array)
metadata:
  category: gsd-command  # Inherited from _shared.yml
  system: get-shit-done
---
```

**Verify:**
- ✓ Tools are `[Read, Bash, Glob]` (not file_read/shell_execute)
- ✓ Metadata inherited from _shared.yml
- ✓ No {{#isClaude}} conditionals remain (rendered)
- ✓ Body content preserved from SKILL.md

---

**Step 2: Test Copilot installation**

```bash
# Clean previous installation
rm -rf .github/copilot

# Run Copilot installation
node bin/install.js --copilot

# Verify skill generated
ls -la .github/copilot/skills/gsd-help.md

# Check frontmatter (should have Copilot tools)
head -20 .github/copilot/skills/gsd-help.md
```

**Expected in Copilot output:**
```yaml
---
name: gsd-help
description: Show available GSD commands and usage guide
tools: [file_read, shell_execute, glob]  # Copilot format (mapped tools)
metadata:
  platform: copilot
  generated: 2025-01-22  # Auto-generated
  category: gsd-command
  system: get-shit-done
---
```

**Verify:**
- ✓ Tools are `[file_read, shell_execute, glob]` (not Read/Bash)
- ✓ Metadata.platform and metadata.generated present (Copilot convention)
- ✓ No {{#isCopilot}} conditionals remain
- ✓ Body content identical to Claude version

---

**Step 3: Test Codex installation (local mode)**

```bash
# Clean previous installation
rm -rf .codex

# Run Codex installation
node bin/install.js --codex

# Verify skill generated
ls -la .codex/skills/gsd-help.md

# Check frontmatter (should have Codex tools)
head -20 .codex/skills/gsd-help.md
```

**Expected in Codex output:**
```yaml
---
name: gsd-help
description: Show available GSD commands and usage guide
tools: [read, bash, glob]  # Codex format (lowercase tools)
metadata:
  category: gsd-command
  system: get-shit-done
---
```

**Verify:**
- ✓ Tools are `[read, bash, glob]` (not Read/Bash or file_read)
- ✓ Metadata inherited from _shared.yml
- ✓ No {{#isCodex}} conditionals remain
- ✓ Body content identical to other platforms

---

**Step 4: Verify installation reports**

Check console output during each installation:

**Expected:**
```
Generating agents from specs...
  ✓ Agents: 11 generated

Generating skills from specs...
  ✓ Skills: 1 generated
```

**Verify:**
- ✓ Skills: 1 generated (gsd-help is the only skill)
- ✓ No warnings or errors
- ✓ Reports appear for both agents and skills

---

**Step 5: Test --all flag (parallel installation)**

```bash
# Clean all installations
rm -rf .claude .github/copilot .codex

# Install to all platforms at once
node bin/install.js --all

# Verify all 3 platform directories have gsd-help.md
ls .claude/skills/gsd-help.md
ls .github/copilot/skills/gsd-help.md
ls .codex/skills/gsd-help.md
```

**Verify:**
- ✓ All 3 files exist
- ✓ Each has platform-specific tools
- ✓ No errors during parallel installation

---

**Step 6: Verify frontmatter inheritance**

```bash
# Check if metadata was inherited from _shared.yml
node -e "
  const yaml = require('js-yaml');
  const fs = require('fs');
  
  const claudeContent = fs.readFileSync('.claude/skills/gsd-help.md', 'utf8');
  const frontmatter = yaml.load(claudeContent.split('---')[1]);
  
  console.log('Category inherited:', frontmatter.metadata?.category);
  console.log('System inherited:', frontmatter.metadata?.system);
  console.log('Name from skill:', frontmatter.name);
  
  const inherited = frontmatter.metadata?.category === 'gsd-command';
  console.log('Inheritance working:', inherited);
"
```

**Verify:**
- ✓ Category inherited: gsd-command
- ✓ System inherited: get-shit-done
- ✓ Name from skill: gsd-help (not inherited)

---

**Common issues to check:**

❌ **If skills not generated:**
- Check generateSkillsFromSpecs() exists in bin/install.js
- Verify specs/skills/gsd-help/SKILL.md exists
- Check console for error messages

❌ **If tools wrong for platform:**
- Check tool-mapper.js is working
- Verify conditionals in SKILL.md match research examples
- Check platform parameter passed correctly

❌ **If metadata missing:**
- Verify _shared.yml exists and is valid YAML
- Check spec-parser.js merge logic
- Test parseSpec() directly with gsd-help spec

❌ **If conditionals not rendered:**
- Check context-builder.js sets platform flags correctly
- Verify engine.js render() called before writing output
- Check generateAgent() pipeline order
  </how-to-verify>
  
  <resume-signal>
Type "approved" if:
- All 3 platforms generate gsd-help.md with correct tools
- Frontmatter inheritance works (_shared.yml metadata present)
- No generation errors or warnings
- Installation reports show "Skills: 1 generated"

Type "issues: [description]" if problems found with specific details.
  </resume-signal>
</task>

## Success Criteria

- [x] Claude generates gsd-help.md with [Read, Bash, Glob] tools
- [x] Copilot generates gsd-help.md with [file_read, shell_execute, glob] tools
- [x] Codex generates gsd-help.md with [read, bash, glob] tools
- [x] Metadata inherited from _shared.yml in all platforms
- [x] No {{#platform}} conditionals remain in generated output
- [x] Body content identical across platforms
- [x] Installation reports "Skills: 1 generated" with no errors
- [x] --all flag generates skills for all 3 platforms

## Requirements Satisfied

- [x] **FOUN-03**: Conditional syntax support implemented and tested
- [x] **FOUN-07**: Frontmatter inheritance working via _shared.yml
- [x] **FOUN-08**: Metadata fields auto-generate (timestamps, platform)
- [x] **PLAT-01**: generateSkillsFromSpecs() integrated
- [x] **PLAT-02**: Claude adapter generates skills
- [x] **PLAT-03**: Copilot adapter generates skills
- [x] **PLAT-04**: Codex adapter generates skills

## Phase 2 Complete

Upon approval, Phase 2 goals achieved:
- Template engine extended for skills
- All 3 platforms generate skills from specs
- Frontmatter inheritance reduces duplication
- Test skill (gsd-help) validates entire pipeline
- Ready for Phase 3 (High-Complexity Orchestrators migration)
