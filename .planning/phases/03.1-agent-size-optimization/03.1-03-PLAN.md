---
phase: 03.1-agent-size-optimization
plan: 03
type: execute
wave: 2
depends_on: [03.1-01, 03.1-02]
files_modified:
  - commands/gsd/plan-phase.md
  - commands/gsd/debug.md
  - commands/gsd/verify-installation.md
  - commands/gsd/invoke-agent.md
  - .github/agents/custom_agents.json
  - .github/skills/get-shit-done/workflows/verify-work.md
  - .github/skills/get-shit-done/templates/debug-subagent-prompt.md
autonomous: true

must_haves:
  truths:
    - "All command files reference new coordinator agent names (not old names)"
    - "All 4 new agents registered in .github/agents/"
    - "Orchestrators spawn coordinators, which can spawn specialists"
    - "No broken references to old agent names remain"
    - "All workflow templates updated"
  artifacts:
    - path: "commands/gsd/plan-phase.md"
      provides: "Updated orchestrator spawning gsd-planner-coordinator"
      contains: 'agent: gsd-planner-coordinator'
    - path: "commands/gsd/debug.md"
      provides: "Updated orchestrator spawning gsd-debugger-investigator"
      contains: 'agent: gsd-debugger-investigator'
    - path: ".github/agents/custom_agents.json"
      provides: "Registry of all 4 new agents"
      contains: ["gsd-planner-coordinator", "gsd-planner-strategist", "gsd-debugger-investigator", "gsd-debugger-specialist"]
  key_links:
    - from: "commands/gsd/plan-phase.md"
      to: "gsd-planner-coordinator"
      via: "agent field in frontmatter"
      pattern: "^agent: gsd-planner-coordinator"
    - from: "commands/gsd/debug.md"
      to: "gsd-debugger-investigator"
      via: "agent field in frontmatter"
      pattern: "^agent: gsd-debugger-investigator"
    - from: ".github/agents/custom_agents.json"
      to: "specs/agents/gsd-*-coordinator.md and gsd-*-specialist.md"
      via: "agent registry"
      pattern: "All 4 new agents listed"
---

<objective>
Update all command files, orchestrators, and registries to reference the new coordinator agents (gsd-planner-coordinator, gsd-debugger-investigator) instead of the old monolithic agents.

**Purpose:** Complete the migration by updating spawn points to use new coordinator names, ensuring orchestrators can find and spawn the split agents correctly.

**Output:** All references updated, all 4 new agents registered, no broken links to old agent names.
</objective>

<execution_context>
@.github/skills/get-shit-done/get-shit-done/workflows/execute-plan.md
@.github/skills/get-shit-done/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.1-agent-size-optimization/03.1-01-SUMMARY.md
@.planning/phases/03.1-agent-size-optimization/03.1-02-SUMMARY.md
@docs/AGENT-SPLIT-PATTERN.md
</context>

<tasks>

<task type="auto">
  <name>Update Command Orchestrators</name>
  <files>commands/gsd/plan-phase.md, commands/gsd/debug.md, commands/gsd/verify-installation.md, commands/gsd/invoke-agent.md</files>
  <action>
Update all command files to reference new coordinator agent names.

## commands/gsd/plan-phase.md

**Find:**
```yaml
agent: gsd-planner
```

**Replace with:**
```yaml
agent: gsd-planner-coordinator
```

**Find in body text:**
- "gsd-planner agent" → "gsd-planner-coordinator agent"
- "spawn gsd-planner" → "spawn gsd-planner-coordinator"
- 'subagent_type="gsd-planner"' → 'subagent_type="gsd-planner-coordinator"'

**Preserve:**
- Success criteria mentioning "gsd-planner spawned" → update to "gsd-planner-coordinator spawned"

## commands/gsd/debug.md

**Find:**
```yaml
agent: gsd-debugger
```

**Replace with:**
```yaml
agent: gsd-debugger-investigator
```

**Find in body text:**
- "gsd-debugger agent" → "gsd-debugger-investigator agent"
- "spawn gsd-debugger" → "spawn gsd-debugger-investigator"
- 'subagent_type="gsd-debugger"' → 'subagent_type="gsd-debugger-investigator"'

**Preserve:**
- Success criteria mentioning "gsd-debugger spawned" → update to "gsd-debugger-investigator spawned"

## commands/gsd/verify-installation.md

**Find:**
```javascript
new AgentCapabilityTest('gsd-planner'),
new AgentCapabilityTest('gsd-debugger'),
```

**Replace with:**
```javascript
new AgentCapabilityTest('gsd-planner-coordinator'),
new AgentCapabilityTest('gsd-planner-strategist'),
new AgentCapabilityTest('gsd-debugger-investigator'),
new AgentCapabilityTest('gsd-debugger-specialist'),
```

## commands/gsd/invoke-agent.md

**Update examples:**
- Example using gsd-planner → use gsd-planner-coordinator
- Add note: "Coordinator agents (gsd-planner-coordinator, gsd-debugger-investigator) are primary entry points; specialist agents spawned automatically when needed"

**Update description:**
- "e.g., gsd-executor, gsd-planner, gsd-verifier" → "e.g., gsd-executor, gsd-planner-coordinator, gsd-verifier"
</action>
  <verify>
# Verify no old references remain
! grep -r "agent: gsd-planner\"" commands/gsd/plan-phase.md
! grep -r "agent: gsd-debugger\"" commands/gsd/debug.md

# Verify new references exist
grep -q "agent: gsd-planner-coordinator" commands/gsd/plan-phase.md && echo "✓ plan-phase updated"
grep -q "agent: gsd-debugger-investigator" commands/gsd/debug.md && echo "✓ debug updated"
grep -q "gsd-planner-coordinator" commands/gsd/verify-installation.md && echo "✓ verify-installation updated"
grep -q "gsd-planner-strategist" commands/gsd/verify-installation.md && echo "✓ strategist in tests"
grep -q "gsd-debugger-investigator" commands/gsd/verify-installation.md && echo "✓ investigator in tests"
grep -q "gsd-debugger-specialist" commands/gsd/verify-installation.md && echo "✓ specialist in tests"
</verify>
  <done>All command files reference new coordinator agents, examples updated, capability tests include all 4 new agents</done>
</task>

<task type="auto">
  <name>Update Workflow Templates and Skills</name>
  <files>.github/skills/get-shit-done/workflows/verify-work.md, .github/skills/get-shit-done/templates/debug-subagent-prompt.md</files>
  <action>
Update workflow documentation and templates in .github/skills/ directory.

## .github/skills/get-shit-done/workflows/verify-work.md

**Find all occurrences:**
- 'subagent_type="gsd-planner"' → 'subagent_type="gsd-planner-coordinator"'
- "Spawn gsd-planner" → "Spawn gsd-planner-coordinator"

**Context:** This file shows how to spawn planner for gap closure. Update all spawn examples.

## .github/skills/get-shit-done/templates/debug-subagent-prompt.md

**Find all occurrences:**
- 'subagent_type="gsd-debugger"' → 'subagent_type="gsd-debugger-investigator"'
- "gsd-debugger agent" → "gsd-debugger-investigator agent"
- Template descriptions mentioning debugger → update to investigator

**Context:** This is a template showing how to spawn the debugger agent.

## Verify no other workflow files need updates

```bash
# Search for any other references
grep -r "gsd-planner\"" .github/skills/get-shit-done/ --include="*.md" | grep -v "CHANGELOG"
grep -r "gsd-debugger\"" .github/skills/get-shit-done/ --include="*.md" | grep -v "CHANGELOG"
```

If found, update those as well. CHANGELOG.md can mention old names (historical record).
</action>
  <verify>
# Verify updates
grep -q "gsd-planner-coordinator" .github/skills/get-shit-done/workflows/verify-work.md && echo "✓ verify-work updated"
grep -q "gsd-debugger-investigator" .github/skills/get-shit-done/templates/debug-subagent-prompt.md && echo "✓ debug template updated"

# Verify no stale references (excluding CHANGELOG)
! grep -r "subagent_type=\"gsd-planner\"" .github/skills/get-shit-done/ --include="*.md" | grep -v CHANGELOG
! grep -r "subagent_type=\"gsd-debugger\"" .github/skills/get-shit-done/ --include="*.md" | grep -v CHANGELOG
</verify>
  <done>All workflow templates and skill files reference new coordinator agents, no stale references remain (except in CHANGELOG)</done>
</task>

<task type="auto">
  <name>Register New Agents in Agent Registry</name>
  <files>.github/agents/custom_agents.json</files>
  <action>
Register all 4 new agents in the custom agent registry (if it exists) or document where they should be registered.

## Check for agent registry

```bash
# Look for agent registry files
find .github/agents/ -name "*.json" -o -name "*.yaml" -o -name "*.yml" 2>/dev/null
```

## If .github/agents/custom_agents.json exists:

Add entries for the 4 new agents:

```json
{
  "agents": [
    {
      "name": "gsd-planner-coordinator",
      "description": "Primary orchestrator for phase planning. Spawns gsd-planner-strategist for complex scenarios.",
      "spec": "specs/agents/gsd-planner-coordinator.md",
      "role": "coordinator"
    },
    {
      "name": "gsd-planner-strategist",
      "description": "Methodology specialist for complex planning scenarios. Spawned by gsd-planner-coordinator.",
      "spec": "specs/agents/gsd-planner-strategist.md",
      "role": "specialist"
    },
    {
      "name": "gsd-debugger-investigator",
      "description": "Primary orchestrator for debugging sessions. Spawns gsd-debugger-specialist for complex scenarios.",
      "spec": "specs/agents/gsd-debugger-investigator.md",
      "role": "coordinator"
    },
    {
      "name": "gsd-debugger-specialist",
      "description": "Debugging methodology specialist. Spawned by gsd-debugger-investigator for complex analysis.",
      "spec": "specs/agents/gsd-debugger-specialist.md",
      "role": "specialist"
    }
  ]
}
```

## If no agent registry exists:

Create `.github/agents/README.md` documenting the 4 new agents:

```markdown
# Custom Agents

## Coordinator/Specialist Pairs

### Planning Agents

**gsd-planner-coordinator** (primary)
- Orchestrates phase planning
- Spawns gsd-planner-strategist for complex scenarios
- Spec: specs/agents/gsd-planner-coordinator.md

**gsd-planner-strategist** (specialist)
- Provides planning methodology and analysis
- Spawned by coordinator when needed
- Spec: specs/agents/gsd-planner-strategist.md

### Debugging Agents

**gsd-debugger-investigator** (primary)
- Orchestrates debugging sessions
- Spawns gsd-debugger-specialist for complex scenarios
- Spec: specs/agents/gsd-debugger-investigator.md

**gsd-debugger-specialist** (specialist)
- Provides debugging methodology and investigation techniques
- Spawned by investigator when needed
- Spec: specs/agents/gsd-debugger-specialist.md
```

## Remove or deprecate old agent entries

If gsd-planner or gsd-debugger exist in registry, mark as deprecated or remove.
</action>
  <verify>
# Check what was created/updated
ls -la .github/agents/

# If JSON file exists, verify entries
if [ -f .github/agents/custom_agents.json ]; then
  grep -q "gsd-planner-coordinator" .github/agents/custom_agents.json && echo "✓ Coordinator registered"
  grep -q "gsd-planner-strategist" .github/agents/custom_agents.json && echo "✓ Strategist registered"
  grep -q "gsd-debugger-investigator" .github/agents/custom_agents.json && echo "✓ Investigator registered"
  grep -q "gsd-debugger-specialist" .github/agents/custom_agents.json && echo "✓ Specialist registered"
fi

# If README exists, verify documentation
if [ -f .github/agents/README.md ]; then
  grep -q "gsd-planner-coordinator" .github/agents/README.md && echo "✓ Agents documented"
fi
</verify>
  <done>All 4 new agents registered in agent registry (JSON or README) with coordinator/specialist roles documented</done>
</task>

</tasks>

<verification>
1. Check all command files for updated agent references
2. Verify no stale references to old agent names (grep -r "gsd-planner[^-]" commands/)
3. Verify agent registry contains all 4 new agents
4. Verify workflow templates updated
5. Run grep to ensure consistency across all files
</verification>

<success_criteria>
1. **commands/gsd/plan-phase.md** references `gsd-planner-coordinator`
2. **commands/gsd/debug.md** references `gsd-debugger-investigator`
3. **verify-installation.md** includes capability tests for all 4 new agents
4. **Workflow templates** (.github/skills/) reference new coordinator names
5. **Agent registry** (.github/agents/) contains all 4 new agents with roles
6. **No stale references** to old monolithic agent names (except CHANGELOG)
7. **All spawn patterns** use coordinator names
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-agent-size-optimization/03.1-03-SUMMARY.md`

Include:
- List of files updated
- Old → new agent name mappings
- Registry location and format
- Verification grep commands showing no stale references
</output>
