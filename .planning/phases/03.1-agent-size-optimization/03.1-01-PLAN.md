---
phase: 03.1-agent-size-optimization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - specs/agents/gsd-planner-coordinator.md
  - specs/agents/gsd-planner-strategist.md
  - docs/AGENT-SPLIT-PATTERN.md
autonomous: true

must_haves:
  truths:
    - "gsd-planner split into two functional agents: coordinator (orchestration) and strategist (methodology)"
    - "Both new agents are under 30,000 characters"
    - "ALL original content from gsd-planner is preserved across both agents"
    - "Coordinator agent knows when and how to spawn strategist"
    - "Split pattern is documented for consistency with gsd-debugger split"
  artifacts:
    - path: "specs/agents/gsd-planner-coordinator.md"
      provides: "Primary orchestrator for phase planning"
      max_chars: 30000
      contains: ["<role>", "<execution_flow>", "checkpoint", "structured_returns", "gap_closure_mode", "revision_mode"]
    - path: "specs/agents/gsd-planner-strategist.md"
      provides: "Methodology specialist for complex planning scenarios"
      max_chars: 30000
      contains: ["<philosophy>", "<task_breakdown>", "<dependency_graph>", "<scope_estimation>", "<goal_backward>", "TDD integration"]
    - path: "docs/AGENT-SPLIT-PATTERN.md"
      provides: "Documentation of coordinator/specialist pattern"
      contains: ["coordination pattern", "when to spawn specialist", "content distribution guidelines"]
  key_links:
    - from: "gsd-planner-coordinator"
      to: "gsd-planner-strategist"
      via: "task tool spawn"
      pattern: "task.*gsd-planner-strategist.*For complex"
    - from: "specs/agents/gsd-planner.md"
      to: "specs/agents/gsd-planner-coordinator.md + gsd-planner-strategist.md"
      via: "functional decomposition"
      pattern: "All sections distributed, no content loss"
---

<objective>
Split gsd-planner (41,135 chars) into two functional agents using coordinator/specialist pattern, achieving 100% content preservation while staying under Copilot's 30K limit.

**Purpose:** Enable gsd-planner to work on Copilot platform (currently exceeds 30K limit by 37%) while preserving ALL methodology, examples, and patterns through functional decomposition rather than compression.

**Output:** Two new agent specs that together contain everything from the original, with clear coordination pattern for spawning strategist when needed.
</objective>

<execution_context>
@.github/skills/get-shit-done/get-shit-done/workflows/execute-plan.md
@.github/skills/get-shit-done/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.1-agent-size-optimization/README.md
@specs/agents/gsd-planner.md
</context>

<tasks>

<task type="auto">
  <name>Document Split Pattern</name>
  <files>docs/AGENT-SPLIT-PATTERN.md</files>
  <action>
Create coordination pattern documentation that will guide both agent splits (gsd-planner and gsd-debugger).

**Pattern structure:**
```markdown
# Agent Split Pattern: Coordinator/Specialist

## Purpose
Enable oversized agents to work on platforms with character limits by splitting into functional pairs that maintain 100% content preservation.

## Roles

### Coordinator (Primary Agent)
- Spawned by orchestrators/commands
- Handles execution flow and orchestration
- Contains role, execution steps, checkpoint management
- Makes decisions about when to spawn specialist
- ~50% of original content (execution-focused)

### Specialist (Advisory Agent)
- Spawned by coordinator via task tool
- Contains deep methodology and techniques
- Provides analysis, recommendations, patterns
- Returns advice to coordinator for implementation
- ~50% of original content (knowledge-focused)

## Content Distribution

**Coordinator gets:**
- Role definition and core responsibilities
- Execution flow (step-by-step orchestration)
- Checkpoint and structured return protocols
- Mode-specific protocols (gap closure, revision, etc.)
- When/how to spawn specialist

**Specialist gets:**
- Philosophy sections (principles, patterns)
- Detailed methodology (with ALL examples)
- Technique libraries (complete, uncompressed)
- Anti-patterns and edge cases
- Reference tables and decision trees

## Coordination Protocol

Coordinator spawns specialist when:
- Complex planning requiring deep methodology
- Novel scenarios without established patterns
- Decision-making needing framework analysis
- User explicitly requests detailed approach

Spawn pattern:
\```
task(
  agent_type="gsd-xxx-specialist",
  description="Analyze dependency graph",
  prompt="Context: ...\nQuestion: ..."
)
\```

Specialist returns:
- Analysis or recommendations
- NOT execution (coordinator executes)
```

**Why this pattern:**
- Zero content loss (everything preserved, just reorganized)
- Better architecture (separation of concerns)
- Scalable (works for multiple oversized agents)
- No breaking changes (orchestrators spawn coordinators, users don't see change)
</action>
  <verify>cat docs/AGENT-SPLIT-PATTERN.md | wc -c (should be ~3000 chars)</verify>
  <done>Pattern documentation exists and explains coordinator/specialist split with clear content distribution guidelines</done>
</task>

<task type="auto">
  <name>Split gsd-planner into Coordinator + Strategist</name>
  <files>specs/agents/gsd-planner-coordinator.md, specs/agents/gsd-planner-strategist.md</files>
  <action>
Perform functional decomposition of gsd-planner.md into two agents. **CRITICAL: Zero content loss - every example, table, and pattern must be preserved.**

## gsd-planner-coordinator.md (~21K chars)

**Include (execution-focused):**
1. **Frontmatter** (name: gsd-planner-coordinator, description updates, tools same as original)
2. **Role section** (responsibilities, spawning context) + ADD coordination note:
   - "For complex scenarios requiring deep methodology, spawn gsd-planner-strategist via task tool"
3. **Execution flow section** (complete, all steps)
4. **Checkpoint section** (all checkpoint types and protocols)
5. **Structured returns section** (all return formats)
6. **Gap closure mode section** (complete protocol)
7. **Revision mode section** (complete protocol)
8. **Tools section** (unchanged)

**Add new section before execution_flow:**
```xml
<coordination>

## When to Spawn Strategist

Spawn gsd-planner-strategist when:
- Complex dependency analysis needed (7+ tasks with cross-dependencies)
- Novel domain requiring goal-backward derivation
- TDD integration decision (should feature use TDD?)
- Scope estimation for unusual phase structure
- User requests detailed methodology

Spawn pattern:
\```
task(
  agent_type="gsd-planner-strategist",
  description="Analyze task dependencies",
  prompt="\
Context: Phase {N} goal is {goal}
Tasks identified: {task_list}

Analyze: Build dependency graph and recommend wave structure.
Include: Parallelization opportunities and must_haves derivation."
)
\```

For standard phases: Use built-in execution flow (most cases).
For complex phases: Spawn strategist for analysis, then execute per their recommendations.

</coordination>
```

**Character target:** 20,000-22,000 chars

## gsd-planner-strategist.md (~19K chars)

**Include (methodology-focused):**
1. **Frontmatter** (name: gsd-planner-strategist, description: "Methodology specialist...", tools: [Read, Bash, Grep, Glob])
2. **Role section** - NEW:
```xml
<role>
You are a planning methodology specialist. You provide deep analysis and recommendations for complex planning scenarios.

**You are spawned by gsd-planner-coordinator when:**
- Complex dependency analysis needed
- Novel domain requiring goal-backward derivation  
- TDD integration decisions
- Scope estimation challenges
- Detailed methodology requested

**Your job:** Analyze the scenario, apply relevant methodology, return actionable recommendations. You do NOT execute plans - coordinator does that using your advice.

**Core capabilities:**
- Dependency graph construction
- Goal-backward verification
- Task breakdown with examples
- Scope estimation techniques
- TDD integration analysis
- Philosophy and patterns
</role>
```

3. **Philosophy section** (COMPLETE - all anti-enterprise patterns, quality curve, ship fast)
4. **Discovery levels section** (COMPLETE - all 4 levels with examples)
5. **Task breakdown section** (COMPLETE - all examples, anti-patterns, tables, TDD heuristic)
6. **Dependency graph section** (COMPLETE - all construction rules, wave analysis, vertical slices)
7. **Scope estimation section** (COMPLETE - all context budget rules, split signals)
8. **Plan format section** (COMPLETE - PLAN.md structure, frontmatter, context rules)
9. **Goal-backward section** (COMPLETE - all 5 steps, examples, must-haves format)
10. **TDD integration section** (COMPLETE - when to use, RED-GREEN-REFACTOR, context budget)

**Character target:** 18,000-20,000 chars

## Content Verification

After split, verify:
- [ ] coordinator + strategist combined char count = original ±500 chars
- [ ] Every section from original exists in one of the two new files
- [ ] All examples preserved (no "simplified" versions)
- [ ] All tables preserved (not converted to bullets)
- [ ] Coordinator has spawn logic
- [ ] Both agents have proper frontmatter

**Use EXACT text from original - this is reorganization, not rewriting.**
</action>
  <verify>
# Check character counts
wc -c specs/agents/gsd-planner-coordinator.md specs/agents/gsd-planner-strategist.md

# Verify both under 30K
test $(wc -c < specs/agents/gsd-planner-coordinator.md) -lt 30000 && echo "✓ Coordinator under 30K"
test $(wc -c < specs/agents/gsd-planner-strategist.md) -lt 30000 && echo "✓ Strategist under 30K"

# Check frontmatter
head -20 specs/agents/gsd-planner-coordinator.md | grep "name: gsd-planner-coordinator"
head -20 specs/agents/gsd-planner-strategist.md | grep "name: gsd-planner-strategist"

# Verify key sections exist
grep -q "<coordination>" specs/agents/gsd-planner-coordinator.md && echo "✓ Coordination section"
grep -q "<execution_flow>" specs/agents/gsd-planner-coordinator.md && echo "✓ Execution flow"
grep -q "<philosophy>" specs/agents/gsd-planner-strategist.md && echo "✓ Philosophy"
grep -q "<goal_backward>" specs/agents/gsd-planner-strategist.md && echo "✓ Goal-backward"
</verify>
  <done>
Both gsd-planner agents exist, are under 30K chars each, contain ALL original content (distributed by function), and coordinator knows how to spawn strategist
</done>
</task>

</tasks>

<verification>
1. Run character count checks: `wc -c specs/agents/gsd-planner-*.md`
2. Verify both files under 30,000 characters
3. Check combined character count roughly matches original (41,135 ±500)
4. Verify pattern documentation exists
5. Verify frontmatter correct in both agents
6. Verify coordination section exists in coordinator
7. Spot-check that examples/tables are preserved (not simplified)
</verification>

<success_criteria>
1. **gsd-planner-coordinator.md** exists and is 20,000-22,000 characters
2. **gsd-planner-strategist.md** exists and is 18,000-20,000 characters
3. **Combined content** equals original (~41K chars) - zero information loss
4. **Pattern documentation** (AGENT-SPLIT-PATTERN.md) exists with clear guidelines
5. **Coordination logic** present in coordinator for spawning strategist
6. **All original sections** accounted for in one of the two new agents
7. **All examples and tables** preserved in full (no compression)
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-agent-size-optimization/03.1-01-SUMMARY.md`

Include:
- Character counts for both new agents
- Content distribution summary (which sections went where)
- Coordination pattern used
- Verification that all content preserved
</output>
